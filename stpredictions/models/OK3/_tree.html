<!DOCTYPE html>
<!-- Generated by Cython 0.29.23 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: _tree.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.cython .hll { background-color: #ffffcc }
.cython { background: #f8f8f8; }
.cython .c { color: #3D7B7B; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cython .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #9C6500 } /* Comment.Preproc */
.cython .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.cython .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cython .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #E40000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #008400 } /* Generic.Inserted */
.cython .go { color: #717171 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #687822 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #717171; font-weight: bold } /* Name.Entity */
.cython .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #767600 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sa { color: #BA2121 } /* Literal.String.Affix */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .dl { color: #BA2121 } /* Literal.String.Delimiter */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #A45A77 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .fm { color: #0000FF } /* Name.Function.Magic */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .vm { color: #19177C } /* Name.Variable.Magic */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.23</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="_tree.c">_tree.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: <span class="c"># cython: cdivision=True</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: <span class="c"># cython: boundscheck=False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: <span class="c"># cython: wraparound=False</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: <span class="k">from</span> <span class="nn">cpython</span> <span class="k">cimport</span> <span class="n">Py_INCREF</span><span class="p">,</span> <span class="n">PyObject</span><span class="p">,</span> <span class="n">PyTypeObject</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0007</span>: <span class="k">from</span> <span class="nn">libc.stdlib</span> <span class="k">cimport</span> <span class="n">free</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0008</span>: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">fabs</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0009</span>: <span class="k">from</span> <span class="nn">libc.string</span> <span class="k">cimport</span> <span class="n">memcpy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0010</span>: <span class="k">from</span> <span class="nn">libc.string</span> <span class="k">cimport</span> <span class="n">memset</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0011</span>: <span class="k">from</span> <span class="nn">libc.stdint</span> <span class="k">cimport</span> <span class="n">SIZE_MAX</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0012</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0013</span>: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0014</span>: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0015</span>: <span class="n">np</span><span class="o">.</span><span class="n">import_array</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = __pyx_f_5numpy_import_array();<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 15, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0016</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0017</span>: <span class="k">import</span> <span class="nn">warnings</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_warnings, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_warnings, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0018</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0019</span>: <span class="k">import</span> <span class="nn">itertools</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_itertools, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_itertools, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0020</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0021</span>: <span class="k">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">issparse</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_issparse);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_issparse);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_issparse);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_sparse, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_issparse);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_issparse, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0022</span>: <span class="k">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">csc_matrix</span></pre>
<pre class='cython code score-19 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_csc_matrix);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_csc_matrix);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_csc_matrix);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_sparse, __pyx_t_3, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_csc_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_csc_matrix, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0023</span>: <span class="k">from</span> <span class="nn">scipy.sparse</span> <span class="k">import</span> <span class="n">csr_matrix</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_csr_matrix);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_csr_matrix);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_csr_matrix);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_sparse, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_csr_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_csr_matrix, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0024</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0025</span>: <span class="k">from</span> <span class="nn">sklearn.tree._utils</span> <span class="k">cimport</span> <span class="n">Stack</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0026</span>: <span class="k">from</span> <span class="nn">sklearn.tree._utils</span> <span class="k">cimport</span> <span class="n">StackRecord</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: <span class="k">from</span> <span class="nn">sklearn.tree._utils</span> <span class="k">cimport</span> <span class="n">PriorityHeap</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0028</span>: <span class="k">from</span> <span class="nn">sklearn.tree._utils</span> <span class="k">cimport</span> <span class="n">PriorityHeapRecord</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0029</span>: <span class="k">from</span> <span class="nn">sklearn.tree._utils</span> <span class="k">cimport</span> <span class="n">safe_realloc</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0030</span>: <span class="k">from</span> <span class="nn">sklearn.tree._utils</span> <span class="k">cimport</span> <span class="n">sizet_ptr_to_ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0031</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0032</span>: <span class="k">from</span> <span class="nn">_criterion</span> <span class="k">import</span> <span class="n">Criterion</span></pre>
<pre class='cython code score-19 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Criterion);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Criterion);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_Criterion);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_criterion_2, __pyx_t_3, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_Criterion);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Criterion, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0033</span>: <span class="k">from</span> <span class="nn">_criterion</span> <span class="k">import</span> <span class="n">KernelizedMSE</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_KernelizedMSE);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_KernelizedMSE);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_KernelizedMSE);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_criterion_2, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_KernelizedMSE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_KernelizedMSE, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0034</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0035</span>: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;numpy/arrayobject.h&quot;</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0036</span>:     <span class="nb">object</span> <span class="n">PyArray_NewFromDescr</span><span class="p">(</span><span class="n">PyTypeObject</span><span class="o">*</span> <span class="n">subtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="n">descr</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>:                                 <span class="nb">int</span> <span class="n">nd</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">npy_intp</span><span class="o">*</span> <span class="n">dims</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>:                                 <span class="n">np</span><span class="o">.</span><span class="n">npy_intp</span><span class="o">*</span> <span class="n">strides</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0039</span>:                                 <span class="n">void</span><span class="o">*</span> <span class="n">data</span><span class="p">,</span> <span class="nb">int</span> <span class="n">flags</span><span class="p">,</span> <span class="nb">object</span> <span class="n">obj</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>:     <span class="nb">int</span> <span class="n">PyArray_SetBaseObject</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">arr</span><span class="p">,</span> <span class="n">PyObject</span><span class="o">*</span> <span class="n">obj</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0041</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>: <span class="c"># =============================================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0043</span>: <span class="c"># Types and constants</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0044</span>: <span class="c"># =============================================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0046</span>: <span class="k">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">float32</span> <span class="k">as</span> <span class="n">DTYPE</span></pre>
<pre class='cython code score-19 '>  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_float32);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_float32);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_float32);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, __pyx_t_3, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DTYPE, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0047</span>: <span class="k">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">float64</span> <span class="k">as</span> <span class="n">DOUBLE</span></pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_float64);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_float64);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_float64);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DOUBLE, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0048</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0049</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">INFINITY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span></pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_inf);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_13stpredictions_6models_3OK3_5_tree_INFINITY = __pyx_t_4;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0050</span>: <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">EPSILON</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="s">&#39;double&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span></pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_finfo);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__48, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_eps);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_13stpredictions_6models_3OK3_5_tree_EPSILON = __pyx_t_4;
/* … */
  __pyx_tuple__48 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_double);<span class='error_goto'> if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__48);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__48);
</pre><pre class="cython line score-0">&#xA0;<span class="">0051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>: <span class="c"># Some handy constants (BestFirstTreeBuilder)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0053</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">IS_FIRST</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_13stpredictions_6models_3OK3_5_tree_IS_FIRST = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0054</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">IS_NOT_FIRST</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_13stpredictions_6models_3OK3_5_tree_IS_NOT_FIRST = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0055</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">IS_LEFT</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_13stpredictions_6models_3OK3_5_tree_IS_LEFT = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0056</span>: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">IS_NOT_LEFT</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_13stpredictions_6models_3OK3_5_tree_IS_NOT_LEFT = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0057</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0058</span>: <span class="n">TREE_LEAF</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_TREE_LEAF, __pyx_int_neg_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 58, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0059</span>: <span class="n">TREE_UNDEFINED</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2</span></pre>
<pre class='cython code score-5 '>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_TREE_UNDEFINED, __pyx_int_neg_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0060</span>: <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">_TREE_LEAF</span> <span class="o">=</span> <span class="n">TREE_LEAF</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_TREE_LEAF);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_3); if (unlikely((__pyx_t_5 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF = __pyx_t_5;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0061</span>: <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">_TREE_UNDEFINED</span> <span class="o">=</span> <span class="n">TREE_UNDEFINED</span></pre>
<pre class='cython code score-10 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_TREE_UNDEFINED);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_3); if (unlikely((__pyx_t_5 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_UNDEFINED = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0062</span>: <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">INITIAL_STACK_SIZE</span> <span class="o">=</span> <span class="mf">10</span></pre>
<pre class='cython code score-0 '>  __pyx_v_13stpredictions_6models_3OK3_5_tree_INITIAL_STACK_SIZE = 10;
</pre><pre class="cython line score-0">&#xA0;<span class="">0063</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>: <span class="c"># Build the corresponding numpy dtype for Node.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0065</span>: <span class="c"># This works by casting `dummy` to an array of Node of length 1, which numpy</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0066</span>: <span class="c"># can construct a `dtype`-object for. See https://stackoverflow.com/q/62448946</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>: <span class="c"># for a more detailed explanation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>: <span class="k">cdef</span> <span class="kt">Node</span> <span class="kt">dummy</span>;</pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0069</span>: <span class="n">NODE_DTYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="o">&lt;</span><span class="n">Node</span><span class="p">[:</span><span class="mf">1</span><span class="p">]</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dummy</span><span class="p">))</span><span class="o">.</span><span class="n">dtype</span></pre>
<pre class='cython code score-26 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = (&amp;__pyx_v_13stpredictions_6models_3OK3_5_tree_dummy);
  if (!__pyx_t_6) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ValueError,"Cannot create cython.array from NULL pointer");
    <span class='error_goto'>__PYX_ERR(0, 69, __pyx_L1_error)</span>
  }
  __pyx_t_8 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_nn_struct____pyx_t_13stpredictions_6models_3OK3_5_tree_Node);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_3 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = __pyx_array_new(__pyx_t_3, sizeof(struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_8), (char *) "c", (char *) __pyx_t_6);
  if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, ((PyObject *)__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_7)); __pyx_t_7 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_NODE_DTYPE, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>: <span class="c"># =============================================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0072</span>: <span class="c"># TreeBuilder</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0073</span>: <span class="c"># =============================================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0075</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">TreeBuilder</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_TreeBuilder {
  PyObject *(*build)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *, PyArrayObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_13stpredictions_6models_3OK3_5_tree_11TreeBuilder_build *__pyx_optional_args);
  PyObject *(*_check_input)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *, PyObject *, PyArrayObject *, PyArrayObject *);
};
static struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_TreeBuilder *__pyx_vtabptr_13stpredictions_6models_3OK3_5_tree_TreeBuilder;
static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_11TreeBuilder__check_input(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *, PyObject *, PyArrayObject *, PyArrayObject *);

</pre><pre class="cython line score-0">&#xA0;<span class="">0076</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Interface for different tree building strategies.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0077</span>: </pre>
<pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0078</span>:     <span class="k">cpdef</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tree</span> <span class="n">tree</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">y</span><span class="p">,</span></pre>
<pre class='cython code score-59 '>static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_11TreeBuilder_1build(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_11TreeBuilder_build(CYTHON_UNUSED struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *__pyx_v_self, CYTHON_UNUSED struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree, CYTHON_UNUSED PyObject *__pyx_v_X, CYTHON_UNUSED PyArrayObject *__pyx_v_y, int __pyx_skip_dispatch, struct __pyx_opt_args_13stpredictions_6models_3OK3_5_tree_11TreeBuilder_build *__pyx_optional_args) {
/* … */
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_build);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_13stpredictions_6models_3OK3_5_tree_11TreeBuilder_1build)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        __pyx_t_5 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
            __pyx_t_5 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[5] = {__pyx_t_4, ((PyObject *)__pyx_v_tree), __pyx_v_X, ((PyObject *)__pyx_v_y), ((PyObject *)__pyx_v_sample_weight)};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[5] = {__pyx_t_4, ((PyObject *)__pyx_v_tree), __pyx_v_X, ((PyObject *)__pyx_v_y), ((PyObject *)__pyx_v_sample_weight)};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        } else
        #endif
        {
          __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          if (__pyx_t_4) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_tree));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_tree));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, ((PyObject *)__pyx_v_tree));
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, __pyx_v_X);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_y));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_y));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_5, ((PyObject *)__pyx_v_y));
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_sample_weight));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_sample_weight));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3+__pyx_t_5, ((PyObject *)__pyx_v_sample_weight));
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_r = __pyx_t_2;
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.TreeBuilder.build", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_11TreeBuilder_1build(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_11TreeBuilder_build[] = "Build a decision tree from the training set (X, y).";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_11TreeBuilder_1build(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree = 0;
  PyObject *__pyx_v_X = 0;
  PyArrayObject *__pyx_v_y = 0;
  PyArrayObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("build (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_tree,&amp;__pyx_n_s_X,&amp;__pyx_n_s_y,&amp;__pyx_n_s_sample_weight,0};
    PyObject* values[4] = {0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_11TreeBuilder_build(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *__pyx_v_self, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree, PyObject *__pyx_v_X, PyArrayObject *__pyx_v_y, PyArrayObject *__pyx_v_sample_weight) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("build", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.sample_weight = __pyx_v_sample_weight;
  __pyx_t_1 = __pyx_vtabptr_13stpredictions_6models_3OK3_5_tree_TreeBuilder-&gt;build(__pyx_v_self, __pyx_v_tree, __pyx_v_X, __pyx_v_y, 1, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.TreeBuilder.build", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0079</span>:                 <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">sample_weight</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-40 '>  PyArrayObject *__pyx_v_sample_weight = ((PyArrayObject *)Py_None);
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("build", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_sample_weight = __pyx_optional_args-&gt;sample_weight;
    }
  }
/* … */
    values[3] = (PyObject *)((PyArrayObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_tree)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_X)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 78, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 78, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_sample_weight);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "build") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 78, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_tree = ((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)values[0]);
    __pyx_v_X = values[1];
    __pyx_v_y = ((PyArrayObject *)values[2]);
    __pyx_v_sample_weight = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 78, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.TreeBuilder.build", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_tree), __pyx_ptype_13stpredictions_6models_3OK3_5_tree_Tree, 1, "tree", 0))) <span class='error_goto'>__PYX_ERR(0, 78, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_y), __pyx_ptype_5numpy_ndarray, 1, "y", 0))) <span class='error_goto'>__PYX_ERR(0, 78, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sample_weight), __pyx_ptype_5numpy_ndarray, 1, "sample_weight", 0))) <span class='error_goto'>__PYX_ERR(0, 79, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_11TreeBuilder_build(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *)__pyx_v_self), __pyx_v_tree, __pyx_v_X, __pyx_v_y, __pyx_v_sample_weight);
</pre><pre class="cython line score-0">&#xA0;<span class="">0080</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a decision tree from the training set (X, y).&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0081</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0083</span>:     <span class="k">cdef</span> <span class="kr">inline</span> <span class="nf">_check_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">y</span><span class="p">,</span></pre>
<pre class='cython code score-12 '>static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_11TreeBuilder__check_input(CYTHON_UNUSED struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *__pyx_v_self, PyObject *__pyx_v_X, PyArrayObject *__pyx_v_y, PyArrayObject *__pyx_v_sample_weight) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_check_input", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_sample_weight);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.TreeBuilder._check_input", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_sample_weight);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0084</span>:                              <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">sample_weight</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0085</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Check input dtype, layout and format&quot;&quot;&quot;</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0086</span>:         <span class="k">if</span> <span class="n">issparse</span><span class="p">(</span><span class="n">X</span><span class="p">):</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_issparse);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_X) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_4) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0087</span>:             <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">tocsc</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_tocsc);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_X, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0088</span>:             <span class="n">X</span><span class="o">.</span><span class="n">sort_indices</span><span class="p">()</span></pre>
<pre class='cython code score-19 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_sort_indices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0089</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0090</span>:             <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">DTYPE</span><span class="p">:</span></pre>
<pre class='cython code score-17 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_1, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 90, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 90, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_4) {
/* … */
    }
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0091</span>:                 <span class="n">X</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3);
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_X, __pyx_n_s_data, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0092</span>: </pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0093</span>:             <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">indices</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span> <span class="ow">or</span> <span class="n">X</span><span class="o">.</span><span class="n">indptr</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">:</span></pre>
<pre class='cython code score-40 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_indices);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (!__pyx_t_6) {
    } else {
      __pyx_t_4 = __pyx_t_6;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_indptr);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_3, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_4 = __pyx_t_6;
    __pyx_L6_bool_binop_done:;
    if (unlikely(__pyx_t_4)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0094</span>:                 <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;No support for np.int64 index based &quot;</span></pre>
<pre class='cython code score-10 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='error_goto'>__PYX_ERR(0, 94, __pyx_L1_error)</span>
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_No_support_for_np_int64_index_ba);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class="cython line score-0">&#xA0;<span class="">0095</span>:                                  <span class="s">&quot;sparse matrices&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0096</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0097</span>:         <span class="k">elif</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">DTYPE</span><span class="p">:</span></pre>
<pre class='cython code score-14 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_3, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_4) {
/* … */
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0098</span>:             <span class="c"># since we have to copy we will make it fortran for efficiency</span></pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0099</span>:             <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asfortranarray</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-28 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asfortranarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_X);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_X, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0100</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0101</span>:         <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">DOUBLE</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">y</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">contiguous</span><span class="p">:</span></pre>
<pre class='cython code score-22 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_y), __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_DOUBLE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_5, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!__pyx_t_6) {
  } else {
    __pyx_t_4 = __pyx_t_6;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_y), __pyx_n_s_flags);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_contiguous);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = ((!__pyx_t_6) != 0);
  __pyx_t_4 = __pyx_t_7;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0102</span>:             <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ascontiguousarray</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DOUBLE</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_y));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_y));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)__pyx_v_y));
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DOUBLE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, ((PyArrayObject *)__pyx_t_3));
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0103</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0104</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span></pre>
<pre class='cython code score-0 '>  __pyx_t_7 = (((PyObject *)__pyx_v_sample_weight) != Py_None);
  __pyx_t_6 = (__pyx_t_7 != 0);
  if (__pyx_t_6) {
  } else {
    __pyx_t_4 = __pyx_t_6;
    goto __pyx_L12_bool_binop_done;
  }
/* … */
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0105</span>:             <span class="p">(</span><span class="n">sample_weight</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">DOUBLE</span> <span class="ow">or</span></pre>
<pre class='cython code score-14 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_sample_weight), __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DOUBLE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_1, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 105, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 105, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!__pyx_t_6) {
  } else {
    __pyx_t_4 = __pyx_t_6;
    goto __pyx_L12_bool_binop_done;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0106</span>:             <span class="ow">not</span> <span class="n">sample_weight</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">contiguous</span><span class="p">)):</span></pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_sample_weight), __pyx_n_s_flags);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_contiguous);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_7 = ((!__pyx_t_6) != 0);
  __pyx_t_4 = __pyx_t_7;
  __pyx_L12_bool_binop_done:;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0107</span>:                 <span class="n">sample_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">sample_weight</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DOUBLE</span><span class="p">,</span></pre>
<pre class='cython code score-35 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_sample_weight));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_sample_weight));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_v_sample_weight));
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_DOUBLE);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_order, __pyx_n_s_C) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sample_weight, ((PyArrayObject *)__pyx_t_2));
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0108</span>:                                            <span class="n">order</span><span class="o">=</span><span class="s">&quot;C&quot;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0109</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0110</span>:         <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span></pre>
<pre class='cython code score-12 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_y));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_y));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, ((PyObject *)__pyx_v_y));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_sample_weight));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_sample_weight));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject *)__pyx_v_sample_weight));
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0111</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>: <span class="c"># Depth first builder ---------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0114</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">DepthFirstTreeBuilder</span><span class="p">(</span><span class="n">TreeBuilder</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_DepthFirstTreeBuilder {
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder __pyx_base;
};
/* … */
struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_DepthFirstTreeBuilder {
  struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_TreeBuilder __pyx_base;
};
static struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_DepthFirstTreeBuilder *__pyx_vtabptr_13stpredictions_6models_3OK3_5_tree_DepthFirstTreeBuilder;

</pre><pre class="cython line score-0">&#xA0;<span class="">0115</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a decision tree in depth-first fashion.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0116</span>: </pre>
<pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0117</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Splitter</span> <span class="n">splitter</span><span class="p">,</span> <span class="n">SIZE_t</span> <span class="n">min_samples_split</span><span class="p">,</span></pre>
<pre class='cython code score-107 '>/* Python wrapper */
static int __pyx_pw_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *__pyx_v_splitter = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_split;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_leaf;
  double __pyx_v_min_weight_leaf;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_depth;
  double __pyx_v_min_impurity_decrease;
  double __pyx_v_min_impurity_split;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_splitter,&amp;__pyx_n_s_min_samples_split,&amp;__pyx_n_s_min_samples_leaf,&amp;__pyx_n_s_min_weight_leaf,&amp;__pyx_n_s_max_depth,&amp;__pyx_n_s_min_impurity_decrease,&amp;__pyx_n_s_min_impurity_split,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_splitter)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_samples_split)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 7, 7, 1); <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_samples_leaf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 7, 7, 2); <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_weight_leaf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 7, 7, 3); <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_depth)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 7, 7, 4); <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_impurity_decrease)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 7, 7, 5); <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_impurity_split)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 7, 7, 6); <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_splitter = ((struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *)values[0]);
    __pyx_v_min_samples_split = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(values[1]); if (unlikely((__pyx_v_min_samples_split == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L3_error)</span>
    __pyx_v_min_samples_leaf = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(values[2]); if (unlikely((__pyx_v_min_samples_leaf == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
    __pyx_v_min_weight_leaf = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_min_weight_leaf == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
    __pyx_v_max_depth = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(values[4]); if (unlikely((__pyx_v_max_depth == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
    __pyx_v_min_impurity_decrease = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_min_impurity_decrease == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 119, __pyx_L3_error)</span>
    __pyx_v_min_impurity_split = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]); if (unlikely((__pyx_v_min_impurity_split == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.DepthFirstTreeBuilder.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_splitter), __pyx_ptype_13stpredictions_6models_3OK3_9_splitter_Splitter, 1, "splitter", 0))) <span class='error_goto'>__PYX_ERR(0, 117, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder___cinit__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_DepthFirstTreeBuilder *)__pyx_v_self), __pyx_v_splitter, __pyx_v_min_samples_split, __pyx_v_min_samples_leaf, __pyx_v_min_weight_leaf, __pyx_v_max_depth, __pyx_v_min_impurity_decrease, __pyx_v_min_impurity_split);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder___cinit__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_DepthFirstTreeBuilder *__pyx_v_self, struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *__pyx_v_splitter, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_split, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_leaf, double __pyx_v_min_weight_leaf, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_depth, double __pyx_v_min_impurity_decrease, double __pyx_v_min_impurity_split) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0118</span>:                   <span class="n">SIZE_t</span> <span class="n">min_samples_leaf</span><span class="p">,</span> <span class="n">double</span> <span class="n">min_weight_leaf</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0119</span>:                   <span class="n">SIZE_t</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">double</span> <span class="n">min_impurity_decrease</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0120</span>:                   <span class="n">double</span> <span class="n">min_impurity_split</span><span class="p">):</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0121</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span> <span class="o">=</span> <span class="n">splitter</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_splitter));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_splitter));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.splitter);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.splitter));
  __pyx_v_self-&gt;__pyx_base.splitter = __pyx_v_splitter;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0122</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span> <span class="o">=</span> <span class="n">min_samples_split</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.min_samples_split = __pyx_v_min_samples_split;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0123</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="n">min_samples_leaf</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.min_samples_leaf = __pyx_v_min_samples_leaf;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0124</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_weight_leaf</span> <span class="o">=</span> <span class="n">min_weight_leaf</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.min_weight_leaf = __pyx_v_min_weight_leaf;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0125</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.max_depth = __pyx_v_max_depth;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0126</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_impurity_decrease</span> <span class="o">=</span> <span class="n">min_impurity_decrease</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.min_impurity_decrease = __pyx_v_min_impurity_decrease;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0127</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_impurity_split</span> <span class="o">=</span> <span class="n">min_impurity_split</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.min_impurity_split = __pyx_v_min_impurity_split;
</pre><pre class="cython line score-0">&#xA0;<span class="">0128</span>: </pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0129</span>:     <span class="k">cpdef</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tree</span> <span class="n">tree</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">y</span><span class="p">,</span></pre>
<pre class='cython code score-64 '>static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_3build(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_build(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_DepthFirstTreeBuilder *__pyx_v_self, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree, PyObject *__pyx_v_X, PyArrayObject *__pyx_v_y, int __pyx_skip_dispatch, struct __pyx_opt_args_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_build *__pyx_optional_args) {
/* … */
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_build);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_3build)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        __pyx_t_5 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
            __pyx_t_5 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[5] = {__pyx_t_4, ((PyObject *)__pyx_v_tree), __pyx_v_X, ((PyObject *)__pyx_v_y), ((PyObject *)__pyx_v_sample_weight)};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[5] = {__pyx_t_4, ((PyObject *)__pyx_v_tree), __pyx_v_X, ((PyObject *)__pyx_v_y), ((PyObject *)__pyx_v_sample_weight)};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        } else
        #endif
        {
          __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          if (__pyx_t_4) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_tree));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_tree));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, ((PyObject *)__pyx_v_tree));
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, __pyx_v_X);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_y));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_y));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_5, ((PyObject *)__pyx_v_y));
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_sample_weight));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_sample_weight));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3+__pyx_t_5, ((PyObject *)__pyx_v_sample_weight));
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_r = __pyx_t_2;
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.DepthFirstTreeBuilder.build", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_splitter);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_stack);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_sample_weight);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_3build(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_2build[] = "Build a decision tree from the training set (X, y).";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_3build(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree = 0;
  PyObject *__pyx_v_X = 0;
  PyArrayObject *__pyx_v_y = 0;
  PyArrayObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("build (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_tree,&amp;__pyx_n_s_X,&amp;__pyx_n_s_y,&amp;__pyx_n_s_sample_weight,0};
    PyObject* values[4] = {0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_2build(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_DepthFirstTreeBuilder *__pyx_v_self, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree, PyObject *__pyx_v_X, PyArrayObject *__pyx_v_y, PyArrayObject *__pyx_v_sample_weight) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("build", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.sample_weight = __pyx_v_sample_weight;
  __pyx_t_1 = __pyx_vtabptr_13stpredictions_6models_3OK3_5_tree_DepthFirstTreeBuilder-&gt;__pyx_base.build(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *)__pyx_v_self), __pyx_v_tree, __pyx_v_X, __pyx_v_y, 1, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.DepthFirstTreeBuilder.build", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_build {
  int __pyx_n;
  PyArrayObject *sample_weight;
};
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0130</span>:                 <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">sample_weight</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-43 '>  PyArrayObject *__pyx_v_sample_weight = ((PyArrayObject *)Py_None);
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *__pyx_v_sample_weight_ptr;
  int __pyx_v_init_capacity;
  struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *__pyx_v_splitter = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_depth;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_leaf;
  double __pyx_v_min_weight_leaf;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_split;
  double __pyx_v_min_impurity_decrease;
  double __pyx_v_min_impurity_split;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_start;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_end;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_depth;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_parent;
  int __pyx_v_is_left;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_node_samples;
  CYTHON_UNUSED double __pyx_v_weighted_n_samples;
  double __pyx_v_weighted_n_node_samples;
  struct __pyx_t_13stpredictions_6models_3OK3_9_splitter_SplitRecord __pyx_v_split;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_node_id;
  double __pyx_v_impurity;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_constant_features;
  int __pyx_v_is_leaf;
  int __pyx_v_first;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_depth_seen;
  int __pyx_v_rc;
  struct __pyx_obj_7sklearn_4tree_6_utils_Stack *__pyx_v_stack = 0;
  struct __pyx_t_7sklearn_4tree_6_utils_StackRecord __pyx_v_stack_record;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("build", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_sample_weight = __pyx_optional_args-&gt;sample_weight;
    }
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_sample_weight);
/* … */
    values[3] = (PyObject *)((PyArrayObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_tree)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_X)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_sample_weight);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "build") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_tree = ((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)values[0]);
    __pyx_v_X = values[1];
    __pyx_v_y = ((PyArrayObject *)values[2]);
    __pyx_v_sample_weight = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.DepthFirstTreeBuilder.build", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_tree), __pyx_ptype_13stpredictions_6models_3OK3_5_tree_Tree, 1, "tree", 0))) <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_y), __pyx_ptype_5numpy_ndarray, 1, "y", 0))) <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sample_weight), __pyx_ptype_5numpy_ndarray, 1, "sample_weight", 0))) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_21DepthFirstTreeBuilder_2build(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_DepthFirstTreeBuilder *)__pyx_v_self), __pyx_v_tree, __pyx_v_X, __pyx_v_y, __pyx_v_sample_weight);
</pre><pre class="cython line score-0">&#xA0;<span class="">0131</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a decision tree from the training set (X, y).&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0132</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0133</span>:         <span class="c"># check input</span></pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0134</span>:         <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_input</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span></pre>
<pre class='cython code score-55 '>  __pyx_t_1 = __pyx_f_13stpredictions_6models_3OK3_5_tree_11TreeBuilder__check_input(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *)__pyx_v_self), __pyx_v_X, __pyx_v_y, __pyx_v_sample_weight);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_7(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_7(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 2; __pyx_t_6 = __pyx_t_7(__pyx_t_4); if (unlikely(!__pyx_t_6)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_4), 3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
    __pyx_t_7 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_7 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_X, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, ((PyArrayObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sample_weight, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0135</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0136</span>:         <span class="k">cdef</span> <span class="kt">DOUBLE_t</span>* <span class="nf">sample_weight_ptr</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_sample_weight_ptr = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0137</span>:         <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (((PyObject *)__pyx_v_sample_weight) != Py_None);
  __pyx_t_9 = (__pyx_t_8 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0138</span>:             <span class="n">sample_weight_ptr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">DOUBLE_t</span><span class="o">*&gt;</span> <span class="n">sample_weight</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>    __pyx_v_sample_weight_ptr = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *)__pyx_v_sample_weight-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">0139</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>:         <span class="c"># Initial capacity</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">init_capacity</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0142</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0143</span>:         <span class="k">if</span> <span class="n">tree</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">&lt;=</span> <span class="mf">10</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = ((__pyx_v_tree-&gt;max_depth &lt;= 10) != 0);
  if (__pyx_t_9) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0144</span>:             <span class="n">init_capacity</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">+</span> <span class="mf">1</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_init_capacity = (__Pyx_pow_long(2, (__pyx_v_tree-&gt;max_depth + 1)) - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0145</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0146</span>:             <span class="n">init_capacity</span> <span class="o">=</span> <span class="mf">2047</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_init_capacity = 0x7FF;
  }
  __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0147</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0148</span>:         <span class="n">tree</span><span class="o">.</span><span class="n">_resize</span><span class="p">(</span><span class="n">init_capacity</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_tree-&gt;__pyx_vtab)-&gt;_resize(__pyx_v_tree, __pyx_v_init_capacity);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 148, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0149</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>:         <span class="c"># Parameters</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0151</span>:         <span class="k">cdef</span> <span class="kt">Splitter</span> <span class="nf">splitter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span></pre>
<pre class='cython code score-1 '>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.splitter);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_splitter = ((struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0152</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">max_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;__pyx_base.max_depth;
  __pyx_v_max_depth = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0153</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">min_samples_leaf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;__pyx_base.min_samples_leaf;
  __pyx_v_min_samples_leaf = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0154</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">min_weight_leaf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_weight_leaf</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_self-&gt;__pyx_base.min_weight_leaf;
  __pyx_v_min_weight_leaf = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0155</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">min_samples_split</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;__pyx_base.min_samples_split;
  __pyx_v_min_samples_split = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0156</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">min_impurity_decrease</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_impurity_decrease</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_self-&gt;__pyx_base.min_impurity_decrease;
  __pyx_v_min_impurity_decrease = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0157</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">min_impurity_split</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_impurity_split</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_self-&gt;__pyx_base.min_impurity_split;
  __pyx_v_min_impurity_split = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0158</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0159</span>:         <span class="c"># Recursive partition (without actual recursion)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0160</span>:         <span class="n">splitter</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight_ptr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_nn___pyx_t_7sklearn_4tree_5_tree_DOUBLE_t__const__(((PyObject *)__pyx_v_y), 0);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 160, __pyx_L1_error)</span>
  __pyx_t_5 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_v_splitter-&gt;__pyx_vtab)-&gt;init(__pyx_v_splitter, __pyx_v_X, __pyx_t_12, __pyx_v_sample_weight_ptr);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 160, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">start</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0163</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">end</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0164</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">depth</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0165</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">parent</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0166</span>:         <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_left</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0167</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_node_samples</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">n_samples</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __pyx_v_splitter-&gt;n_samples;
  __pyx_v_n_node_samples = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0168</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">weighted_n_samples</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">weighted_n_samples</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_splitter-&gt;weighted_n_samples;
  __pyx_v_weighted_n_samples = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">0169</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">weighted_n_node_samples</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>:         <span class="k">cdef</span> <span class="kt">SplitRecord</span> <span class="nf">split</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">node_id</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0172</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0173</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">impurity</span> <span class="o">=</span> <span class="n">INFINITY</span></pre>
<pre class='cython code score-0 '>  __pyx_v_impurity = __pyx_v_13stpredictions_6models_3OK3_5_tree_INFINITY;
</pre><pre class="cython line score-0">&#xA0;<span class="">0174</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_constant_features</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0175</span>:         <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_leaf</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0176</span>:         <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">first</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_first = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0177</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">max_depth_seen</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_max_depth_seen = -1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0178</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">rc</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rc = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0179</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0180</span>:         <span class="k">cdef</span> <span class="kt">Stack</span> <span class="nf">stack</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">(</span><span class="n">INITIAL_STACK_SIZE</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_13stpredictions_6models_3OK3_5_tree_INITIAL_STACK_SIZE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7sklearn_4tree_6_utils_Stack), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_stack = ((struct __pyx_obj_7sklearn_4tree_6_utils_Stack *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0181</span>:         <span class="k">cdef</span> <span class="kt">StackRecord</span> <span class="nf">stack_record</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0182</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0183</span>:         <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-6 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L9;
        }
        __pyx_L8_error: {
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L1_error;
        }
        __pyx_L9:;
      }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0184</span>:             <span class="c"># push root node onto stack</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0185</span>:             <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="n">n_node_samples</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">_TREE_UNDEFINED</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">INFINITY</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_t_5 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, 0, __pyx_v_n_node_samples, 0, __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_UNDEFINED, 0, __pyx_v_13stpredictions_6models_3OK3_5_tree_INFINITY, 0);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 185, __pyx_L8_error)</span>
        __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0186</span>:             <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_9 = ((__pyx_v_rc == -1L) != 0);
        if (__pyx_t_9) {
/* … */
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0187</span>:                 <span class="c"># got return code -1 - out-of-memory</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>:                 <span class="k">with</span> <span class="k">gil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>          {
              #ifdef WITH_THREAD
              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
              #endif
              /*try:*/ {
/* … */
              /*finally:*/ {
                __pyx_L12_error: {
                  #ifdef WITH_THREAD
                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                  #endif
                  goto __pyx_L8_error;
                }
              }
          }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0189</span>:                     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>                <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L12_error)</span>
              }
</pre><pre class="cython line score-0">&#xA0;<span class="">0190</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0191</span>:             <span class="k">while</span> <span class="ow">not</span> <span class="n">stack</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_9 = ((!(((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;is_empty(__pyx_v_stack) != 0)) != 0);
          if (!__pyx_t_9) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0192</span>:                 <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stack_record</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          (void)(((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;pop(__pyx_v_stack, (&amp;__pyx_v_stack_record)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0193</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0194</span>:                 <span class="n">start</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">start</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_stack_record.start;
          __pyx_v_start = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0195</span>:                 <span class="n">end</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">end</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_stack_record.end;
          __pyx_v_end = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0196</span>:                 <span class="n">depth</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">depth</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_stack_record.depth;
          __pyx_v_depth = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0197</span>:                 <span class="n">parent</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">parent</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_stack_record.parent;
          __pyx_v_parent = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0198</span>:                 <span class="n">is_left</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">is_left</span></pre>
<pre class='cython code score-0 '>          __pyx_t_9 = __pyx_v_stack_record.is_left;
          __pyx_v_is_left = __pyx_t_9;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0199</span>:                 <span class="n">impurity</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">impurity</span></pre>
<pre class='cython code score-0 '>          __pyx_t_11 = __pyx_v_stack_record.impurity;
          __pyx_v_impurity = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0200</span>:                 <span class="n">n_constant_features</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">n_constant_features</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_stack_record.n_constant_features;
          __pyx_v_n_constant_features = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">0201</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0202</span>:                 <span class="n">n_node_samples</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span></pre>
<pre class='cython code score-0 '>          __pyx_v_n_node_samples = (__pyx_v_end - __pyx_v_start);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0203</span>:                 <span class="n">splitter</span><span class="o">.</span><span class="n">node_reset</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">weighted_n_node_samples</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_t_5 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_v_splitter-&gt;__pyx_vtab)-&gt;node_reset(__pyx_v_splitter, __pyx_v_start, __pyx_v_end, (&amp;__pyx_v_weighted_n_node_samples));<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 203, __pyx_L8_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0204</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0205</span>:                 <span class="n">is_leaf</span> <span class="o">=</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&gt;=</span> <span class="n">max_depth</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>          __pyx_t_8 = ((__pyx_v_depth &gt;= __pyx_v_max_depth) != 0);
          if (!__pyx_t_8) {
          } else {
            __pyx_t_9 = __pyx_t_8;
            goto __pyx_L16_bool_binop_done;
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0206</span>:                            <span class="n">n_node_samples</span> <span class="o">&lt;</span> <span class="n">min_samples_split</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>          __pyx_t_8 = ((__pyx_v_n_node_samples &lt; __pyx_v_min_samples_split) != 0);
          if (!__pyx_t_8) {
          } else {
            __pyx_t_9 = __pyx_t_8;
            goto __pyx_L16_bool_binop_done;
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0207</span>:                            <span class="n">n_node_samples</span> <span class="o">&lt;</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">min_samples_leaf</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>          __pyx_t_8 = ((__pyx_v_n_node_samples &lt; (2 * __pyx_v_min_samples_leaf)) != 0);
          if (!__pyx_t_8) {
          } else {
            __pyx_t_9 = __pyx_t_8;
            goto __pyx_L16_bool_binop_done;
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0208</span>:                            <span class="n">weighted_n_node_samples</span> <span class="o">&lt;</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">min_weight_leaf</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_t_8 = ((__pyx_v_weighted_n_node_samples &lt; (2.0 * __pyx_v_min_weight_leaf)) != 0);
          __pyx_t_9 = __pyx_t_8;
          __pyx_L16_bool_binop_done:;
          __pyx_v_is_leaf = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">0209</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0210</span>:                 <span class="k">if</span> <span class="n">first</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_9 = (__pyx_v_first != 0);
          if (__pyx_t_9) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0211</span>:                     <span class="n">impurity</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">node_impurity</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>            __pyx_v_impurity = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_v_splitter-&gt;__pyx_vtab)-&gt;node_impurity(__pyx_v_splitter);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0212</span>:                     <span class="n">first</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>            __pyx_v_first = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0213</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0214</span>:                 <span class="n">is_leaf</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_leaf</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>          __pyx_t_8 = (__pyx_v_is_leaf != 0);
          if (!__pyx_t_8) {
          } else {
            __pyx_t_9 = __pyx_t_8;
            goto __pyx_L21_bool_binop_done;
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0215</span>:                            <span class="p">(</span><span class="n">impurity</span> <span class="o">&lt;=</span> <span class="n">min_impurity_split</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>          __pyx_t_8 = ((__pyx_v_impurity &lt;= __pyx_v_min_impurity_split) != 0);
          __pyx_t_9 = __pyx_t_8;
          __pyx_L21_bool_binop_done:;
          __pyx_v_is_leaf = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">0216</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0217</span>:                 <span class="k">if</span> <span class="ow">not</span> <span class="n">is_leaf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_9 = ((!(__pyx_v_is_leaf != 0)) != 0);
          if (__pyx_t_9) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0218</span>:                     <span class="n">splitter</span><span class="o">.</span><span class="n">node_split</span><span class="p">(</span><span class="n">impurity</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">split</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n_constant_features</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_t_5 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_v_splitter-&gt;__pyx_vtab)-&gt;node_split(__pyx_v_splitter, __pyx_v_impurity, (&amp;__pyx_v_split), (&amp;__pyx_v_n_constant_features));<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 218, __pyx_L8_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0219</span>:                     <span class="c"># If EPSILON=0 in the below comparison, float precision</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0220</span>:                     <span class="c"># issues stop splitting, producing trees that are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0221</span>:                     <span class="c"># dissimilar to v0.18</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0222</span>:                     <span class="n">is_leaf</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_leaf</span> <span class="ow">or</span> <span class="n">split</span><span class="o">.</span><span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">end</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>            __pyx_t_8 = (__pyx_v_is_leaf != 0);
            if (!__pyx_t_8) {
            } else {
              __pyx_t_9 = __pyx_t_8;
              goto __pyx_L24_bool_binop_done;
            }
            __pyx_t_8 = ((__pyx_v_split.pos &gt;= __pyx_v_end) != 0);
            if (!__pyx_t_8) {
            } else {
              __pyx_t_9 = __pyx_t_8;
              goto __pyx_L24_bool_binop_done;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0223</span>:                                <span class="p">(</span><span class="n">split</span><span class="o">.</span><span class="n">improvement</span> <span class="o">+</span> <span class="n">EPSILON</span> <span class="o">&lt;</span></pre>
<pre class='cython code score-0 '>            __pyx_t_8 = (((__pyx_v_split.improvement + __pyx_v_13stpredictions_6models_3OK3_5_tree_EPSILON) &lt; __pyx_v_min_impurity_decrease) != 0);
            __pyx_t_9 = __pyx_t_8;
            __pyx_L24_bool_binop_done:;
            __pyx_v_is_leaf = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">0224</span>:                                 <span class="n">min_impurity_decrease</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0225</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0226</span>:                 <span class="n">node_id</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">_add_node</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">is_left</span><span class="p">,</span> <span class="n">is_leaf</span><span class="p">,</span> <span class="n">split</span><span class="o">.</span><span class="n">feature</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>          __pyx_t_10 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_tree-&gt;__pyx_vtab)-&gt;_add_node(__pyx_v_tree, __pyx_v_parent, __pyx_v_is_left, __pyx_v_is_leaf, __pyx_v_split.feature, __pyx_v_split.threshold, __pyx_v_impurity, __pyx_v_n_node_samples, __pyx_v_weighted_n_node_samples);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)-1))) __PYX_ERR(0, 226, __pyx_L8_error)</span>
          __pyx_v_node_id = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">0227</span>:                                          <span class="n">split</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="n">impurity</span><span class="p">,</span> <span class="n">n_node_samples</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0228</span>:                                          <span class="n">weighted_n_node_samples</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0229</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0230</span>:                 <span class="k">if</span> <span class="n">node_id</span> <span class="o">==</span> <span class="n">SIZE_MAX</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_9 = ((__pyx_v_node_id == SIZE_MAX) != 0);
          if (__pyx_t_9) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0231</span>:                     <span class="n">rc</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>            __pyx_v_rc = -1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0232</span>:                     <span class="k">break</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L15_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0233</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0234</span>:                 <span class="c"># Store value for all nodes, to facilitate tree/model</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0235</span>:                 <span class="c"># inspection and interpretation</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0236</span>:                 <span class="n">splitter</span><span class="o">.</span><span class="n">node_value</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">node_id</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>          ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_v_splitter-&gt;__pyx_vtab)-&gt;node_value(__pyx_v_splitter, (__pyx_v_tree-&gt;value + (__pyx_v_node_id * (__pyx_v_y-&gt;dimensions[0]))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0237</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0238</span>:                 <span class="k">if</span> <span class="ow">not</span> <span class="n">is_leaf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_9 = ((!(__pyx_v_is_leaf != 0)) != 0);
          if (__pyx_t_9) {
/* … */
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">0239</span>:                     <span class="c"># Push right child on stack</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0240</span>:                     <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">split</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>            __pyx_t_5 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, __pyx_v_split.pos, __pyx_v_end, (__pyx_v_depth + 1), __pyx_v_node_id, 0, __pyx_v_split.impurity_right, __pyx_v_n_constant_features);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 240, __pyx_L8_error)</span>
            __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">0241</span>:                                     <span class="n">split</span><span class="o">.</span><span class="n">impurity_right</span><span class="p">,</span> <span class="n">n_constant_features</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0242</span>:                     <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_9 = ((__pyx_v_rc == -1L) != 0);
            if (__pyx_t_9) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0243</span>:                         <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L15_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0244</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0245</span>:                     <span class="c"># Push left child on stack</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0246</span>:                     <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">split</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>            __pyx_t_5 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, __pyx_v_start, __pyx_v_split.pos, (__pyx_v_depth + 1), __pyx_v_node_id, 1, __pyx_v_split.impurity_left, __pyx_v_n_constant_features);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 246, __pyx_L8_error)</span>
            __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">0247</span>:                                     <span class="n">split</span><span class="o">.</span><span class="n">impurity_left</span><span class="p">,</span> <span class="n">n_constant_features</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0248</span>:                     <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_9 = ((__pyx_v_rc == -1L) != 0);
            if (__pyx_t_9) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0249</span>:                         <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L15_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0250</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0251</span>:                 <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="n">max_depth_seen</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_9 = ((__pyx_v_depth &gt; __pyx_v_max_depth_seen) != 0);
          if (__pyx_t_9) {
/* … */
          }
        }
        __pyx_L15_break:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0252</span>:                     <span class="n">max_depth_seen</span> <span class="o">=</span> <span class="n">depth</span></pre>
<pre class='cython code score-0 '>            __pyx_v_max_depth_seen = __pyx_v_depth;
</pre><pre class="cython line score-0">&#xA0;<span class="">0253</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0254</span>:             <span class="k">if</span> <span class="n">rc</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_9 = ((__pyx_v_rc &gt;= 0) != 0);
        if (__pyx_t_9) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0255</span>:                 <span class="n">rc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">_resize_c</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">node_count</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15.__pyx_n = 1;
          __pyx_t_15.capacity = __pyx_v_tree-&gt;node_count;
          __pyx_t_5 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_tree-&gt;__pyx_vtab)-&gt;_resize_c(__pyx_v_tree, &amp;__pyx_t_15);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 255, __pyx_L8_error)</span>
          __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">0256</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0257</span>:             <span class="k">if</span> <span class="n">rc</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_9 = ((__pyx_v_rc &gt;= 0) != 0);
        if (__pyx_t_9) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0258</span>:                 <span class="n">tree</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth_seen</span></pre>
<pre class='cython code score-0 '>          __pyx_v_tree-&gt;max_depth = __pyx_v_max_depth_seen;
</pre><pre class="cython line score-0">&#xA0;<span class="">0259</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0260</span>:         <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = ((__pyx_v_rc == -1L) != 0);
  if (unlikely(__pyx_t_9)) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0261</span>:             <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>__PYX_ERR(0, 261, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0262</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0263</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0264</span>:         <span class="c"># feed the tree attribute &#39;K_y&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0265</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0266</span>:         <span class="n">tree</span><span class="o">.</span><span class="n">K_y</span> <span class="o">=</span> <span class="n">y</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_y));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_y));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_tree-&gt;K_y);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_tree-&gt;K_y));
  __pyx_v_tree-&gt;K_y = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">0267</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0268</span>: <span class="c"># Best first builder ----------------------------------------------------------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0269</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0270</span>: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">_add_to_frontier</span><span class="p">(</span><span class="n">PriorityHeapRecord</span><span class="o">*</span> <span class="n">rec</span><span class="p">,</span></pre>
<pre class='cython code score-6 '>static CYTHON_INLINE int __pyx_f_13stpredictions_6models_3OK3_5_tree__add_to_frontier(struct __pyx_t_7sklearn_4tree_6_utils_PriorityHeapRecord *__pyx_v_rec, struct __pyx_obj_7sklearn_4tree_6_utils_PriorityHeap *__pyx_v_frontier) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
    #endif
    <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree._add_to_frontier", __pyx_clineno, __pyx_lineno, __pyx_filename);
    #ifdef WITH_THREAD
    <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
    #endif
  }
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0271</span>:                                  <span class="n">PriorityHeap</span> <span class="n">frontier</span><span class="p">)</span> <span class="k">nogil</span> <span class="k">except</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0272</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds record ``rec`` to the priority queue ``frontier``</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0273</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0274</span>: <span class="sd">    Returns -1 in case of failure to allocate memory (and raise MemoryError)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0275</span>: <span class="sd">    or 0 otherwise.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0276</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0277</span>:     <span class="k">return</span> <span class="n">frontier</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">node_id</span><span class="p">,</span> <span class="n">rec</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">rec</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">rec</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">rec</span><span class="o">.</span><span class="n">depth</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_PriorityHeap *)__pyx_v_frontier-&gt;__pyx_vtab)-&gt;push(__pyx_v_frontier, __pyx_v_rec-&gt;node_id, __pyx_v_rec-&gt;start, __pyx_v_rec-&gt;end, __pyx_v_rec-&gt;pos, __pyx_v_rec-&gt;depth, __pyx_v_rec-&gt;is_leaf, __pyx_v_rec-&gt;improvement, __pyx_v_rec-&gt;impurity, __pyx_v_rec-&gt;impurity_left, __pyx_v_rec-&gt;impurity_right);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 277, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_1;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0278</span>:                          <span class="n">rec</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">,</span> <span class="n">rec</span><span class="o">.</span><span class="n">improvement</span><span class="p">,</span> <span class="n">rec</span><span class="o">.</span><span class="n">impurity</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0279</span>:                          <span class="n">rec</span><span class="o">.</span><span class="n">impurity_left</span><span class="p">,</span> <span class="n">rec</span><span class="o">.</span><span class="n">impurity_right</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0280</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0281</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0282</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">BestFirstTreeBuilder</span><span class="p">(</span><span class="n">TreeBuilder</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder {
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder __pyx_base;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t max_leaf_nodes;
};
/* … */
struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder {
  struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_TreeBuilder __pyx_base;
  int (*_add_split_node)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder *, struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, double, int, int, struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, struct __pyx_t_7sklearn_4tree_6_utils_PriorityHeapRecord *, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t);
};
static struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder *__pyx_vtabptr_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder;
static CYTHON_INLINE int __pyx_f_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder__add_split_node(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder *, struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, double, int, int, struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, struct __pyx_t_7sklearn_4tree_6_utils_PriorityHeapRecord *, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t);

</pre><pre class="cython line score-0">&#xA0;<span class="">0283</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a decision tree in best-first fashion.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0284</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0285</span>: <span class="sd">    The best node to expand is given by the node at the frontier that has the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0286</span>: <span class="sd">    highest impurity improvement.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0287</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0288</span>:     <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">max_leaf_nodes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0289</span>: </pre>
<pre class="cython line score-112" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0290</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Splitter</span> <span class="n">splitter</span><span class="p">,</span> <span class="n">SIZE_t</span> <span class="n">min_samples_split</span><span class="p">,</span></pre>
<pre class='cython code score-112 '>/* Python wrapper */
static int __pyx_pw_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *__pyx_v_splitter = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_split;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_leaf;
  PyObject *__pyx_v_min_weight_leaf = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_depth;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_leaf_nodes;
  double __pyx_v_min_impurity_decrease;
  double __pyx_v_min_impurity_split;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_splitter,&amp;__pyx_n_s_min_samples_split,&amp;__pyx_n_s_min_samples_leaf,&amp;__pyx_n_s_min_weight_leaf,&amp;__pyx_n_s_max_depth,&amp;__pyx_n_s_max_leaf_nodes,&amp;__pyx_n_s_min_impurity_decrease,&amp;__pyx_n_s_min_impurity_split,0};
    PyObject* values[8] = {0,0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  8: values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_splitter)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_samples_split)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 1); <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_samples_leaf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 2); <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_weight_leaf)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 3); <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_depth)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 4); <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_leaf_nodes)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 5); <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_impurity_decrease)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 6); <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_min_impurity_split)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, 7); <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 8) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
      values[7] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 7);
    }
    __pyx_v_splitter = ((struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *)values[0]);
    __pyx_v_min_samples_split = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(values[1]); if (unlikely((__pyx_v_min_samples_split == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L3_error)</span>
    __pyx_v_min_samples_leaf = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(values[2]); if (unlikely((__pyx_v_min_samples_leaf == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 291, __pyx_L3_error)</span>
    __pyx_v_min_weight_leaf = values[3];
    __pyx_v_max_depth = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(values[4]); if (unlikely((__pyx_v_max_depth == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L3_error)</span>
    __pyx_v_max_leaf_nodes = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(values[5]); if (unlikely((__pyx_v_max_leaf_nodes == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L3_error)</span>
    __pyx_v_min_impurity_decrease = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[6]); if (unlikely((__pyx_v_min_impurity_decrease == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L3_error)</span>
    __pyx_v_min_impurity_split = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[7]); if (unlikely((__pyx_v_min_impurity_split == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 8, 8, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.BestFirstTreeBuilder.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_splitter), __pyx_ptype_13stpredictions_6models_3OK3_9_splitter_Splitter, 1, "splitter", 0))) <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder___cinit__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder *)__pyx_v_self), __pyx_v_splitter, __pyx_v_min_samples_split, __pyx_v_min_samples_leaf, __pyx_v_min_weight_leaf, __pyx_v_max_depth, __pyx_v_max_leaf_nodes, __pyx_v_min_impurity_decrease, __pyx_v_min_impurity_split);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder___cinit__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder *__pyx_v_self, struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *__pyx_v_splitter, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_split, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_leaf, PyObject *__pyx_v_min_weight_leaf, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_depth, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_leaf_nodes, double __pyx_v_min_impurity_decrease, double __pyx_v_min_impurity_split) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.BestFirstTreeBuilder.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0291</span>:                   <span class="n">SIZE_t</span> <span class="n">min_samples_leaf</span><span class="p">,</span>  <span class="n">min_weight_leaf</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0292</span>:                   <span class="n">SIZE_t</span> <span class="n">max_depth</span><span class="p">,</span> <span class="n">SIZE_t</span> <span class="n">max_leaf_nodes</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0293</span>:                   <span class="n">double</span> <span class="n">min_impurity_decrease</span><span class="p">,</span> <span class="n">double</span> <span class="n">min_impurity_split</span><span class="p">):</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0294</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span> <span class="o">=</span> <span class="n">splitter</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_splitter));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_splitter));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;__pyx_base.splitter);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;__pyx_base.splitter));
  __pyx_v_self-&gt;__pyx_base.splitter = __pyx_v_splitter;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0295</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span> <span class="o">=</span> <span class="n">min_samples_split</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.min_samples_split = __pyx_v_min_samples_split;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0296</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="n">min_samples_leaf</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.min_samples_leaf = __pyx_v_min_samples_leaf;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0297</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_weight_leaf</span> <span class="o">=</span> <span class="n">min_weight_leaf</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_v_min_weight_leaf); if (unlikely((__pyx_t_1 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
  __pyx_v_self-&gt;__pyx_base.min_weight_leaf = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0298</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.max_depth = __pyx_v_max_depth;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0299</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">max_leaf_nodes</span> <span class="o">=</span> <span class="n">max_leaf_nodes</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;max_leaf_nodes = __pyx_v_max_leaf_nodes;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0300</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_impurity_decrease</span> <span class="o">=</span> <span class="n">min_impurity_decrease</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.min_impurity_decrease = __pyx_v_min_impurity_decrease;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0301</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">min_impurity_split</span> <span class="o">=</span> <span class="n">min_impurity_split</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;__pyx_base.min_impurity_split = __pyx_v_min_impurity_split;
</pre><pre class="cython line score-0">&#xA0;<span class="">0302</span>: </pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0303</span>:     <span class="k">cpdef</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tree</span> <span class="n">tree</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">y</span><span class="p">,</span></pre>
<pre class='cython code score-64 '>static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_3build(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_build(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder *__pyx_v_self, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree, PyObject *__pyx_v_X, PyArrayObject *__pyx_v_y, int __pyx_skip_dispatch, struct __pyx_opt_args_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_build *__pyx_optional_args) {
/* … */
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_build);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_3build)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        __pyx_t_5 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
            __pyx_t_5 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[5] = {__pyx_t_4, ((PyObject *)__pyx_v_tree), __pyx_v_X, ((PyObject *)__pyx_v_y), ((PyObject *)__pyx_v_sample_weight)};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
          PyObject *__pyx_temp[5] = {__pyx_t_4, ((PyObject *)__pyx_v_tree), __pyx_v_X, ((PyObject *)__pyx_v_y), ((PyObject *)__pyx_v_sample_weight)};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        } else
        #endif
        {
          __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          if (__pyx_t_4) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_tree));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_tree));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_5, ((PyObject *)__pyx_v_tree));
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_5, __pyx_v_X);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_y));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_y));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_5, ((PyObject *)__pyx_v_y));
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_sample_weight));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_sample_weight));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3+__pyx_t_5, ((PyObject *)__pyx_v_sample_weight));
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_r = __pyx_t_2;
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.BestFirstTreeBuilder.build", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_splitter);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_frontier);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_sample_weight);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_3build(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_2build[] = "Build a decision tree from the training set (X, y).";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_3build(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree = 0;
  PyObject *__pyx_v_X = 0;
  PyArrayObject *__pyx_v_y = 0;
  PyArrayObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("build (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_tree,&amp;__pyx_n_s_X,&amp;__pyx_n_s_y,&amp;__pyx_n_s_sample_weight,0};
    PyObject* values[4] = {0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_2build(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder *__pyx_v_self, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree, PyObject *__pyx_v_X, PyArrayObject *__pyx_v_y, PyArrayObject *__pyx_v_sample_weight) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("build", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.sample_weight = __pyx_v_sample_weight;
  __pyx_t_1 = __pyx_vtabptr_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder-&gt;__pyx_base.build(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *)__pyx_v_self), __pyx_v_tree, __pyx_v_X, __pyx_v_y, 1, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.BestFirstTreeBuilder.build", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_build {
  int __pyx_n;
  PyArrayObject *sample_weight;
};
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0304</span>:                 <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">sample_weight</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-43 '>  PyArrayObject *__pyx_v_sample_weight = ((PyArrayObject *)Py_None);
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *__pyx_v_sample_weight_ptr;
  struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *__pyx_v_splitter = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_leaf_nodes;
  CYTHON_UNUSED __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_leaf;
  CYTHON_UNUSED double __pyx_v_min_weight_leaf;
  CYTHON_UNUSED __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_min_samples_split;
  struct __pyx_obj_7sklearn_4tree_6_utils_PriorityHeap *__pyx_v_frontier = 0;
  struct __pyx_t_7sklearn_4tree_6_utils_PriorityHeapRecord __pyx_v_record;
  struct __pyx_t_7sklearn_4tree_6_utils_PriorityHeapRecord __pyx_v_split_node_left;
  struct __pyx_t_7sklearn_4tree_6_utils_PriorityHeapRecord __pyx_v_split_node_right;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_node_samples;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_split_nodes;
  int __pyx_v_is_leaf;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_depth_seen;
  int __pyx_v_rc;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_node;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_init_capacity;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("build", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_sample_weight = __pyx_optional_args-&gt;sample_weight;
    }
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_sample_weight);
/* … */
    values[3] = (PyObject *)((PyArrayObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_tree)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_X)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_y)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_sample_weight);
          if (value) { values[3] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "build") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_tree = ((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)values[0]);
    __pyx_v_X = values[1];
    __pyx_v_y = ((PyArrayObject *)values[2]);
    __pyx_v_sample_weight = ((PyArrayObject *)values[3]);
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("build", 0, 3, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.BestFirstTreeBuilder.build", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_tree), __pyx_ptype_13stpredictions_6models_3OK3_5_tree_Tree, 1, "tree", 0))) <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_y), __pyx_ptype_5numpy_ndarray, 1, "y", 0))) <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sample_weight), __pyx_ptype_5numpy_ndarray, 1, "sample_weight", 0))) <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder_2build(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder *)__pyx_v_self), __pyx_v_tree, __pyx_v_X, __pyx_v_y, __pyx_v_sample_weight);
</pre><pre class="cython line score-0">&#xA0;<span class="">0305</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Build a decision tree from the training set (X, y).&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0306</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0307</span>:         <span class="c"># check input</span></pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0308</span>:         <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_input</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight</span><span class="p">)</span></pre>
<pre class='cython code score-55 '>  __pyx_t_1 = __pyx_f_13stpredictions_6models_3OK3_5_tree_11TreeBuilder__check_input(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_TreeBuilder *)__pyx_v_self), __pyx_v_X, __pyx_v_y, __pyx_v_sample_weight);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_7 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;
    index = 0; __pyx_t_2 = __pyx_t_7(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_7(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 2; __pyx_t_6 = __pyx_t_7(__pyx_t_4); if (unlikely(!__pyx_t_6)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_4), 3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
    __pyx_t_7 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_7 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_X, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, ((PyArrayObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sample_weight, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0309</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0310</span>:         <span class="k">cdef</span> <span class="kt">DOUBLE_t</span>* <span class="nf">sample_weight_ptr</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_sample_weight_ptr = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0311</span>:         <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (((PyObject *)__pyx_v_sample_weight) != Py_None);
  __pyx_t_9 = (__pyx_t_8 != 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0312</span>:             <span class="n">sample_weight_ptr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">DOUBLE_t</span><span class="o">*&gt;</span> <span class="n">sample_weight</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>    __pyx_v_sample_weight_ptr = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *)__pyx_v_sample_weight-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">0313</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0314</span>:         <span class="c"># Parameters</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0315</span>:         <span class="k">cdef</span> <span class="kt">Splitter</span> <span class="nf">splitter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">splitter</span></pre>
<pre class='cython code score-1 '>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;__pyx_base.splitter);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_splitter = ((struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0316</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">max_leaf_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_leaf_nodes</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;max_leaf_nodes;
  __pyx_v_max_leaf_nodes = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0317</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">min_samples_leaf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;__pyx_base.min_samples_leaf;
  __pyx_v_min_samples_leaf = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0318</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">min_weight_leaf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_weight_leaf</span></pre>
<pre class='cython code score-0 '>  __pyx_t_11 = __pyx_v_self-&gt;__pyx_base.min_weight_leaf;
  __pyx_v_min_weight_leaf = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0319</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">min_samples_split</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span></pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;__pyx_base.min_samples_split;
  __pyx_v_min_samples_split = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">0320</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0321</span>:         <span class="c"># Recursive partition (without actual recursion)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0322</span>:         <span class="n">splitter</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sample_weight_ptr</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_nn___pyx_t_7sklearn_4tree_5_tree_DOUBLE_t__const__(((PyObject *)__pyx_v_y), 0);<span class='error_goto'> if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  __pyx_t_5 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_v_splitter-&gt;__pyx_vtab)-&gt;init(__pyx_v_splitter, __pyx_v_X, __pyx_t_12, __pyx_v_sample_weight_ptr);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_12, 1);
  __pyx_t_12.memview = NULL;
  __pyx_t_12.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0323</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0324</span>:         <span class="k">cdef</span> <span class="kt">PriorityHeap</span> <span class="nf">frontier</span> <span class="o">=</span> <span class="n">PriorityHeap</span><span class="p">(</span><span class="n">INITIAL_STACK_SIZE</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_13stpredictions_6models_3OK3_5_tree_INITIAL_STACK_SIZE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7sklearn_4tree_6_utils_PriorityHeap), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_frontier = ((struct __pyx_obj_7sklearn_4tree_6_utils_PriorityHeap *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0325</span>:         <span class="k">cdef</span> <span class="kt">PriorityHeapRecord</span> <span class="nf">record</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0326</span>:         <span class="k">cdef</span> <span class="kt">PriorityHeapRecord</span> <span class="nf">split_node_left</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>:         <span class="k">cdef</span> <span class="kt">PriorityHeapRecord</span> <span class="nf">split_node_right</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0328</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0329</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_node_samples</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">n_samples</span></pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __pyx_v_splitter-&gt;n_samples;
  __pyx_v_n_node_samples = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0330</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">max_split_nodes</span> <span class="o">=</span> <span class="n">max_leaf_nodes</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_max_split_nodes = (__pyx_v_max_leaf_nodes - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0331</span>:         <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_leaf</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0332</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">max_depth_seen</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_max_depth_seen = -1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0333</span>:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">rc</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rc = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0334</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">node</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0335</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0336</span>:         <span class="c"># Initial capacity</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0337</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">init_capacity</span> <span class="o">=</span> <span class="n">max_split_nodes</span> <span class="o">+</span> <span class="n">max_leaf_nodes</span></pre>
<pre class='cython code score-0 '>  __pyx_v_init_capacity = (__pyx_v_max_split_nodes + __pyx_v_max_leaf_nodes);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0338</span>:         <span class="n">tree</span><span class="o">.</span><span class="n">_resize</span><span class="p">(</span><span class="n">init_capacity</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_tree-&gt;__pyx_vtab)-&gt;_resize(__pyx_v_tree, __pyx_v_init_capacity);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 338, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0339</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0340</span>:         <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-6 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L8;
        }
        __pyx_L7_error: {
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L1_error;
        }
        __pyx_L8:;
      }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0341</span>:             <span class="c"># add root to frontier</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0342</span>:             <span class="n">rc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_split_node</span><span class="p">(</span><span class="n">splitter</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">n_node_samples</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>        __pyx_t_5 = __pyx_f_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder__add_split_node(__pyx_v_self, __pyx_v_splitter, __pyx_v_tree, 0, __pyx_v_n_node_samples, __pyx_v_13stpredictions_6models_3OK3_5_tree_INFINITY, __pyx_v_13stpredictions_6models_3OK3_5_tree_IS_FIRST, __pyx_v_13stpredictions_6models_3OK3_5_tree_IS_LEFT, NULL, 0, (&amp;__pyx_v_split_node_left), (__pyx_v_y-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 342, __pyx_L7_error)</span>
        __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">0343</span>:                                       <span class="n">INFINITY</span><span class="p">,</span> <span class="n">IS_FIRST</span><span class="p">,</span> <span class="n">IS_LEFT</span><span class="p">,</span> <span class="bp">NULL</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0344</span>:                                       <span class="o">&amp;</span><span class="n">split_node_left</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0345</span>:                                       <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0346</span>:             <span class="k">if</span> <span class="n">rc</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_9 = ((__pyx_v_rc &gt;= 0) != 0);
        if (__pyx_t_9) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0347</span>:                 <span class="n">rc</span> <span class="o">=</span> <span class="n">_add_to_frontier</span><span class="p">(</span><span class="o">&amp;</span><span class="n">split_node_left</span><span class="p">,</span> <span class="n">frontier</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_t_5 = __pyx_f_13stpredictions_6models_3OK3_5_tree__add_to_frontier((&amp;__pyx_v_split_node_left), __pyx_v_frontier);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 347, __pyx_L7_error)</span>
          __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">0348</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0349</span>:             <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_9 = ((__pyx_v_rc == -1L) != 0);
        if (__pyx_t_9) {
/* … */
        }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0350</span>:                 <span class="k">with</span> <span class="k">gil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>          {
              #ifdef WITH_THREAD
              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
              #endif
              /*try:*/ {
/* … */
              /*finally:*/ {
                __pyx_L12_error: {
                  #ifdef WITH_THREAD
                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                  #endif
                  goto __pyx_L7_error;
                }
              }
          }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0351</span>:                     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>                <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>__PYX_ERR(0, 351, __pyx_L12_error)</span>
              }
</pre><pre class="cython line score-0">&#xA0;<span class="">0352</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0353</span>:             <span class="k">while</span> <span class="ow">not</span> <span class="n">frontier</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_9 = ((!(((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_PriorityHeap *)__pyx_v_frontier-&gt;__pyx_vtab)-&gt;is_empty(__pyx_v_frontier) != 0)) != 0);
          if (!__pyx_t_9) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0354</span>:                 <span class="n">frontier</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">&amp;</span><span class="n">record</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          (void)(((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_PriorityHeap *)__pyx_v_frontier-&gt;__pyx_vtab)-&gt;pop(__pyx_v_frontier, (&amp;__pyx_v_record)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0355</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0356</span>:                 <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">node_id</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_v_node = (&amp;(__pyx_v_tree-&gt;nodes[__pyx_v_record.node_id]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0357</span>:                 <span class="n">is_leaf</span> <span class="o">=</span> <span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">is_leaf</span> <span class="ow">or</span> <span class="n">max_split_nodes</span> <span class="o">&lt;=</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_t_8 = (__pyx_v_record.is_leaf != 0);
          if (!__pyx_t_8) {
          } else {
            __pyx_t_9 = __pyx_t_8;
            goto __pyx_L16_bool_binop_done;
          }
          __pyx_t_8 = ((__pyx_v_max_split_nodes &lt;= 0) != 0);
          __pyx_t_9 = __pyx_t_8;
          __pyx_L16_bool_binop_done:;
          __pyx_v_is_leaf = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">0358</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0359</span>:                 <span class="k">if</span> <span class="n">is_leaf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_9 = (__pyx_v_is_leaf != 0);
          if (__pyx_t_9) {
/* … */
            goto __pyx_L18;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">0360</span>:                     <span class="c"># Node is not expandable; set node as leaf</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0361</span>:                     <span class="n">node</span><span class="o">.</span><span class="n">left_child</span> <span class="o">=</span> <span class="n">_TREE_LEAF</span></pre>
<pre class='cython code score-0 '>            __pyx_v_node-&gt;left_child = __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0362</span>:                     <span class="n">node</span><span class="o">.</span><span class="n">right_child</span> <span class="o">=</span> <span class="n">_TREE_LEAF</span></pre>
<pre class='cython code score-0 '>            __pyx_v_node-&gt;right_child = __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0363</span>:                     <span class="n">node</span><span class="o">.</span><span class="n">feature</span> <span class="o">=</span> <span class="n">_TREE_UNDEFINED</span></pre>
<pre class='cython code score-0 '>            __pyx_v_node-&gt;feature = __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_UNDEFINED;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0364</span>:                     <span class="n">node</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">_TREE_UNDEFINED</span></pre>
<pre class='cython code score-0 '>            __pyx_v_node-&gt;threshold = __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_UNDEFINED;
</pre><pre class="cython line score-0">&#xA0;<span class="">0365</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0366</span>:                 <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0367</span>:                     <span class="c"># Node is expandable</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0368</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0369</span>:                     <span class="c"># Decrement number of split nodes available</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0370</span>:                     <span class="n">max_split_nodes</span> <span class="o">-=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_v_max_split_nodes = (__pyx_v_max_split_nodes - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0371</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0372</span>:                     <span class="c"># Compute left split node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0373</span>:                     <span class="n">rc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_split_node</span><span class="p">(</span><span class="n">splitter</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>            __pyx_t_5 = __pyx_f_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder__add_split_node(__pyx_v_self, __pyx_v_splitter, __pyx_v_tree, __pyx_v_record.start, __pyx_v_record.pos, __pyx_v_record.impurity_left, __pyx_v_13stpredictions_6models_3OK3_5_tree_IS_NOT_FIRST, __pyx_v_13stpredictions_6models_3OK3_5_tree_IS_LEFT, __pyx_v_node, (__pyx_v_record.depth + 1), (&amp;__pyx_v_split_node_left), (__pyx_v_y-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 373, __pyx_L7_error)</span>
            __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">0374</span>:                                               <span class="n">record</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0375</span>:                                               <span class="n">record</span><span class="o">.</span><span class="n">impurity_left</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0376</span>:                                               <span class="n">IS_NOT_FIRST</span><span class="p">,</span> <span class="n">IS_LEFT</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0377</span>:                                               <span class="n">record</span><span class="o">.</span><span class="n">depth</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0378</span>:                                               <span class="o">&amp;</span><span class="n">split_node_left</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0379</span>:                                               <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0380</span>:                     <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_9 = ((__pyx_v_rc == -1L) != 0);
            if (__pyx_t_9) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0381</span>:                         <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L15_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0382</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0383</span>:                     <span class="c"># tree.nodes may have changed</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0384</span>:                     <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">record</span><span class="o">.</span><span class="n">node_id</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_node = (&amp;(__pyx_v_tree-&gt;nodes[__pyx_v_record.node_id]));
</pre><pre class="cython line score-0">&#xA0;<span class="">0385</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0386</span>:                     <span class="c"># Compute right split node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0387</span>:                     <span class="n">rc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_split_node</span><span class="p">(</span><span class="n">splitter</span><span class="p">,</span> <span class="n">tree</span><span class="p">,</span> <span class="n">record</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>            __pyx_t_5 = __pyx_f_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder__add_split_node(__pyx_v_self, __pyx_v_splitter, __pyx_v_tree, __pyx_v_record.pos, __pyx_v_record.end, __pyx_v_record.impurity_right, __pyx_v_13stpredictions_6models_3OK3_5_tree_IS_NOT_FIRST, __pyx_v_13stpredictions_6models_3OK3_5_tree_IS_NOT_LEFT, __pyx_v_node, (__pyx_v_record.depth + 1), (&amp;__pyx_v_split_node_right), (__pyx_v_y-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 387, __pyx_L7_error)</span>
            __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">0388</span>:                                               <span class="n">record</span><span class="o">.</span><span class="n">end</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0389</span>:                                               <span class="n">record</span><span class="o">.</span><span class="n">impurity_right</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0390</span>:                                               <span class="n">IS_NOT_FIRST</span><span class="p">,</span> <span class="n">IS_NOT_LEFT</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0391</span>:                                               <span class="n">record</span><span class="o">.</span><span class="n">depth</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0392</span>:                                               <span class="o">&amp;</span><span class="n">split_node_right</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0393</span>:                                               <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0394</span>:                     <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_9 = ((__pyx_v_rc == -1L) != 0);
            if (__pyx_t_9) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0395</span>:                         <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L15_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0396</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0397</span>:                     <span class="c"># Add nodes to queue</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0398</span>:                     <span class="n">rc</span> <span class="o">=</span> <span class="n">_add_to_frontier</span><span class="p">(</span><span class="o">&amp;</span><span class="n">split_node_left</span><span class="p">,</span> <span class="n">frontier</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_t_5 = __pyx_f_13stpredictions_6models_3OK3_5_tree__add_to_frontier((&amp;__pyx_v_split_node_left), __pyx_v_frontier);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 398, __pyx_L7_error)</span>
            __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0399</span>:                     <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_9 = ((__pyx_v_rc == -1L) != 0);
            if (__pyx_t_9) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0400</span>:                         <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L15_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0401</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0402</span>:                     <span class="n">rc</span> <span class="o">=</span> <span class="n">_add_to_frontier</span><span class="p">(</span><span class="o">&amp;</span><span class="n">split_node_right</span><span class="p">,</span> <span class="n">frontier</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_t_5 = __pyx_f_13stpredictions_6models_3OK3_5_tree__add_to_frontier((&amp;__pyx_v_split_node_right), __pyx_v_frontier);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 402, __pyx_L7_error)</span>
            __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0403</span>:                     <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_9 = ((__pyx_v_rc == -1L) != 0);
            if (__pyx_t_9) {
/* … */
            }
          }
          __pyx_L18:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0404</span>:                         <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L15_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0405</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0406</span>:                 <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">depth</span> <span class="o">&gt;</span> <span class="n">max_depth_seen</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_9 = ((__pyx_v_record.depth &gt; __pyx_v_max_depth_seen) != 0);
          if (__pyx_t_9) {
/* … */
          }
        }
        __pyx_L15_break:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0407</span>:                     <span class="n">max_depth_seen</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">depth</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = __pyx_v_record.depth;
            __pyx_v_max_depth_seen = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">0408</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0409</span>:             <span class="k">if</span> <span class="n">rc</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_9 = ((__pyx_v_rc &gt;= 0) != 0);
        if (__pyx_t_9) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0410</span>:                 <span class="n">rc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">_resize_c</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">node_count</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15.__pyx_n = 1;
          __pyx_t_15.capacity = __pyx_v_tree-&gt;node_count;
          __pyx_t_5 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_tree-&gt;__pyx_vtab)-&gt;_resize_c(__pyx_v_tree, &amp;__pyx_t_15);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 410, __pyx_L7_error)</span>
          __pyx_v_rc = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">0411</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0412</span>:             <span class="k">if</span> <span class="n">rc</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_9 = ((__pyx_v_rc &gt;= 0) != 0);
        if (__pyx_t_9) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0413</span>:                 <span class="n">tree</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth_seen</span></pre>
<pre class='cython code score-0 '>          __pyx_v_tree-&gt;max_depth = __pyx_v_max_depth_seen;
</pre><pre class="cython line score-0">&#xA0;<span class="">0414</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0415</span>:         <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9 = ((__pyx_v_rc == -1L) != 0);
  if (unlikely(__pyx_t_9)) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0416</span>:             <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>__PYX_ERR(0, 416, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0417</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0418</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>:         <span class="c"># feed the tree attribute &#39;K_y&#39;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0421</span>:         <span class="n">tree</span><span class="o">.</span><span class="n">K_y</span> <span class="o">=</span> <span class="n">y</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_y));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_y));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_tree-&gt;K_y);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_tree-&gt;K_y));
  __pyx_v_tree-&gt;K_y = __pyx_v_y;
</pre><pre class="cython line score-0">&#xA0;<span class="">0422</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0423</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0424</span>:     <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">_add_split_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Splitter</span> <span class="n">splitter</span><span class="p">,</span> <span class="n">Tree</span> <span class="n">tree</span><span class="p">,</span></pre>
<pre class='cython code score-6 '>static CYTHON_INLINE int __pyx_f_13stpredictions_6models_3OK3_5_tree_20BestFirstTreeBuilder__add_split_node(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_BestFirstTreeBuilder *__pyx_v_self, struct __pyx_obj_13stpredictions_6models_3OK3_9_splitter_Splitter *__pyx_v_splitter, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_start, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_end, double __pyx_v_impurity, int __pyx_v_is_first, int __pyx_v_is_left, struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_parent, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_depth, struct __pyx_t_7sklearn_4tree_6_utils_PriorityHeapRecord *__pyx_v_res, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_samples) {
  struct __pyx_t_13stpredictions_6models_3OK3_9_splitter_SplitRecord __pyx_v_split;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_node_id;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_node_samples;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_constant_features;
  CYTHON_UNUSED double __pyx_v_weighted_n_samples;
  double __pyx_v_min_impurity_decrease;
  double __pyx_v_min_impurity_split;
  double __pyx_v_weighted_n_node_samples;
  int __pyx_v_is_leaf;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
    #endif
    <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.BestFirstTreeBuilder._add_split_node", __pyx_clineno, __pyx_lineno, __pyx_filename);
    #ifdef WITH_THREAD
    <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
    #endif
  }
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0425</span>:                                     <span class="n">SIZE_t</span> <span class="n">start</span><span class="p">,</span> <span class="n">SIZE_t</span> <span class="n">end</span><span class="p">,</span> <span class="n">double</span> <span class="n">impurity</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>:                                     <span class="nb">bint</span> <span class="n">is_first</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">is_left</span><span class="p">,</span> <span class="n">Node</span><span class="o">*</span> <span class="n">parent</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>:                                     <span class="n">SIZE_t</span> <span class="n">depth</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0428</span>:                                     <span class="n">PriorityHeapRecord</span><span class="o">*</span> <span class="n">res</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0429</span>:                                     <span class="n">SIZE_t</span> <span class="n">n_samples</span><span class="p">)</span> <span class="k">nogil</span> <span class="k">except</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0430</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds node w/ partition ``[start, end)`` to the frontier. &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0431</span>:         <span class="k">cdef</span> <span class="kt">SplitRecord</span> <span class="nf">split</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0432</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">node_id</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0433</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_node_samples</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0434</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_constant_features</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_constant_features = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0435</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">weighted_n_samples</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">weighted_n_samples</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_splitter-&gt;weighted_n_samples;
  __pyx_v_weighted_n_samples = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0436</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">min_impurity_decrease</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_impurity_decrease</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;__pyx_base.min_impurity_decrease;
  __pyx_v_min_impurity_decrease = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0437</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">min_impurity_split</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_impurity_split</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;__pyx_base.min_impurity_split;
  __pyx_v_min_impurity_split = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0438</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">weighted_n_node_samples</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0439</span>:         <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">is_leaf</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0440</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_left</span><span class="p">,</span> <span class="nf">n_right</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0441</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">imp_diff</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0442</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0443</span>:         <span class="n">splitter</span><span class="o">.</span><span class="n">node_reset</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">weighted_n_node_samples</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_v_splitter-&gt;__pyx_vtab)-&gt;node_reset(__pyx_v_splitter, __pyx_v_start, __pyx_v_end, (&amp;__pyx_v_weighted_n_node_samples));<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 443, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0444</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0445</span>:         <span class="k">if</span> <span class="n">is_first</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = (__pyx_v_is_first != 0);
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0446</span>:             <span class="n">impurity</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">node_impurity</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    __pyx_v_impurity = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_v_splitter-&gt;__pyx_vtab)-&gt;node_impurity(__pyx_v_splitter);
</pre><pre class="cython line score-0">&#xA0;<span class="">0447</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0448</span>:         <span class="n">n_node_samples</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span></pre>
<pre class='cython code score-0 '>  __pyx_v_n_node_samples = (__pyx_v_end - __pyx_v_start);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0449</span>:         <span class="n">is_leaf</span> <span class="o">=</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_depth &gt;= __pyx_v_self-&gt;__pyx_base.max_depth) != 0);
  if (!__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L4_bool_binop_done;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0450</span>:                    <span class="n">n_node_samples</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_n_node_samples &lt; __pyx_v_self-&gt;__pyx_base.min_samples_split) != 0);
  if (!__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L4_bool_binop_done;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0451</span>:                    <span class="n">n_node_samples</span> <span class="o">&lt;</span> <span class="mf">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_n_node_samples &lt; (2 * __pyx_v_self-&gt;__pyx_base.min_samples_leaf)) != 0);
  if (!__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L4_bool_binop_done;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>:                    <span class="n">weighted_n_node_samples</span> <span class="o">&lt;</span> <span class="mf">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_weight_leaf</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_weighted_n_node_samples &lt; (2.0 * __pyx_v_self-&gt;__pyx_base.min_weight_leaf)) != 0);
  if (!__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L4_bool_binop_done;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0453</span>:                    <span class="n">impurity</span> <span class="o">&lt;=</span> <span class="n">min_impurity_split</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_impurity &lt;= __pyx_v_min_impurity_split) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L4_bool_binop_done:;
  __pyx_v_is_leaf = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">0454</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0455</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">is_leaf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((!(__pyx_v_is_leaf != 0)) != 0);
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0456</span>:             <span class="n">splitter</span><span class="o">.</span><span class="n">node_split</span><span class="p">(</span><span class="n">impurity</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">split</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">n_constant_features</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_v_splitter-&gt;__pyx_vtab)-&gt;node_split(__pyx_v_splitter, __pyx_v_impurity, (&amp;__pyx_v_split), (&amp;__pyx_v_n_constant_features));<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 456, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0457</span>:             <span class="c"># If EPSILON=0 in the below comparison, float precision issues stop</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>:             <span class="c"># splitting early, producing trees that are dissimilar to v0.18</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0459</span>:             <span class="n">is_leaf</span> <span class="o">=</span> <span class="p">(</span><span class="n">is_leaf</span> <span class="ow">or</span> <span class="n">split</span><span class="o">.</span><span class="n">pos</span> <span class="o">&gt;=</span> <span class="n">end</span> <span class="ow">or</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = (__pyx_v_is_leaf != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_split.pos &gt;= __pyx_v_end) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L10_bool_binop_done;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0460</span>:                        <span class="n">split</span><span class="o">.</span><span class="n">improvement</span> <span class="o">+</span> <span class="n">EPSILON</span> <span class="o">&lt;</span> <span class="n">min_impurity_decrease</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = (((__pyx_v_split.improvement + __pyx_v_13stpredictions_6models_3OK3_5_tree_EPSILON) &lt; __pyx_v_min_impurity_decrease) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L10_bool_binop_done:;
    __pyx_v_is_leaf = __pyx_t_3;
</pre><pre class="cython line score-0">&#xA0;<span class="">0461</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0462</span>:         <span class="n">node_id</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">_add_node</span><span class="p">(</span><span class="n">parent</span> <span class="o">-</span> <span class="n">tree</span><span class="o">.</span><span class="n">nodes</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = (__pyx_v_parent - __pyx_v_tree-&gt;nodes);
  } else {
/* … */
  __pyx_t_6 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_tree-&gt;__pyx_vtab)-&gt;_add_node(__pyx_v_tree, __pyx_t_5, __pyx_v_is_left, __pyx_v_is_leaf, __pyx_v_split.feature, __pyx_v_split.threshold, __pyx_v_impurity, __pyx_v_n_node_samples, __pyx_v_weighted_n_node_samples);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)-1))) __PYX_ERR(0, 462, __pyx_L1_error)</span>
  __pyx_v_node_id = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0463</span>:                                  <span class="k">if</span> <span class="n">parent</span> <span class="o">!=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  if (((__pyx_v_parent != NULL) != 0)) {
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0464</span>:                                  <span class="k">else</span> <span class="n">_TREE_UNDEFINED</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_UNDEFINED;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0465</span>:                                  <span class="n">is_left</span><span class="p">,</span> <span class="n">is_leaf</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0466</span>:                                  <span class="n">split</span><span class="o">.</span><span class="n">feature</span><span class="p">,</span> <span class="n">split</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span> <span class="n">impurity</span><span class="p">,</span> <span class="n">n_node_samples</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0467</span>:                                  <span class="n">weighted_n_node_samples</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0468</span>:         <span class="k">if</span> <span class="n">node_id</span> <span class="o">==</span> <span class="n">SIZE_MAX</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((__pyx_v_node_id == SIZE_MAX) != 0);
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0469</span>:             <span class="k">return</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_r = -1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0470</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0471</span>:         <span class="c"># compute values also for split nodes (might become leafs later).</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0472</span>:         <span class="n">splitter</span><span class="o">.</span><span class="n">node_value</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">node_id</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_9_splitter_Splitter *)__pyx_v_splitter-&gt;__pyx_vtab)-&gt;node_value(__pyx_v_splitter, (__pyx_v_tree-&gt;value + (__pyx_v_node_id * __pyx_v_n_samples)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0473</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0474</span>:         <span class="n">res</span><span class="o">.</span><span class="n">node_id</span> <span class="o">=</span> <span class="n">node_id</span></pre>
<pre class='cython code score-0 '>  __pyx_v_res-&gt;node_id = __pyx_v_node_id;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0475</span>:         <span class="n">res</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">start</span></pre>
<pre class='cython code score-0 '>  __pyx_v_res-&gt;start = __pyx_v_start;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0476</span>:         <span class="n">res</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">end</span></pre>
<pre class='cython code score-0 '>  __pyx_v_res-&gt;end = __pyx_v_end;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0477</span>:         <span class="n">res</span><span class="o">.</span><span class="n">depth</span> <span class="o">=</span> <span class="n">depth</span></pre>
<pre class='cython code score-0 '>  __pyx_v_res-&gt;depth = __pyx_v_depth;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0478</span>:         <span class="n">res</span><span class="o">.</span><span class="n">impurity</span> <span class="o">=</span> <span class="n">impurity</span></pre>
<pre class='cython code score-0 '>  __pyx_v_res-&gt;impurity = __pyx_v_impurity;
</pre><pre class="cython line score-0">&#xA0;<span class="">0479</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0480</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="n">is_leaf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_3 = ((!(__pyx_v_is_leaf != 0)) != 0);
  if (__pyx_t_3) {
/* … */
    goto __pyx_L14;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0481</span>:             <span class="c"># is split node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0482</span>:             <span class="n">res</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">split</span><span class="o">.</span><span class="n">pos</span></pre>
<pre class='cython code score-0 '>    __pyx_t_7 = __pyx_v_split.pos;
    __pyx_v_res-&gt;pos = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0483</span>:             <span class="n">res</span><span class="o">.</span><span class="n">is_leaf</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_res-&gt;is_leaf = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0484</span>:             <span class="n">res</span><span class="o">.</span><span class="n">improvement</span> <span class="o">=</span> <span class="n">split</span><span class="o">.</span><span class="n">improvement</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_split.improvement;
    __pyx_v_res-&gt;improvement = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0485</span>:             <span class="n">res</span><span class="o">.</span><span class="n">impurity_left</span> <span class="o">=</span> <span class="n">split</span><span class="o">.</span><span class="n">impurity_left</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_split.impurity_left;
    __pyx_v_res-&gt;impurity_left = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0486</span>:             <span class="n">res</span><span class="o">.</span><span class="n">impurity_right</span> <span class="o">=</span> <span class="n">split</span><span class="o">.</span><span class="n">impurity_right</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_split.impurity_right;
    __pyx_v_res-&gt;impurity_right = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0487</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>:             <span class="c"># is leaf =&gt; 0 improvement</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0490</span>:             <span class="n">res</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">end</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_res-&gt;pos = __pyx_v_end;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0491</span>:             <span class="n">res</span><span class="o">.</span><span class="n">is_leaf</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_res-&gt;is_leaf = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0492</span>:             <span class="n">res</span><span class="o">.</span><span class="n">improvement</span> <span class="o">=</span> <span class="mf">0.0</span></pre>
<pre class='cython code score-0 '>    __pyx_v_res-&gt;improvement = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0493</span>:             <span class="n">res</span><span class="o">.</span><span class="n">impurity_left</span> <span class="o">=</span> <span class="n">impurity</span></pre>
<pre class='cython code score-0 '>    __pyx_v_res-&gt;impurity_left = __pyx_v_impurity;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0494</span>:             <span class="n">res</span><span class="o">.</span><span class="n">impurity_right</span> <span class="o">=</span> <span class="n">impurity</span></pre>
<pre class='cython code score-0 '>    __pyx_v_res-&gt;impurity_right = __pyx_v_impurity;
  }
  __pyx_L14:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0495</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0496</span>:         <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0497</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>: <span class="c"># =============================================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0500</span>: <span class="c"># Tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0501</span>: <span class="c"># =============================================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0502</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0503</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Tree</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree {
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t (*_add_node)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, int, int, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, double, double, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, double);
  int (*_resize)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t);
  int (*_resize_c)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, struct __pyx_opt_args_13stpredictions_6models_3OK3_5_tree_4Tree__resize_c *__pyx_optional_args);
  PyArrayObject *(*_get_value_ndarray)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *);
  PyArrayObject *(*_get_node_ndarray)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *);
  PyArrayObject *(*decode_tree)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyArrayObject *, PyArrayObject *, PyObject *, PyObject *, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, int __pyx_skip_dispatch);
  PyArrayObject *(*predict)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *, int __pyx_skip_dispatch);
  PyArrayObject *(*apply)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *, int __pyx_skip_dispatch);
  PyArrayObject *(*_apply_dense)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *);
  PyArrayObject *(*_apply_sparse_csr)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *);
  PyObject *(*decision_path)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *, int __pyx_skip_dispatch);
  PyObject *(*_decision_path_dense)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *);
  PyObject *(*_decision_path_sparse_csr)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *);
  PyObject *(*compute_feature_importances)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, int __pyx_skip_dispatch, struct __pyx_opt_args_13stpredictions_6models_3OK3_5_tree_4Tree_compute_feature_importances *__pyx_optional_args);
};
static struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_vtabptr_13stpredictions_6models_3OK3_5_tree_Tree;
static PyArrayObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__apply_dense(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *);
static PyArrayObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__apply_sparse_csr(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *);
static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__decision_path_dense(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *);
static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__decision_path_sparse_csr(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *, PyObject *);

</pre><pre class="cython line score-0">&#xA0;<span class="">0504</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Array-based representation of a binary decision tree.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0505</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>: <span class="sd">    The binary tree is represented as a number of parallel arrays. The i-th</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0507</span>: <span class="sd">    element of each array holds information about the node `i`. Node 0 is the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0508</span>: <span class="sd">    tree&#39;s root. You can find a detailed description of all arrays in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0509</span>: <span class="sd">    `_tree.pxd`. NOTE: Some of the arrays only apply to either leaves or split</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0510</span>: <span class="sd">    nodes, resp. In this case the values of nodes of the other type are</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0511</span>: <span class="sd">    arbitrary!</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0512</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>: <span class="sd">    Attributes</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0514</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0515</span>: <span class="sd">    node_count : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0516</span>: <span class="sd">        The number of nodes (internal nodes + leaves) in the tree.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0517</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0518</span>: <span class="sd">    capacity : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0519</span>: <span class="sd">        The current capacity (i.e., size) of the arrays, which is at least as</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0520</span>: <span class="sd">        great as `node_count`.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0521</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0522</span>: <span class="sd">    max_depth : int</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0523</span>: <span class="sd">        The depth of the tree, i.e. the maximum depth of its leaves.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0524</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0525</span>: <span class="sd">    value : array of double, shape [node_count, n_train_samples]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0526</span>: <span class="sd">        Gives for each node, the weighted list of training samples </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0527</span>: <span class="sd">        falling in the leaf/leaves bellow the leaf/node. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0528</span>: <span class="sd">        (Kind of invert the array given by the &#39;apply&#39; function.)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0529</span>: <span class="sd">    </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0530</span>: <span class="sd">    K_y : array of double, shape [n_train_samples, n_train_samples]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0531</span>: <span class="sd">        The training output Gramm matrix (used to compute the predictions)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0532</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0533</span>: <span class="sd">    y : array of double, shape [n_train_samples, output_vetor_length]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0534</span>: <span class="sd">        The training output matrix</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0535</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0536</span>: <span class="sd">    children_left : array of int, shape [node_count]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0537</span>: <span class="sd">        children_left[i] holds the node id of the left child of node i.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0538</span>: <span class="sd">        For leaves, children_left[i] == TREE_LEAF. Otherwise,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>: <span class="sd">        children_left[i] &gt; i. This child handles the case where</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>: <span class="sd">        X[:, feature[i]] &lt;= threshold[i].</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>: <span class="sd">    children_right : array of int, shape [node_count]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>: <span class="sd">        children_right[i] holds the node id of the right child of node i.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>: <span class="sd">        For leaves, children_right[i] == TREE_LEAF. Otherwise,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>: <span class="sd">        children_right[i] &gt; i. This child handles the case where</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0546</span>: <span class="sd">        X[:, feature[i]] &gt; threshold[i].</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0547</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>: <span class="sd">    feature : array of int, shape [node_count]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>: <span class="sd">        feature[i] holds the feature to split on, for the internal node i.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0551</span>: <span class="sd">    threshold : array of double, shape [node_count]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0552</span>: <span class="sd">        threshold[i] holds the threshold for the internal node i.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0553</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0554</span>: <span class="sd">    impurity : array of double, shape [node_count]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0555</span>: <span class="sd">        impurity[i] holds the impurity (i.e., the value of the splitting</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0556</span>: <span class="sd">        criterion) at node i.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0557</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0558</span>: <span class="sd">    n_node_samples : array of int, shape [node_count]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0559</span>: <span class="sd">        n_node_samples[i] holds the number of training samples reaching node i.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0561</span>: <span class="sd">    weighted_n_node_samples : array of int, shape [node_count]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0562</span>: <span class="sd">        weighted_n_node_samples[i] holds the weighted number of training samples</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0563</span>: <span class="sd">        reaching node i.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0564</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0565</span>:     <span class="c"># Wrap for outside world.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0566</span>:     <span class="c"># WARNING: these reference the current `nodes` buffers, which</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>:     <span class="c"># must not be freed by a subsequent memory allocation.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0568</span>:     <span class="c"># (i.e. through `_resize` or `__setstate__`)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0569</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0570</span>:     <span class="k">property</span> <span class="nf">children_left</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0571</span>:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_13children_left_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_13children_left_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_13children_left___get__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_13children_left___get__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.children_left.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0572</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_ndarray</span><span class="p">()[</span><span class="s">&#39;left_child&#39;</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_node_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_n_s_left_child);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_2, 0, __pyx_v_self-&gt;node_count, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0573</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0574</span>:     <span class="k">property</span> <span class="nf">children_right</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0575</span>:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_14children_right_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_14children_right_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_14children_right___get__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_14children_right___get__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.children_right.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0576</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_ndarray</span><span class="p">()[</span><span class="s">&#39;right_child&#39;</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_node_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 576, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_n_s_right_child);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 576, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_2, 0, __pyx_v_self-&gt;node_count, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 576, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0577</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0578</span>:     <span class="k">property</span> <span class="nf">n_leaves</span><span class="p">:</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0579</span>:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-10 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_8n_leaves_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_8n_leaves_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_8n_leaves___get__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_8n_leaves___get__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.n_leaves.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0580</span>:             <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span></pre>
<pre class='cython code score-11 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_logical_and);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0581</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">children_left</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_children_left);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_t_4, __pyx_int_neg_1, -1L, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 581, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0582</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">children_right</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-59 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_children_right);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_t_4, __pyx_int_neg_1, -1L, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_6, __pyx_t_7};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
    PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_6, __pyx_t_7};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_8, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_8, __pyx_t_7);
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 580, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0583</span>:     <span class="k">property</span> <span class="nf">feature</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0584</span>:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_7feature_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_7feature_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_7feature___get__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_7feature___get__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.feature.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0585</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_ndarray</span><span class="p">()[</span><span class="s">&#39;feature&#39;</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_node_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 585, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_n_s_feature);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 585, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_2, 0, __pyx_v_self-&gt;node_count, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 585, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0586</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>:     <span class="k">property</span> <span class="nf">threshold</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0588</span>:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_9threshold_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_9threshold_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_9threshold___get__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_9threshold___get__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.threshold.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0589</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_ndarray</span><span class="p">()[</span><span class="s">&#39;threshold&#39;</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_node_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 589, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_n_s_threshold);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 589, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_2, 0, __pyx_v_self-&gt;node_count, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 589, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0590</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>:     <span class="k">property</span> <span class="nf">impurity</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0592</span>:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_8impurity_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_8impurity_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_8impurity___get__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_8impurity___get__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.impurity.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0593</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_ndarray</span><span class="p">()[</span><span class="s">&#39;impurity&#39;</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_node_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_n_s_impurity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_2, 0, __pyx_v_self-&gt;node_count, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 593, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0594</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>:     <span class="k">property</span> <span class="nf">n_node_samples</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0596</span>:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_14n_node_samples_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_14n_node_samples_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_14n_node_samples___get__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_14n_node_samples___get__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.n_node_samples.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0597</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_ndarray</span><span class="p">()[</span><span class="s">&#39;n_node_samples&#39;</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_node_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_n_s_n_node_samples);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_2, 0, __pyx_v_self-&gt;node_count, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 597, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0598</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0599</span>:     <span class="k">property</span> <span class="nf">weighted_n_node_samples</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0600</span>:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_23weighted_n_node_samples_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_23weighted_n_node_samples_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_23weighted_n_node_samples___get__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_23weighted_n_node_samples___get__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.weighted_n_node_samples.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0601</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_ndarray</span><span class="p">()[</span><span class="s">&#39;weighted_n_node_samples&#39;</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">]</span></pre>
<pre class='cython code score-7 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_node_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_n_s_weighted_n_node_samples);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_2, 0, __pyx_v_self-&gt;node_count, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0602</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0603</span>:     <span class="k">property</span> <span class="nf">value</span><span class="p">:</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0604</span>:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_5value_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_5value_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_5value___get__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_5value___get__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.value.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0605</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_ndarray</span><span class="p">()[:</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">]</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_value_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_1, 0, __pyx_v_self-&gt;node_count, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 605, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0606</span>: </pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0607</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n_features</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n_samples</span><span class="p">):</span></pre>
<pre class='cython code score-44 '>/* Python wrapper */
static int __pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_n_features;
  int __pyx_v_n_samples;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n_features,&amp;__pyx_n_s_n_samples,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_features)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_samples)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 607, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 607, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_n_features = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_n_features == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 607, __pyx_L3_error)</span>
    __pyx_v_n_samples = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_n_samples == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 607, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 607, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree___cinit__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self), __pyx_v_n_features, __pyx_v_n_samples);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree___cinit__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, int __pyx_v_n_features, int __pyx_v_n_samples) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0608</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0609</span>:         <span class="c"># Input/Output layout</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0610</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">=</span> <span class="n">n_features</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;n_features = __pyx_v_n_features;
</pre><pre class="cython line score-0">&#xA0;<span class="">0611</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0612</span>:         <span class="c"># Inner structures</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0613</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;max_depth = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0614</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;node_count = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0615</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;capacity = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0616</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">K_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_samples</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DOUBLE</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_DOUBLE);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;K_y);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;K_y));
  __pyx_v_self-&gt;K_y = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0617</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;y);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;y));
  __pyx_v_self-&gt;y = ((PyArrayObject *)Py_None);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0618</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;nodes = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0619</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;value = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">0620</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0621</span>:     <span class="k">def</span> <span class="nf">__dealloc__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>/* Python wrapper */
static void __pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_3__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_3__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_2__dealloc__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_2__dealloc__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0622</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Destructor.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0623</span>:         <span class="c"># Free all inner structures</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0624</span>:         <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_self-&gt;nodes);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0625</span>:         <span class="n">free</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  free(__pyx_v_self-&gt;value);
</pre><pre class="cython line score-0">&#xA0;<span class="">0626</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0627</span>:     <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-6 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_5__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_4Tree_4__reduce__[] = "Reduce re-implementation, for pickling.";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_5__reduce__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__reduce__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_4__reduce__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_4__reduce__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__reduce__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.__reduce__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0628</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce re-implementation, for pickling.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0629</span>:         <span class="k">return</span> <span class="p">(</span><span class="n">Tree</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">K_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getstate__</span><span class="p">())</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_self-&gt;n_features);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_self-&gt;K_y-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_getstate);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_2 = (__pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_13stpredictions_6models_3OK3_5_tree_Tree));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_13stpredictions_6models_3OK3_5_tree_Tree));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, ((PyObject *)__pyx_ptype_13stpredictions_6models_3OK3_5_tree_Tree));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_2);
  __pyx_t_3 = 0;
  __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0630</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0631</span>:     <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_7__getstate__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_4Tree_6__getstate__[] = "Getstate re-implementation, for pickling.";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_7__getstate__(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__getstate__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_6__getstate__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_6__getstate__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  PyObject *__pyx_v_d = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__getstate__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.__getstate__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_d);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0632</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Getstate re-implementation, for pickling.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0633</span>:         <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_d = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0634</span>:         <span class="c"># capacity is inferred during the __setstate__ using nodes</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0635</span>:         <span class="n">d</span><span class="p">[</span><span class="s">&quot;max_depth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_self-&gt;max_depth);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_d, __pyx_n_s_max_depth, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0636</span>:         <span class="n">d</span><span class="p">[</span><span class="s">&quot;node_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span></pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_self-&gt;node_count);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_d, __pyx_n_s_node_count, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0637</span>:         <span class="n">d</span><span class="p">[</span><span class="s">&quot;nodes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_node_ndarray</span><span class="p">()</span></pre>
<pre class='cython code score-6 '>  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_node_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_d, __pyx_n_s_nodes, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0638</span>:         <span class="n">d</span><span class="p">[</span><span class="s">&quot;values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_ndarray</span><span class="p">()</span></pre>
<pre class='cython code score-6 '>  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_value_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_d, __pyx_n_s_values, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0639</span>:         <span class="n">d</span><span class="p">[</span><span class="s">&quot;K_y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_y</span></pre>
<pre class='cython code score-7 '>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;K_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_d, __pyx_n_s_K_y, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0640</span>:         <span class="n">d</span><span class="p">[</span><span class="s">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-7 '>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_d, __pyx_n_s_y, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 640, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0641</span>:         <span class="k">return</span> <span class="n">d</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_d);
  __pyx_r = __pyx_v_d;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0642</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0643</span>:     <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span></pre>
<pre class='cython code score-9 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_9__setstate__(PyObject *__pyx_v_self, PyObject *__pyx_v_d); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_4Tree_8__setstate__[] = "Setstate re-implementation, for unpickling.";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_9__setstate__(PyObject *__pyx_v_self, PyObject *__pyx_v_d) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__setstate__ (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_8__setstate__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self), ((PyObject *)__pyx_v_d));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_8__setstate__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_d) {
  PyObject *__pyx_v_node_ndarray = NULL;
  PyObject *__pyx_v_value_ndarray = NULL;
  PyObject *__pyx_v_value_shape = NULL;
  CYTHON_UNUSED void *__pyx_v_nodes;
  CYTHON_UNUSED void *__pyx_v_value;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__setstate__", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.__setstate__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_node_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value_shape);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0644</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Setstate re-implementation, for unpickling.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0645</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s">&quot;max_depth&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_d, __pyx_n_s_max_depth);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_1); if (unlikely((__pyx_t_2 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_self-&gt;max_depth = __pyx_t_2;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0646</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s">&quot;node_count&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_d, __pyx_n_s_node_count);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 646, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_1); if (unlikely((__pyx_t_2 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 646, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_self-&gt;node_count = __pyx_t_2;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0647</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">K_y</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s">&quot;K_y&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_d, __pyx_n_s_K_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 647, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 647, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;K_y);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;K_y));
  __pyx_v_self-&gt;K_y = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0648</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s">&quot;y&quot;</span><span class="p">]</span></pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_d, __pyx_n_s_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 648, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;y);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;y));
  __pyx_v_self-&gt;y = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0649</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0650</span>:         <span class="k">if</span> <span class="s">&#39;nodes&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_s_nodes, __pyx_v_d, Py_NE)); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 650, __pyx_L1_error)</span>
  __pyx_t_4 = (__pyx_t_3 != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0651</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;You have loaded Tree version which &#39;</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_You_have_loaded_Tree_version_whi);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 651, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
</pre><pre class="cython line score-0">&#xA0;<span class="">0652</span>:                              <span class="s">&#39;cannot be imported&#39;</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0653</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0654</span>:         <span class="n">node_ndarray</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s">&#39;nodes&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_d, __pyx_n_s_nodes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_node_ndarray = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0655</span>:         <span class="n">value_ndarray</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s">&#39;values&#39;</span><span class="p">]</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_d, __pyx_n_s_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_value_ndarray = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0656</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0657</span>:         <span class="n">value_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">node_ndarray</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_node_ndarray, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_self-&gt;K_y-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_1);
  __pyx_t_5 = 0;
  __pyx_t_1 = 0;
  __pyx_v_value_shape = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0658</span>:         <span class="k">if</span> <span class="p">(</span><span class="n">node_ndarray</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mf">1</span> <span class="ow">or</span></pre>
<pre class='cython code score-8 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_node_ndarray, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_NeObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!__pyx_t_3) {
  } else {
    __pyx_t_4 = __pyx_t_3;
    goto __pyx_L5_bool_binop_done;
  }
/* … */
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0659</span>:                 <span class="n">node_ndarray</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">NODE_DTYPE</span> <span class="ow">or</span></pre>
<pre class='cython code score-14 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_node_ndarray, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_NODE_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 659, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_6, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 659, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 659, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!__pyx_t_3) {
  } else {
    __pyx_t_4 = __pyx_t_3;
    goto __pyx_L5_bool_binop_done;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0660</span>:                 <span class="ow">not</span> <span class="n">node_ndarray</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">c_contiguous</span> <span class="ow">or</span></pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_node_ndarray, __pyx_n_s_flags);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_c_contiguous);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_7 = ((!__pyx_t_3) != 0);
  if (!__pyx_t_7) {
  } else {
    __pyx_t_4 = __pyx_t_7;
    goto __pyx_L5_bool_binop_done;
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0661</span>:                 <span class="n">value_ndarray</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">value_shape</span> <span class="ow">or</span></pre>
<pre class='cython code score-11 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_value_ndarray, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 661, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_v_value_shape, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 661, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 661, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!__pyx_t_7) {
  } else {
    __pyx_t_4 = __pyx_t_7;
    goto __pyx_L5_bool_binop_done;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0662</span>:                 <span class="ow">not</span> <span class="n">value_ndarray</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">c_contiguous</span> <span class="ow">or</span></pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_value_ndarray, __pyx_n_s_flags);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_c_contiguous);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_3 = ((!__pyx_t_7) != 0);
  if (!__pyx_t_3) {
  } else {
    __pyx_t_4 = __pyx_t_3;
    goto __pyx_L5_bool_binop_done;
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0663</span>:                 <span class="n">value_ndarray</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span></pre>
<pre class='cython code score-17 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_value_ndarray, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_t_1, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 663, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 663, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_4 = __pyx_t_3;
  __pyx_L5_bool_binop_done:;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0664</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Did not recognise loaded array layout&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 664, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Did_not_recognise_loaded_array_l);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 664, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class="cython line score-0">&#xA0;<span class="">0665</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0666</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">node_ndarray</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_node_ndarray, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_1); if (unlikely((__pyx_t_2 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 666, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_self-&gt;capacity = __pyx_t_2;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0667</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resize_c</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_9.__pyx_n = 1;
  __pyx_t_9.capacity = __pyx_v_self-&gt;capacity;
  __pyx_t_8 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_resize_c(__pyx_v_self, &amp;__pyx_t_9);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 667, __pyx_L1_error)</span>
  __pyx_t_4 = ((__pyx_t_8 != 0) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0668</span>:             <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">(</span><span class="s">&quot;resizing tree to </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_self-&gt;capacity);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_resizing_tree_to_d, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_MemoryError, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 668, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0669</span>:         <span class="n">nodes</span> <span class="o">=</span> <span class="n">memcpy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="p">(&lt;</span><span class="kt">np.ndarray</span><span class="p">&gt;</span> <span class="n">node_ndarray</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>  __pyx_v_nodes = memcpy(__pyx_v_self-&gt;nodes, ((PyArrayObject *)__pyx_v_node_ndarray)-&gt;data, (__pyx_v_self-&gt;capacity * (sizeof(struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0670</span>:                        <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Node</span><span class="p">))</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0671</span>:         <span class="n">value</span> <span class="o">=</span> <span class="n">memcpy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="p">(&lt;</span><span class="kt">np.ndarray</span><span class="p">&gt;</span> <span class="n">value_ndarray</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>  __pyx_v_value = memcpy(__pyx_v_self-&gt;value, ((PyArrayObject *)__pyx_v_value_ndarray)-&gt;data, ((__pyx_v_self-&gt;capacity * (__pyx_v_self-&gt;K_y-&gt;dimensions[0])) * (sizeof(double))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0672</span>:                        <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">double</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0673</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0674</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">SIZE_t</span> <span class="n">capacity</span><span class="p">)</span> <span class="k">nogil</span> <span class="k">except</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-8 '>static int __pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__resize(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_capacity) {
  int __pyx_r;
  #ifdef WITH_THREAD
  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
  #endif
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_resize", 0);
  #ifdef WITH_THREAD
  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
  #endif
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree._resize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  #ifdef WITH_THREAD
  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
  #endif
  return __pyx_r;
}
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0675</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Resize all inner arrays to `capacity`, if `capacity` == -1, then</span></pre>
<pre class='cython code score-4 '>  /*try:*/ {
/* … */
  /*finally:*/ {
    /*normal exit:*/{
      #ifdef WITH_THREAD
      __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
      #endif
      goto __pyx_L5;
    }
    __pyx_L4_error: {
      #ifdef WITH_THREAD
      __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
      #endif
      goto __pyx_L1_error;
    }
    __pyx_L5:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0676</span>: <span class="sd">           double the size of the inner arrays.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0677</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0678</span>: <span class="sd">        Returns -1 in case of failure to allocate memory (and raise MemoryError)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0679</span>: <span class="sd">        or 0 otherwise.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0680</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0681</span>:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resize_c</span><span class="p">(</span><span class="n">capacity</span><span class="p">)</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2.__pyx_n = 1;
    __pyx_t_2.capacity = __pyx_v_capacity;
    __pyx_t_1 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_resize_c(__pyx_v_self, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 681, __pyx_L4_error)</span>
    __pyx_t_3 = ((__pyx_t_1 != 0) != 0);
    if (__pyx_t_3) {
/* … */
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0682</span>:             <span class="c"># Acquire gil only if we need to raise</span></pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0683</span>:             <span class="k">with</span> <span class="k">gil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>      {
          #ifdef WITH_THREAD
          PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
          #endif
          /*try:*/ {
/* … */
          /*finally:*/ {
            __pyx_L8_error: {
              #ifdef WITH_THREAD
              <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
              #endif
              goto __pyx_L4_error;
            }
          }
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0684</span>:                 <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">()</span></pre>
<pre class='cython code score-5 '>            <span class='py_c_api'>PyErr_NoMemory</span>(); <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L8_error)</span>
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">0685</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0686</span>:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">_resize_c</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">SIZE_t</span> <span class="n">capacity</span><span class="o">=</span><span class="n">SIZE_MAX</span><span class="p">)</span> <span class="k">nogil</span> <span class="k">except</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-6 '>static int __pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__resize_c(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, struct __pyx_opt_args_13stpredictions_6models_3OK3_5_tree_4Tree__resize_c *__pyx_optional_args) {
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_capacity = __pyx_k__8;
  int __pyx_r;
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_capacity = __pyx_optional_args-&gt;capacity;
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
    #endif
    <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree._resize_c", __pyx_clineno, __pyx_lineno, __pyx_filename);
    #ifdef WITH_THREAD
    <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
    #endif
  }
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}
/* … */
  __pyx_k__8 = SIZE_MAX;
</pre><pre class="cython line score-0">&#xA0;<span class="">0687</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Guts of _resize</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0688</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0689</span>: <span class="sd">        Returns -1 in case of failure to allocate memory (and raise MemoryError)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0690</span>: <span class="sd">        or 0 otherwise.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0691</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0692</span>:         <span class="k">if</span> <span class="n">capacity</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">!=</span> <span class="bp">NULL</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_capacity == __pyx_v_self-&gt;capacity) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_self-&gt;nodes != NULL) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0693</span>:             <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0694</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>:         <span class="k">if</span> <span class="n">capacity</span> <span class="o">==</span> <span class="n">SIZE_MAX</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_capacity == SIZE_MAX) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0696</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_self-&gt;capacity == 0) != 0);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0697</span>:                 <span class="n">capacity</span> <span class="o">=</span> <span class="mf">3</span>  <span class="c"># default initial value</span></pre>
<pre class='cython code score-0 '>      __pyx_v_capacity = 3;
</pre><pre class="cython line score-0">&#xA0;<span class="">0698</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0699</span>:                 <span class="n">capacity</span> <span class="o">=</span> <span class="mf">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_capacity = (2 * __pyx_v_self-&gt;capacity);
    }
    __pyx_L7:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0700</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0701</span>:         <span class="n">safe_realloc</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">capacity</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_fuse_6__pyx_f_7sklearn_4tree_6_utils_safe_realloc((&amp;__pyx_v_self-&gt;nodes), __pyx_v_capacity);<span class='error_goto'> if (unlikely(__Pyx_ErrOccurredWithGIL())) __PYX_ERR(0, 701, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0702</span>:         <span class="n">safe_realloc</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">capacity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>  __pyx_fuse_4__pyx_f_7sklearn_4tree_6_utils_safe_realloc((&amp;__pyx_v_self-&gt;value), (__pyx_v_capacity * (__pyx_v_self-&gt;K_y-&gt;dimensions[0])));<span class='error_goto'> if (unlikely(__Pyx_ErrOccurredWithGIL())) __PYX_ERR(0, 702, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0703</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0704</span>:         <span class="c"># value memory is initialised to 0 to enable classifier argmax</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0705</span>:         <span class="k">if</span> <span class="n">capacity</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>
  /* "stpredictions/models/OK3/_tree.pyx":705
 * 
 *         # value memory is initialised to 0 to enable classifier argmax
 *         if capacity &gt; self.capacity:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             memset(&lt;void*&gt;(self.value + self.capacity * self.K_y.shape[0]), 0,
 *                    (capacity - self.capacity) * self.K_y.shape[0] *
 */
  __pyx_t_1 = ((__pyx_v_capacity &gt; __pyx_v_self-&gt;capacity) != 0);
  if (__pyx_t_1) {

    /* "stpredictions/models/OK3/_tree.pyx":705
 * 
 *         # value memory is initialised to 0 to enable classifier argmax
 *         if capacity &gt; self.capacity:             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 *             memset(&lt;void*&gt;(self.value + self.capacity * self.K_y.shape[0]), 0,
 *                    (capacity - self.capacity) * self.K_y.shape[0] *
 */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0706</span>:             <span class="n">memset</span><span class="p">(</span><span class="o">&lt;</span><span class="n">void</span><span class="o">*&gt;</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]),</span> <span class="mf">0</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>    (void)(memset(((void *)(__pyx_v_self-&gt;value + (__pyx_v_self-&gt;capacity * (__pyx_v_self-&gt;K_y-&gt;dimensions[0])))), 0, (((__pyx_v_capacity - __pyx_v_self-&gt;capacity) * (__pyx_v_self-&gt;K_y-&gt;dimensions[0])) * (sizeof(double)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">0707</span>:                    <span class="p">(</span><span class="n">capacity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0708</span>:                    <span class="n">sizeof</span><span class="p">(</span><span class="n">double</span><span class="p">))</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0709</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0710</span>:         <span class="c"># if capacity smaller than node_count, adjust the counter</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0711</span>:         <span class="k">if</span> <span class="n">capacity</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_capacity &lt; __pyx_v_self-&gt;node_count) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0712</span>:             <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span> <span class="o">=</span> <span class="n">capacity</span></pre>
<pre class='cython code score-0 '>    __pyx_v_self-&gt;node_count = __pyx_v_capacity;
</pre><pre class="cython line score-0">&#xA0;<span class="">0713</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0714</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;capacity = __pyx_v_capacity;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0715</span>:         <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0716</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0717</span>:     <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">_add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">SIZE_t</span> <span class="n">parent</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">is_left</span><span class="p">,</span> <span class="nb">bint</span> <span class="n">is_leaf</span><span class="p">,</span></pre>
<pre class='cython code score-6 '>static __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__add_node(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_parent, int __pyx_v_is_left, int __pyx_v_is_leaf, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_feature, double __pyx_v_threshold, double __pyx_v_impurity, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_node_samples, double __pyx_v_weighted_n_node_samples) {
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_node_id;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_node;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
    #endif
    <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree._add_node", __pyx_clineno, __pyx_lineno, __pyx_filename);
    #ifdef WITH_THREAD
    <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
    #endif
  }
  __pyx_r = -1;
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0718</span>:                           <span class="n">SIZE_t</span> <span class="n">feature</span><span class="p">,</span> <span class="n">double</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">double</span> <span class="n">impurity</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0719</span>:                           <span class="n">SIZE_t</span> <span class="n">n_node_samples</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0720</span>:                           <span class="n">double</span> <span class="n">weighted_n_node_samples</span><span class="p">)</span> <span class="k">nogil</span> <span class="k">except</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0721</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a node to the tree.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>: <span class="sd">        The new node registers itself as the child of its parent.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>: <span class="sd">        Returns (size_t)(-1) on error.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0727</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">node_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_self-&gt;node_count;
  __pyx_v_node_id = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">0728</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0729</span>:         <span class="k">if</span> <span class="n">node_id</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_node_id &gt;= __pyx_v_self-&gt;capacity) != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0730</span>:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resize_c</span><span class="p">()</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_3 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_resize_c(__pyx_v_self, NULL);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 730, __pyx_L1_error)</span>
    __pyx_t_2 = ((__pyx_t_3 != 0) != 0);
    if (__pyx_t_2) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0731</span>:                 <span class="k">return</span> <span class="n">SIZE_MAX</span></pre>
<pre class='cython code score-0 '>      __pyx_r = SIZE_MAX;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0732</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0733</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node = (&amp;(__pyx_v_self-&gt;nodes[__pyx_v_node_id]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0734</span>:         <span class="n">node</span><span class="o">.</span><span class="n">impurity</span> <span class="o">=</span> <span class="n">impurity</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;impurity = __pyx_v_impurity;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0735</span>:         <span class="n">node</span><span class="o">.</span><span class="n">n_node_samples</span> <span class="o">=</span> <span class="n">n_node_samples</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;n_node_samples = __pyx_v_n_node_samples;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0736</span>:         <span class="n">node</span><span class="o">.</span><span class="n">weighted_n_node_samples</span> <span class="o">=</span> <span class="n">weighted_n_node_samples</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node-&gt;weighted_n_node_samples = __pyx_v_weighted_n_node_samples;
</pre><pre class="cython line score-0">&#xA0;<span class="">0737</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0738</span>:         <span class="k">if</span> <span class="n">parent</span> <span class="o">!=</span> <span class="n">_TREE_UNDEFINED</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_parent != __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_UNDEFINED) != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0739</span>:             <span class="k">if</span> <span class="n">is_left</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_2 = (__pyx_v_is_left != 0);
    if (__pyx_t_2) {
/* … */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0740</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">left_child</span> <span class="o">=</span> <span class="n">node_id</span></pre>
<pre class='cython code score-0 '>      (__pyx_v_self-&gt;nodes[__pyx_v_parent]).left_child = __pyx_v_node_id;
</pre><pre class="cython line score-0">&#xA0;<span class="">0741</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0742</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span><span class="o">.</span><span class="n">right_child</span> <span class="o">=</span> <span class="n">node_id</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      (__pyx_v_self-&gt;nodes[__pyx_v_parent]).right_child = __pyx_v_node_id;
    }
    __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0743</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0744</span>:         <span class="k">if</span> <span class="n">is_leaf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_2 = (__pyx_v_is_leaf != 0);
  if (__pyx_t_2) {
/* … */
    goto __pyx_L7;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0745</span>:             <span class="n">node</span><span class="o">.</span><span class="n">left_child</span> <span class="o">=</span> <span class="n">_TREE_LEAF</span></pre>
<pre class='cython code score-0 '>    __pyx_v_node-&gt;left_child = __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0746</span>:             <span class="n">node</span><span class="o">.</span><span class="n">right_child</span> <span class="o">=</span> <span class="n">_TREE_LEAF</span></pre>
<pre class='cython code score-0 '>    __pyx_v_node-&gt;right_child = __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0747</span>:             <span class="n">node</span><span class="o">.</span><span class="n">feature</span> <span class="o">=</span> <span class="n">_TREE_UNDEFINED</span></pre>
<pre class='cython code score-0 '>    __pyx_v_node-&gt;feature = __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_UNDEFINED;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0748</span>:             <span class="n">node</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">_TREE_UNDEFINED</span></pre>
<pre class='cython code score-0 '>    __pyx_v_node-&gt;threshold = __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_UNDEFINED;
</pre><pre class="cython line score-0">&#xA0;<span class="">0749</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0750</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0751</span>:             <span class="c"># left_child and right_child will be set later</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0752</span>:             <span class="n">node</span><span class="o">.</span><span class="n">feature</span> <span class="o">=</span> <span class="n">feature</span></pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_v_node-&gt;feature = __pyx_v_feature;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0753</span>:             <span class="n">node</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span></pre>
<pre class='cython code score-0 '>    __pyx_v_node-&gt;threshold = __pyx_v_threshold;
  }
  __pyx_L7:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0754</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0755</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;node_count = (__pyx_v_self-&gt;node_count + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">0756</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0757</span>:         <span class="k">return</span> <span class="n">node_id</span></pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_node_id;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0758</span>: </pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0759</span>:     <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">):</span></pre>
<pre class='cython code score-36 '>static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_11predict(PyObject *__pyx_v_self, PyObject *__pyx_v_X); /*proto*/
static PyArrayObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree_predict(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_X, int __pyx_skip_dispatch) {
  PyArrayObject *__pyx_v_ex_to_leaf = NULL;
  PyArrayObject *__pyx_v_leaf_to_train_exs = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_ex = NULL;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_predict);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_11predict)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_X) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_X);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>
        __pyx_r = ((PyArrayObject *)__pyx_t_2);
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_ex_to_leaf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_leaf_to_train_exs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ex);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_11predict(PyObject *__pyx_v_self, PyObject *__pyx_v_X); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_4Tree_10predict[] = "Returns the weighted training samples falling in the leaves X falls in.\n        It is an array with for each row positive weights for the training indices in the same leaf.\n        (the prediction in the Hilbert space is the weighted mean of these sample's outputs)\n        \n        Parameters\n        ----------\n        X : {array-like, sparse matrix} of shape (n_samples, n_features)\n            The input samples.\n        \n        Returns\n        --------\n         A (n_test_samples, n_train_samples) array\n        ";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_11predict(PyObject *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_10predict(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self), ((PyObject *)__pyx_v_X));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_10predict(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree_predict(__pyx_v_self, __pyx_v_X, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0760</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the weighted training samples falling in the leaves X falls in.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0761</span>: <span class="sd">        It is an array with for each row positive weights for the training indices in the same leaf.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0762</span>: <span class="sd">        (the prediction in the Hilbert space is the weighted mean of these sample&#39;s outputs)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0763</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0764</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0765</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0766</span>: <span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0767</span>: <span class="sd">            The input samples.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0768</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0769</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0770</span>: <span class="sd">        --------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0771</span>: <span class="sd">         A (n_test_samples, n_train_samples) array</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0772</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0773</span>:         <span class="c"># get the leaves X falls in</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0774</span>:         <span class="n">ex_to_leaf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;apply(__pyx_v_self, __pyx_v_X, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_ex_to_leaf = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0775</span>:         <span class="c"># get the list of the training examples each leaf</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0776</span>:         <span class="n">leaf_to_train_exs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_ndarray</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_value_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_leaf_to_train_exs = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0777</span>: </pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0778</span>:         <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">leaf_to_train_exs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DOUBLE</span><span class="p">)</span></pre>
<pre class='cython code score-40 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_leaf_to_train_exs-&gt;dimensions[1]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
  __pyx_t_3 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DOUBLE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_out = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0779</span>:         <span class="c"># assign the right list of training samples to the right input</span></pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0780</span>:         <span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-52 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = Py_TYPE(__pyx_t_4)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_4)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_4, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ex, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0781</span>:             <span class="n">out</span><span class="p">[</span><span class="n">ex</span><span class="p">]</span> <span class="o">=</span> <span class="n">leaf_to_train_exs</span><span class="p">[</span><span class="n">ex_to_leaf</span><span class="p">[</span><span class="n">ex</span><span class="p">]]</span></pre>
<pre class='cython code score-11 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_ex_to_leaf), __pyx_v_ex);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_leaf_to_train_exs), __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_v_ex, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 781, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0782</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0783</span>:         <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  if (!(likely(((__pyx_v_out) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_out, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 783, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = ((PyArrayObject *)__pyx_v_out);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0784</span>: </pre>
<pre class="cython line score-143" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0785</span>:     <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">decode_tree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">K_cand_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">sq_norms_cand</span><span class="p">,</span> <span class="nb">object</span> <span class="n">criterion</span><span class="p">,</span> <span class="nb">str</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">SIZE_t</span> <span class="n">return_top_k</span><span class="p">):</span></pre>
<pre class='cython code score-143 '>static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_13decode_tree(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyArrayObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree_decode_tree(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyArrayObject *__pyx_v_K_cand_train, PyArrayObject *__pyx_v_sq_norms_cand, PyObject *__pyx_v_criterion, PyObject *__pyx_v_kernel, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_return_top_k, int __pyx_skip_dispatch) {
  PyArrayObject *__pyx_v_y_train = NULL;
  npy_intp __pyx_v_n_outputs;
  PyObject *__pyx_v_classes = NULL;
  PyObject *__pyx_v_n_classes = NULL;
  PyObject *__pyx_v_y_train_encoded = NULL;
  npy_intp __pyx_v_l;
  PyObject *__pyx_v_classes_l = NULL;
  PyArrayObject *__pyx_v_leaf_to_train_exs = NULL;
  PyObject *__pyx_v_out = NULL;
  PyObject *__pyx_v_nb_candidates = NULL;
  PyObject *__pyx_v_nb_classes = NULL;
  PyObject *__pyx_v_value = NULL;
  int __pyx_v_recherche_exhaustive_equivalente;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_v_ind = NULL;
  PyObject *__pyx_v_candidate = NULL;
  PyObject *__pyx_v_ind_top_candidates = NULL;
  PyObject *__pyx_v_top_candidates = NULL;
  PyObject *__pyx_v_major_class = NULL;
  npy_intp __pyx_v_ex;
  PyObject *__pyx_v_class_i = NULL;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decode_tree", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_decode_tree);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_13decode_tree)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_return_top_k);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_4 = __pyx_t_1; __pyx_t_5 = NULL;
        __pyx_t_6 = 0;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_5)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
            __pyx_t_6 = 1;
          }
        }
        #if CYTHON_FAST_PYCALL
        if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
          PyObject *__pyx_temp[6] = {__pyx_t_5, ((PyObject *)__pyx_v_K_cand_train), ((PyObject *)__pyx_v_sq_norms_cand), __pyx_v_criterion, __pyx_v_kernel, __pyx_t_3};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 5+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        #if CYTHON_FAST_PYCCALL
        if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
          PyObject *__pyx_temp[6] = {__pyx_t_5, ((PyObject *)__pyx_v_K_cand_train), ((PyObject *)__pyx_v_sq_norms_cand), __pyx_v_criterion, __pyx_v_kernel, __pyx_t_3};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 5+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        } else
        #endif
        {
          __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(5+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          if (__pyx_t_5) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_K_cand_train));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_K_cand_train));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, ((PyObject *)__pyx_v_K_cand_train));
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_sq_norms_cand));
          <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_sq_norms_cand));
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, ((PyObject *)__pyx_v_sq_norms_cand));
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_criterion);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_criterion);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_6, __pyx_v_criterion);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kernel);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_kernel);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3+__pyx_t_6, __pyx_v_kernel);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 4+__pyx_t_6, __pyx_t_3);
          __pyx_t_3 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
        __pyx_r = ((PyArrayObject *)__pyx_t_2);
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_19);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.decode_tree", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_y_train);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_classes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n_classes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_train_encoded);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_classes_l);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_leaf_to_train_exs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nb_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nb_classes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_candidate);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ind_top_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_top_candidates);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_major_class);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_class_i);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_13decode_tree(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_4Tree_12decode_tree[] = "shape (node_count,)\n\n        Decode using the search for the output the closer to the mean of the \n        input's leaf in the embedding Hilbert space\n        corresponds to the KernelizedMSE criterion\n        \n        out[i] is the index of the example whose \n        output has been chosen to represent the output of the leaf i \n        (if i is a leaf, otherwise it is -1).\n        \n        Parameters\n        ----------\n        K_cand_train : array of shape (n_candidates, n_train_samples)\n            The Kernel matrix between the candidates outputs and the training outputs.\n        \n        sq_norms_cand : array of shape (n_candidates,)\n            The list of the kernel values of the candidates computed againt themselves\n            (square L2 norm in the Hilbert space).\n        \n        criterion : {\"mse\"}, default=\"mse\"\n            The function to measure the quality of a split (in the Hilbert space).\n        \n        kernel : string\n            The type of kernel to use to compare the output data. \n            Used only to check wether we want to do classic classification or regression or a general case.\n        \n        return_top_k : int (&gt;0)\n            The number of output to return for each leaf (the size of the set of the best candidates outputs)\n        \n        Returns\n        -------\n        An array of shape (node_count * return_top_k, n_candidates)\n            describing for each LEAF the indices in candidates of the selected output(s), \n            minimizing the \"distance\" with the \"true\" predisction in the Hilbert space.\n            \n        Note :\n            The returned array has an arbitrary value of -1 for the lines corresponding to non-leaf nodes.\n        ";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_13decode_tree(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_K_cand_train = 0;
  PyArrayObject *__pyx_v_sq_norms_cand = 0;
  PyObject *__pyx_v_criterion = 0;
  PyObject *__pyx_v_kernel = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_return_top_k;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decode_tree (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_K_cand_train,&amp;__pyx_n_s_sq_norms_cand,&amp;__pyx_n_s_criterion,&amp;__pyx_n_s_kernel,&amp;__pyx_n_s_return_top_k,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_K_cand_train)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_sq_norms_cand)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decode_tree", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_criterion)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decode_tree", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_kernel)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decode_tree", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_return_top_k)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decode_tree", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "decode_tree") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_K_cand_train = ((PyArrayObject *)values[0]);
    __pyx_v_sq_norms_cand = ((PyArrayObject *)values[1]);
    __pyx_v_criterion = values[2];
    __pyx_v_kernel = ((PyObject*)values[3]);
    __pyx_v_return_top_k = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(values[4]); if (unlikely((__pyx_v_return_top_k == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decode_tree", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.decode_tree", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_K_cand_train), __pyx_ptype_5numpy_ndarray, 1, "K_cand_train", 0))) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sq_norms_cand), __pyx_ptype_5numpy_ndarray, 1, "sq_norms_cand", 0))) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_kernel), (&amp;PyString_Type), 1, "kernel", 1))) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_12decode_tree(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self), __pyx_v_K_cand_train, __pyx_v_sq_norms_cand, __pyx_v_criterion, __pyx_v_kernel, __pyx_v_return_top_k);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_12decode_tree(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyArrayObject *__pyx_v_K_cand_train, PyArrayObject *__pyx_v_sq_norms_cand, PyObject *__pyx_v_criterion, PyObject *__pyx_v_kernel, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_return_top_k) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decode_tree", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree_decode_tree(__pyx_v_self, __pyx_v_K_cand_train, __pyx_v_sq_norms_cand, __pyx_v_criterion, __pyx_v_kernel, __pyx_v_return_top_k, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.decode_tree", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0786</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;shape (node_count,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0787</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0788</span>: <span class="sd">        Decode using the search for the output the closer to the mean of the </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0789</span>: <span class="sd">        input&#39;s leaf in the embedding Hilbert space</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0790</span>: <span class="sd">        corresponds to the KernelizedMSE criterion</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0791</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0792</span>: <span class="sd">        out[i] is the index of the example whose </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0793</span>: <span class="sd">        output has been chosen to represent the output of the leaf i </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0794</span>: <span class="sd">        (if i is a leaf, otherwise it is -1).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0795</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0796</span>: <span class="sd">        Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0797</span>: <span class="sd">        ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0798</span>: <span class="sd">        K_cand_train : array of shape (n_candidates, n_train_samples)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0799</span>: <span class="sd">            The Kernel matrix between the candidates outputs and the training outputs.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0800</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0801</span>: <span class="sd">        sq_norms_cand : array of shape (n_candidates,)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0802</span>: <span class="sd">            The list of the kernel values of the candidates computed againt themselves</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0803</span>: <span class="sd">            (square L2 norm in the Hilbert space).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0804</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0805</span>: <span class="sd">        criterion : {&quot;mse&quot;}, default=&quot;mse&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0806</span>: <span class="sd">            The function to measure the quality of a split (in the Hilbert space).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0807</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0808</span>: <span class="sd">        kernel : string</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0809</span>: <span class="sd">            The type of kernel to use to compare the output data. </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0810</span>: <span class="sd">            Used only to check wether we want to do classic classification or regression or a general case.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0811</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0812</span>: <span class="sd">        return_top_k : int (&gt;0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0813</span>: <span class="sd">            The number of output to return for each leaf (the size of the set of the best candidates outputs)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>: <span class="sd">        </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>: <span class="sd">        Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>: <span class="sd">        -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>: <span class="sd">        An array of shape (node_count * return_top_k, n_candidates)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>: <span class="sd">            describing for each LEAF the indices in candidates of the selected output(s), </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>: <span class="sd">            minimizing the &quot;distance&quot; with the &quot;true&quot; predisction in the Hilbert space.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>: <span class="sd">            </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>: <span class="sd">        Note :</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>: <span class="sd">            The returned array has an arbitrary value of -1 for the lines corresponding to non-leaf nodes.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0823</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0824</span>:         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">criterion</span><span class="p">,</span> <span class="n">KernelizedMSE</span><span class="p">):</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_KernelizedMSE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 824, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_criterion, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 824, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = (__pyx_t_8 != 0);
  if (likely(__pyx_t_9)) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0825</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>:             <span class="c"># Cas particulier de la classification : recherche EXHAUSTIVE</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0827</span>:             <span class="k">if</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s">&quot;gini_clf&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_kernel, __pyx_n_s_gini_clf, Py_EQ)); if (unlikely(__pyx_t_9 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 827, __pyx_L1_error)</span>
    __pyx_t_8 = (__pyx_t_9 != 0);
    if (__pyx_t_8) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0828</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0829</span>:                 <span class="c"># rechercher la meilleure combinaison de labels parmis toutes celles possible</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0830</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0831</span>:                 <span class="n">y_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-1 '>      __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;y);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_v_y_train = ((PyArrayObject *)__pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0832</span>:                 <span class="n">n_outputs</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_v_n_outputs = (__pyx_v_y_train-&gt;dimensions[1]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0833</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0834</span>:                 <span class="n">classes</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 834, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_v_classes = ((PyObject*)__pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0835</span>:                 <span class="n">n_classes</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5 '>      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_v_n_classes = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0836</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0837</span>:                 <span class="n">y_train_encoded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span> <span class="n">n_outputs</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-34 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_y_train-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_outputs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_4);
      __pyx_t_1 = 0;
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 837, __pyx_L1_error)</span>
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 837, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_v_y_train_encoded = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0838</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0839</span>:                 <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_outputs</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>      __pyx_t_10 = __pyx_v_n_outputs;
      __pyx_t_11 = __pyx_t_10;
      for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
        __pyx_v_l = __pyx_t_12;
</pre><pre class="cython line score-103" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0840</span>:                     <span class="n">classes_l</span><span class="p">,</span> <span class="n">y_train_encoded</span><span class="p">[:,</span> <span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">[:,</span> <span class="n">l</span><span class="p">],</span> <span class="n">return_inverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython code score-103 '>        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_unique);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_l);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_slice__9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_y_train), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return_inverse, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 840, __pyx_L1_error)</span>
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          PyObject* sequence = __pyx_t_2;
          Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
          if (unlikely(size != 2)) {
            if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
            else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
            <span class='error_goto'>__PYX_ERR(0, 840, __pyx_L1_error)</span>
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
            __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
            __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          } else {
            __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
            __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          #else
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          #endif
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_13 = Py_TYPE(__pyx_t_7)-&gt;tp_iternext;
          index = 0; __pyx_t_1 = __pyx_t_13(__pyx_t_7); if (unlikely(!__pyx_t_1)) goto __pyx_L7_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          index = 1; __pyx_t_4 = __pyx_t_13(__pyx_t_7); if (unlikely(!__pyx_t_4)) goto __pyx_L7_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_13(__pyx_t_7), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 840, __pyx_L1_error)</span>
          __pyx_t_13 = NULL;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          goto __pyx_L8_unpacking_done;
          __pyx_L7_unpacking_failed:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_13 = NULL;
          if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
          <span class='error_goto'>__PYX_ERR(0, 840, __pyx_L1_error)</span>
          __pyx_L8_unpacking_done:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_classes_l, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_l);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_slice__9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_7);
        __pyx_t_7 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_y_train_encoded, __pyx_t_3, __pyx_t_4) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 840, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_slice__9 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__9)) __PYX_ERR(0, 840, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0841</span>:                     <span class="n">classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classes_l</span><span class="p">)</span></pre>
<pre class='cython code score-2 '>        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_classes, __pyx_v_classes_l);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 841, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0842</span>:                     <span class="n">n_classes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classes_l</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-8 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_classes_l, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 842, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 842, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Append</span>(__pyx_v_n_classes, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 842, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0843</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0844</span>:                 <span class="n">n_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_classes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_n_classes);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_n_classes);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_n_classes);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 844, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 844, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_n_classes, __pyx_t_7);
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0845</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0846</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0847</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0848</span>:                 <span class="n">leaf_to_train_exs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_ndarray</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_value_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 848, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_v_leaf_to_train_exs = ((PyArrayObject *)__pyx_t_7);
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0849</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0850</span>:                 <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="o">*</span><span class="n">return_top_k</span><span class="p">,</span><span class="n">n_outputs</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-46 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_self-&gt;node_count * __pyx_v_return_top_k));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_outputs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_4);
      __pyx_t_7 = 0;
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_out = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0851</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0852</span>:                 <span class="n">nb_candidates</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-1 '>      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
      __pyx_v_nb_candidates = __pyx_int_1;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0853</span>:                 <span class="k">for</span> <span class="n">nb_classes</span> <span class="ow">in</span> <span class="n">n_classes</span><span class="p">:</span></pre>
<pre class='cython code score-43 '>      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_n_classes)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_n_classes)) {
        __pyx_t_2 = __pyx_v_n_classes; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_15 = 0;
        __pyx_t_16 = NULL;
      } else {
        __pyx_t_15 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_n_classes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_16 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
      }
      for (;;) {
        if (likely(!__pyx_t_16)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
            if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_15++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L1_error)</span>
            #else
            __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            #endif
          } else {
            if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_15++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L1_error)</span>
            #else
            __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            #endif
          }
        } else {
          __pyx_t_3 = __pyx_t_16(__pyx_t_2);
          if (unlikely(!__pyx_t_3)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L1_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_nb_classes, __pyx_t_3);
        __pyx_t_3 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0854</span>:                     <span class="n">nb_candidates</span> <span class="o">*=</span> <span class="n">nb_classes</span></pre>
<pre class='cython code score-6 '>        __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_v_nb_candidates, __pyx_v_nb_classes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 854, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_nb_candidates, __pyx_t_3);
        __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0855</span>:                 <span class="c"># array to store the value of the criteria to minimize, for each training sample</span></pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0856</span>:                 <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nb_candidates</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nb_candidates);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nb_candidates);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_nb_candidates);
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 856, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 856, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_value = __pyx_t_7;
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0857</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0858</span>:                 <span class="n">recherche_exhaustive_equivalente</span> <span class="o">=</span> <span class="bp">False</span></pre>
<pre class='cython code score-0 '>      __pyx_v_recherche_exhaustive_equivalente = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0859</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>:                 <span class="c"># node k</span></pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0861</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">):</span></pre>
<pre class='cython code score-49 '>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_self-&gt;node_count);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 861, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 861, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
        __pyx_t_7 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_15 = 0;
        __pyx_t_16 = NULL;
      } else {
        __pyx_t_15 = -1; __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 861, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_16 = Py_TYPE(__pyx_t_7)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 861, __pyx_L1_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      for (;;) {
        if (likely(!__pyx_t_16)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7))) {
            if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_7)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_7, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_15++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L1_error)</span>
            #else
            __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 861, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            #endif
          } else {
            if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_7)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_7, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_15++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L1_error)</span>
            #else
            __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 861, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            #endif
          }
        } else {
          __pyx_t_2 = __pyx_t_16(__pyx_t_7);
          if (unlikely(!__pyx_t_2)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 861, __pyx_L1_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_k, __pyx_t_2);
        __pyx_t_2 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0862</span>:                     <span class="c"># ne considérer que les feuilles pour y calculer une output</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0863</span>:                     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">left_child</span> <span class="o">==</span> <span class="n">_TREE_LEAF</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_k); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
        __pyx_t_8 = (((__pyx_v_self-&gt;nodes[__pyx_t_17]).left_child == __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF) != 0);
        if (__pyx_t_8) {
/* … */
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0864</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0865</span>:                         <span class="k">if</span> <span class="n">recherche_exhaustive_equivalente</span> <span class="ow">or</span> <span class="n">return_top_k</span> <span class="o">&gt;</span> <span class="mf">1</span><span class="p">:</span> <span class="c"># n_outputs boucles sur les classes de chaque output imbriquées dans le product --&gt; long</span></pre>
<pre class='cython code score-0 '>          __pyx_t_9 = (__pyx_v_recherche_exhaustive_equivalente != 0);
          if (!__pyx_t_9) {
          } else {
            __pyx_t_8 = __pyx_t_9;
            goto __pyx_L15_bool_binop_done;
          }
          __pyx_t_9 = ((__pyx_v_return_top_k &gt; 1) != 0);
          __pyx_t_8 = __pyx_t_9;
          __pyx_L15_bool_binop_done:;
          if (__pyx_t_8) {
/* … */
            goto __pyx_L14;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">0866</span>: </pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0867</span>:                             <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">classes</span><span class="p">))):</span></pre>
<pre class='cython code score-35 '>            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
            __pyx_t_2 = __pyx_int_0;
            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_itertools);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_product);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='py_c_api'>PySequence_Tuple</span>(__pyx_v_classes);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_17 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            for (;;) {
              if (__pyx_t_17 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
              #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
              __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_17++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 867, __pyx_L1_error)</span>
              #else
              __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
              #endif
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_candidate, __pyx_t_4);
              __pyx_t_4 = 0;
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind, __pyx_t_2);
              __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_2, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 867, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2);
              __pyx_t_2 = __pyx_t_4;
              __pyx_t_4 = 0;
/* … */
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0868</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0869</span>:                                 <span class="c"># la valeur a minimiser est k(candidate,candidate) - 2 * moyenne_des_Kernel(candidate,train_exs_in_same_leaf)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0870</span>:                                 <span class="c"># dans le cas de gini, k(candidate,candidate) est toujours égal à 1 peu importe candidate</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0871</span>:                                 <span class="c"># on peut donc plutôt maximiser la quantité somme_des_Kernel(candidate,train_exs_in_same_leaf)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0872</span>: </pre>
<pre class="cython line score-81" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0873</span>:                                 <span class="n">value</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span> <span class="n">leaf_to_train_exs</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">ex</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="n">ex</span><span class="p">]</span> <span class="o">==</span> <span class="n">candidate</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">leaf_to_train_exs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">])])</span></pre>
<pre class='cython code score-81 '>              <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
              __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
              __pyx_t_10 = (__pyx_v_leaf_to_train_exs-&gt;dimensions[1]);
              __pyx_t_11 = __pyx_t_10;
              for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
                __pyx_v_ex = __pyx_t_12;
                __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_ex);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
                __pyx_t_19 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 0, __pyx_v_k);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_19, 1, __pyx_t_18);
                __pyx_t_18 = 0;
                __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_leaf_to_train_exs), __pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
                __pyx_t_20 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_y_train), __pyx_v_ex, npy_intp, 1, __Pyx_PyInt_From_Py_intptr_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
                __pyx_t_21 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_20, __pyx_v_candidate, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
                __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_21, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                __pyx_t_21 = NULL;
                if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_20))) {
                  __pyx_t_21 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_20);
                  if (likely(__pyx_t_21)) {
                    PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_20);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_21);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_20, function);
                  }
                }
                __pyx_t_19 = (__pyx_t_21) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_20, __pyx_t_21) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_20);
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                if (unlikely(!__pyx_t_19)) <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
                __pyx_t_20 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_18, __pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 873, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
                if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_20))) <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
              }
              __pyx_t_20 = NULL;
              if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
                __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
                if (likely(__pyx_t_20)) {
                  PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
                }
              }
              __pyx_t_4 = (__pyx_t_20) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_20, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
              if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_value, __pyx_v_ind, __pyx_t_4) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0874</span>: </pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0875</span>:                             <span class="n">ind_top_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="o">-</span> <span class="n">return_top_k</span><span class="p">)[</span><span class="o">-</span> <span class="n">return_top_k</span><span class="p">:]</span></pre>
<pre class='cython code score-49 '>            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 875, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_argpartition);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 875, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((-__pyx_v_return_top_k));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 875, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            __pyx_t_5 = NULL;
            __pyx_t_6 = 0;
            if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
              __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
              if (likely(__pyx_t_5)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
                __pyx_t_6 = 1;
              }
            }
            #if CYTHON_FAST_PYCALL
            if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
              PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_value, __pyx_t_1};
              __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)</span>
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            } else
            #endif
            #if CYTHON_FAST_PYCCALL
            if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
              PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_value, __pyx_t_1};
              __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)</span>
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            } else
            #endif
            {
              __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
              if (__pyx_t_5) {
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
              }
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0+__pyx_t_6, __pyx_v_value);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1+__pyx_t_6, __pyx_t_1);
              __pyx_t_1 = 0;
              __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 875, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_2, (-__pyx_v_return_top_k), 0, NULL, NULL, NULL, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 875, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind_top_candidates, __pyx_t_4);
            __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0876</span>: </pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0877</span>:                             <span class="n">top_candidates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">classes</span><span class="p">))[</span><span class="n">ind_top_candidates</span><span class="p">]</span></pre>
<pre class='cython code score-24 '>            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_itertools);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 877, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_product);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 877, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='py_c_api'>PySequence_Tuple</span>(__pyx_v_classes);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 877, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 877, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 877, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_4, __pyx_v_ind_top_candidates);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 877, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_top_candidates, __pyx_t_3);
            __pyx_t_3 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0878</span>:                             <span class="n">top_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">top_candidates</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython code score-25 '>            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_top_candidates);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_top_candidates);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_top_candidates);
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyInt_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 878, __pyx_L1_error)</span>
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 878, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_top_candidates, __pyx_t_1);
            __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0879</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0880</span>:                             <span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="o">*</span><span class="n">return_top_k</span> <span class="p">:</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">*</span><span class="n">return_top_k</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_candidates</span></pre>
<pre class='cython code score-23 '>            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_return_top_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 880, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_k, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 880, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 880, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_return_top_k);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 880, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 880, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_out, __pyx_v_top_candidates, 0, 0, &amp;__pyx_t_2, &amp;__pyx_t_4, NULL, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 880, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0881</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0882</span>:                         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0883</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0884</span>:                             <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_outputs</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_10 = __pyx_v_n_outputs;
            __pyx_t_11 = __pyx_t_10;
            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_l = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">0885</span>: </pre>
<pre class="cython line score-149" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0886</span>:                                 <span class="n">major_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">leaf_to_train_exs</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="n">y_train</span><span class="p">[:,</span><span class="n">l</span><span class="p">]</span> <span class="o">==</span> <span class="n">class_i</span> <span class="p">)[</span><span class="mf">0</span><span class="p">]</span> <span class="p">]</span> <span class="p">)</span> <span class="k">for</span> <span class="n">class_i</span> <span class="ow">in</span> <span class="n">classes</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="p">]</span> <span class="p">)</span></pre>
<pre class='cython code score-149 '>              <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_argmax);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
              __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              if (likely(<span class='py_c_api'>PyList_CheckExact</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_classes, __pyx_v_l))) || <span class='py_c_api'>PyTuple_CheckExact</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_classes, __pyx_v_l))) {
                __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_classes, __pyx_v_l); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_17 = 0;
                __pyx_t_22 = NULL;
              } else {
                __pyx_t_17 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_classes, __pyx_v_l));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                __pyx_t_22 = Py_TYPE(__pyx_t_1)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
              }
              for (;;) {
                if (likely(!__pyx_t_22)) {
                  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
                    if (__pyx_t_17 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
                    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
                    __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_17++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 886, __pyx_L1_error)</span>
                    #else
                    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                    #endif
                  } else {
                    if (__pyx_t_17 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_1)) break;
                    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
                    __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5); __pyx_t_17++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 886, __pyx_L1_error)</span>
                    #else
                    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                    #endif
                  }
                } else {
                  __pyx_t_5 = __pyx_t_22(__pyx_t_1);
                  if (unlikely(!__pyx_t_5)) {
                    PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                    if (exc_type) {
                      if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                      else <span class='error_goto'>__PYX_ERR(0, 886, __pyx_L1_error)</span>
                    }
                    break;
                  }
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                }
                <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_class_i, __pyx_t_5);
                __pyx_t_5 = 0;
                <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_20, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
                __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_20, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
                <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_18, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
                __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_18, __pyx_n_s_where);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_l);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
                __pyx_t_23 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 0, __pyx_slice__9);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_18);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_23, 1, __pyx_t_18);
                __pyx_t_18 = 0;
                __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_y_train), __pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                __pyx_t_23 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_18, __pyx_v_class_i, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_23);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                __pyx_t_18 = NULL;
                if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_21))) {
                  __pyx_t_18 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_21);
                  if (likely(__pyx_t_18)) {
                    PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_21);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_18);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_21, function);
                  }
                }
                __pyx_t_20 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_21, __pyx_t_18, __pyx_t_23) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_21, __pyx_t_23);
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
                if (unlikely(!__pyx_t_20)) <span class='error_goto'>__PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                __pyx_t_21 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_20, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
                __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_v_k);
                <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
                <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_21);
                __pyx_t_21 = 0;
                __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_leaf_to_train_exs), __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
                __pyx_t_20 = NULL;
                if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_19))) {
                  __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_19);
                  if (likely(__pyx_t_20)) {
                    PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_19);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_19, function);
                  }
                }
                __pyx_t_5 = (__pyx_t_20) ? __Pyx_PyObject_Call2Args(__pyx_t_19, __pyx_t_20, __pyx_t_21) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_19, __pyx_t_21);
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
                if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
                if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_5))) <span class='error_goto'>__PYX_ERR(0, 886, __pyx_L1_error)</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              }
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_t_1 = NULL;
              if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
                __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
                if (likely(__pyx_t_1)) {
                  PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
                }
              }
              __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
              if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 886, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_major_class, __pyx_t_4);
              __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0887</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0888</span>:                                 <span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">l</span><span class="p">][</span> <span class="n">major_class</span> <span class="p">]</span></pre>
<pre class='cython code score-20 '>              __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(<span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_v_classes, __pyx_v_l), __pyx_v_major_class);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 888, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
              __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_l);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
              __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 888, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_k);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
              __pyx_t_3 = 0;
              if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_out, __pyx_t_2, __pyx_t_4) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 888, __pyx_L1_error)</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            }
          }
          __pyx_L14:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0889</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0890</span>:             <span class="c"># Cas particulier de la régression : Recherche EXACTE</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0891</span>:             <span class="k">elif</span> <span class="n">kernel</span> <span class="o">==</span> <span class="s">&quot;mse_reg&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>    __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_v_kernel, __pyx_n_s_mse_reg, Py_EQ)); if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 891, __pyx_L1_error)</span>
    __pyx_t_9 = (__pyx_t_8 != 0);
    if (__pyx_t_9) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0892</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0893</span>:                 <span class="c"># rechercher la meilleure combinaison de labels parmis toutes celles possible</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0894</span>:                 <span class="c"># avec un critère MSE et donc un kernel linéaire, </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0895</span>:                 <span class="c"># la solution exacte (argmin_y [k(y,y) - 2 moyenne_i(k(y,y_leaf_i))]) peut être calculée : </span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>:                 <span class="c"># c&#39;est la moyenne des sorties de chaque feuille</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0897</span>:                 <span class="c">#</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0898</span>:                 <span class="c"># On ne peut pas rechercher les k meilleurs candidats car l&#39;ensemble de recherche de candidats pour la régression est infini (R^d)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0900</span>:                 <span class="n">y_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-1 '>      __pyx_t_7 = ((PyObject *)__pyx_v_self-&gt;y);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      __pyx_v_y_train = ((PyArrayObject *)__pyx_t_7);
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0901</span>:                 <span class="n">n_outputs</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>      __pyx_v_n_outputs = (__pyx_v_y_train-&gt;dimensions[1]);
</pre><pre class="cython line score-0">&#xA0;<span class="">0902</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0903</span>:                 <span class="n">leaf_to_train_exs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_ndarray</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>      __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_value_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 903, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_v_leaf_to_train_exs = ((PyArrayObject *)__pyx_t_7);
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0904</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0905</span>:                 <span class="n">out</span> <span class="o">=</span> <span class="n">leaf_to_train_exs</span> <span class="err">@</span> <span class="n">y_train</span></pre>
<pre class='cython code score-2 '>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyNumber_MatrixMultiply</span>(((PyObject *)__pyx_v_leaf_to_train_exs), ((PyObject *)__pyx_v_y_train));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 905, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_v_out = __pyx_t_7;
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0906</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0907</span>:                 <span class="c"># out = np.ones((self.node_count,n_outputs), dtype=y_train.dtype) * (-1)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0908</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0909</span>:                 <span class="c"># # node k</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0910</span>:                 <span class="c"># for k in range(self.node_count):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0911</span>:                 <span class="c">#     # ne considérer que les feuilles pour y calculer une output</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0912</span>:                 <span class="c">#     if self.nodes[k].left_child == _TREE_LEAF:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0913</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0914</span>:                 <span class="c">#         out[k] = np.sum(np.array([ leaf_to_train_exs[k,ex] * y_train[ex] for ex in range(leaf_to_train_exs.shape[1])]), axis=0)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0915</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0916</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0917</span>:             <span class="c"># Dans ce else, on a donc une matrice de Gram de candidats fournie</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0918</span>:             <span class="k">else</span><span class="p">:</span> <span class="c"># cas général : pas de classification ou de régression mais recherche de l&#39;argmin dans l&#39;ensemble de candidats fourni</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0919</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0920</span>:                 <span class="c"># on a comme candidats une matrice de Gram des des candidats contre les training (+contre soi meme).</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0921</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0922</span>:                 <span class="c"># on renvoie l&#39;indce du candidat représentant le mieux la feuille (on ne check pas les training examples, ils sont à mettre dans les candidats)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0923</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0924</span>:                 <span class="n">leaf_to_train_exs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value_ndarray</span><span class="p">()</span></pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_7 = ((PyObject *)((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_get_value_ndarray(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 924, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_v_leaf_to_train_exs = ((PyArrayObject *)__pyx_t_7);
      __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0925</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0926</span>:                 <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="o">*</span><span class="n">return_top_k</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-43 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_self-&gt;node_count * __pyx_v_return_top_k));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 926, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_v_out = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0927</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0928</span>:                 <span class="c"># array to store the value of the criteria to minimize, for each training sample</span></pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0929</span>:                 <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">K_cand_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">],),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-37 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_K_cand_train-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2);
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_7);
      __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 929, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_v_value = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0930</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>:                 <span class="c"># node k</span></pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0932</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">):</span></pre>
<pre class='cython code score-49 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_self-&gt;node_count);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 932, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 932, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
        __pyx_t_3 = __pyx_t_7; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_15 = 0;
        __pyx_t_16 = NULL;
      } else {
        __pyx_t_15 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 932, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_16 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 932, __pyx_L1_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      for (;;) {
        if (likely(!__pyx_t_16)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
            if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_15++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 932, __pyx_L1_error)</span>
            #else
            __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 932, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            #endif
          } else {
            if (__pyx_t_15 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_15); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_15++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 932, __pyx_L1_error)</span>
            #else
            __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_15); __pyx_t_15++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 932, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            #endif
          }
        } else {
          __pyx_t_7 = __pyx_t_16(__pyx_t_3);
          if (unlikely(!__pyx_t_7)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 932, __pyx_L1_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_k, __pyx_t_7);
        __pyx_t_7 = 0;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0933</span>:                     <span class="c"># ne considérer que les feuilles pour y calculer une output</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0934</span>:                     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">left_child</span> <span class="o">==</span> <span class="n">_TREE_LEAF</span><span class="p">:</span></pre>
<pre class='cython code score-7 '>        __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_k); if (unlikely((__pyx_t_17 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 934, __pyx_L1_error)</span>
        __pyx_t_9 = (((__pyx_v_self-&gt;nodes[__pyx_t_17]).left_child == __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF) != 0);
        if (__pyx_t_9) {
/* … */
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0935</span>:                         <span class="c"># parmi les candidats, calculer k[candidat,candidat] - 2/self.n_node_samples * sum_i=0^self.n_node_samples k[candidat,i]</span></pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0936</span>:                         <span class="k">for</span> <span class="n">candidate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K_cand_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-49 '>          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((__pyx_v_K_cand_train-&gt;dimensions[0]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 936, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 936, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
            __pyx_t_7 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_17 = 0;
            __pyx_t_22 = NULL;
          } else {
            __pyx_t_17 = -1; __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 936, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            __pyx_t_22 = Py_TYPE(__pyx_t_7)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 936, __pyx_L1_error)</span>
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          for (;;) {
            if (likely(!__pyx_t_22)) {
              if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7))) {
                if (__pyx_t_17 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_7)) break;
                #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
                __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_7, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_17++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 936, __pyx_L1_error)</span>
                #else
                __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 936, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                #endif
              } else {
                if (__pyx_t_17 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_7)) break;
                #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
                __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_7, __pyx_t_17); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_17++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 936, __pyx_L1_error)</span>
                #else
                __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_7, __pyx_t_17); __pyx_t_17++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 936, __pyx_L1_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                #endif
              }
            } else {
              __pyx_t_2 = __pyx_t_22(__pyx_t_7);
              if (unlikely(!__pyx_t_2)) {
                PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                if (exc_type) {
                  if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                  else <span class='error_goto'>__PYX_ERR(0, 936, __pyx_L1_error)</span>
                }
                break;
              }
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_candidate, __pyx_t_2);
            __pyx_t_2 = 0;
/* … */
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0937</span>: </pre>
<pre class="cython line score-82" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0938</span>:                             <span class="n">value</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span> <span class="o">=</span> <span class="n">sq_norms_cand</span><span class="p">[</span><span class="n">candidate</span><span class="p">]</span> <span class="o">-</span> <span class="mf">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">leaf_to_train_exs</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">ex</span><span class="p">]</span> <span class="o">*</span> <span class="n">K_cand_train</span><span class="p">[</span><span class="n">candidate</span><span class="p">,</span><span class="n">ex</span><span class="p">]</span> <span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">leaf_to_train_exs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">])])</span></pre>
<pre class='cython code score-82 '>            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_sq_norms_cand), __pyx_v_candidate);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_10 = (__pyx_v_leaf_to_train_exs-&gt;dimensions[1]);
            __pyx_t_11 = __pyx_t_10;
            for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
              __pyx_v_ex = __pyx_t_12;
              __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_ex);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
              __pyx_t_21 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_k);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_k);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 0, __pyx_v_k);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_19);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_21, 1, __pyx_t_19);
              __pyx_t_19 = 0;
              __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_leaf_to_train_exs), __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_19)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
              __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_ex);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
              __pyx_t_20 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_candidate);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_candidate);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 0, __pyx_v_candidate);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_21);
              <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_20, 1, __pyx_t_21);
              __pyx_t_21 = 0;
              __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_K_cand_train), __pyx_t_20);<span class='error_goto'> if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_21);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
              __pyx_t_20 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_19, __pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_21); __pyx_t_21 = 0;
              if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_4, (PyObject*)__pyx_t_20))) <span class='error_goto'>__PYX_ERR(0, 938, __pyx_L1_error)</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            }
            __pyx_t_20 = NULL;
            if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
              __pyx_t_20 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
              if (likely(__pyx_t_20)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_20);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
              }
            }
            __pyx_t_1 = (__pyx_t_20) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_20, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_20); __pyx_t_20 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 938, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_value, __pyx_v_candidate, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 938, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0939</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0940</span>:                         <span class="c"># choisir l&#39;entrée ex* qui donnait la plus petite valeur</span></pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0941</span>:                         <span class="n">ind_top_candidates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">return_top_k</span><span class="p">)[:</span><span class="n">return_top_k</span><span class="p">]</span></pre>
<pre class='cython code score-49 '>          <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_argpartition);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 941, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_return_top_k);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_2 = NULL;
          __pyx_t_6 = 0;
          if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
            __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
            if (likely(__pyx_t_2)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
              __pyx_t_6 = 1;
            }
          }
          #if CYTHON_FAST_PYCALL
          if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_5)) {
            PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_value, __pyx_t_1};
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 941, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          } else
          #endif
          #if CYTHON_FAST_PYCCALL
          if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_5)) {
            PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_value, __pyx_t_1};
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_5, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 941, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          } else
          #endif
          {
            __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 941, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            if (__pyx_t_2) {
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
            }
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0+__pyx_t_6, __pyx_v_value);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
            <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1+__pyx_t_6, __pyx_t_1);
            __pyx_t_1 = 0;
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 941, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_7, 0, __pyx_v_return_top_k, NULL, NULL, NULL, 0, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 941, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ind_top_candidates, __pyx_t_5);
          __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0942</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0943</span>:                         <span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="o">*</span><span class="n">return_top_k</span> <span class="p">:</span> <span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">*</span><span class="n">return_top_k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind_top_candidates</span></pre>
<pre class='cython code score-23 '>          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_return_top_k);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_k, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_k, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_return_top_k);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          if (<span class='pyx_c_api'>__Pyx_PyObject_SetSlice</span>(__pyx_v_out, __pyx_v_ind_top_candidates, 0, 0, &amp;__pyx_t_7, &amp;__pyx_t_1, NULL, 0, 0, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 943, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0944</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0945</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0946</span>:             <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-4 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
    if (!(likely(((__pyx_v_out) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v_out, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 946, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
    __pyx_r = ((PyArrayObject *)__pyx_v_out);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0947</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0949</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0950</span>:             <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;only the &quot;KernelizedMSE&quot; criterion is supported&#39;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_NotImplementedError, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 950, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 950, __pyx_L1_error)</span>
  }
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_only_the_KernelizedMSE_criterion);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 950, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre><pre class="cython line score-0">&#xA0;<span class="">0951</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0953</span>:     <span class="k">cpdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">):</span></pre>
<pre class='cython code score-32 '>static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_15apply(PyObject *__pyx_v_self, PyObject *__pyx_v_X); /*proto*/
static PyArrayObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree_apply(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_X, int __pyx_skip_dispatch) {
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("apply", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_apply);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 953, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_15apply)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_X) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_X);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 953, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 953, __pyx_L1_error)</span>
        __pyx_r = ((PyArrayObject *)__pyx_t_2);
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.apply", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_15apply(PyObject *__pyx_v_self, PyObject *__pyx_v_X); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_4Tree_14apply[] = "Finds the terminal region (=leaf node) for each sample in X.";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_15apply(PyObject *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("apply (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_14apply(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self), ((PyObject *)__pyx_v_X));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_14apply(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("apply", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree_apply(__pyx_v_self, __pyx_v_X, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 953, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.apply", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0954</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds the terminal region (=leaf node) for each sample in X.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0955</span>:         <span class="k">if</span> <span class="n">issparse</span><span class="p">(</span><span class="n">X</span><span class="p">):</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_issparse);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 955, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_X) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 955, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 955, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0956</span>:             <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">==</span> <span class="n">csc_matrix</span><span class="p">:</span></pre>
<pre class='cython code score-11 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_csc_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(((PyObject *)Py_TYPE(__pyx_v_X)), __pyx_t_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 956, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 956, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0957</span>:                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_sparse_csr</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">tocsr</span><span class="p">())</span></pre>
<pre class='cython code score-20 '>      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_tocsr);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      __pyx_t_2 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 957, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = ((PyObject *)__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__apply_sparse_csr(__pyx_v_self, __pyx_t_2));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = ((PyArrayObject *)__pyx_t_1);
      __pyx_t_1 = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0958</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0959</span>:                 <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_sparse_csr</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>    /*else*/ {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
      __pyx_t_1 = ((PyObject *)__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__apply_sparse_csr(__pyx_v_self, __pyx_v_X));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 959, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_r = ((PyArrayObject *)__pyx_t_1);
      __pyx_t_1 = 0;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0960</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0961</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_dense</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
    __pyx_t_1 = ((PyObject *)__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__apply_dense(__pyx_v_self, __pyx_v_X));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 961, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_r = ((PyArrayObject *)__pyx_t_1);
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0962</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0963</span>:     <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">_apply_dense</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">):</span></pre>
<pre class='cython code score-16 '>static PyArrayObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__apply_dense(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_X) {
  __Pyx_memviewslice __pyx_v_X_ndarray = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_samples;
  PyArrayObject *__pyx_v_out = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *__pyx_v_out_ptr;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_node;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_i;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_out;
  __Pyx_Buffer __pyx_pybuffer_out;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_apply_dense", 0);
  __pyx_pybuffer_out.pybuffer.buf = NULL;
  __pyx_pybuffer_out.refcount = 0;
  __pyx_pybuffernd_out.data = NULL;
  __pyx_pybuffernd_out.rcbuffer = &amp;__pyx_pybuffer_out;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree._apply_dense", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_X_ndarray, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_out);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">0964</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds the terminal region (=leaf node) for each sample in X.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>:         <span class="c"># Check input</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0967</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_X, __pyx_ptype_5numpy_ndarray); 
  __pyx_t_2 = ((!(__pyx_t_1 != 0)) != 0);
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0968</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;X should be in np.ndarray format, got </span><span class="si">%s</span><span class="s">&quot;</span></pre>
<pre class='cython code score-6 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 968, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 968, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0969</span>:                              <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">))</span></pre>
<pre class='cython code score-2 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyString_FormatSafe</span>(__pyx_kp_s_X_should_be_in_np_ndarray_format, ((PyObject *)Py_TYPE(__pyx_v_X)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 969, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">0970</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0971</span>:         <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">DTYPE</span><span class="p">:</span></pre>
<pre class='cython code score-14 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_3, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 971, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0972</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;X.dtype should be np.float32, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 972, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyString_FormatSafe</span>(__pyx_kp_s_X_dtype_should_be_np_float32_got, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 972, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 972, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 972, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0973</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0974</span>:         <span class="c"># Extract input</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0975</span>:         <span class="k">cdef</span> <span class="kt">const</span> <span class="kt">DTYPE_t</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">X_ndarray</span> <span class="o">=</span> <span class="n">X</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t__const__(__pyx_v_X, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
  __pyx_v_X_ndarray = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0976</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 976, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 976, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_3); if (unlikely((__pyx_t_7 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 976, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_n_samples = __pyx_t_7;
</pre><pre class="cython line score-0">&#xA0;<span class="">0977</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0978</span>:         <span class="c"># Initialize output</span></pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0979</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">SIZE_t</span>] <span class="nf">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_samples</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 979, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 979, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_9) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_9, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 979, __pyx_L1_error)</span>
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_9);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_10, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_out = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 979, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_out.diminfo[0].strides = __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_out.diminfo[0].shape = __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_out = ((PyArrayObject *)__pyx_t_9);
  __pyx_t_9 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0980</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span>* <span class="nf">out_ptr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">*&gt;</span> <span class="n">out</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out_ptr = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *)__pyx_v_out-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">0981</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0982</span>:         <span class="c"># Initialize auxiliary data-structure</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0983</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">node</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0984</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0985</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0986</span>:         <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L7;
        }
        __pyx_L7:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0987</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_7 = __pyx_v_n_samples;
        __pyx_t_11 = __pyx_t_7;
        for (__pyx_t_12 = 0; __pyx_t_12 &lt; __pyx_t_11; __pyx_t_12+=1) {
          __pyx_v_i = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0988</span>:                 <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span></pre>
<pre class='cython code score-0 '>          __pyx_t_13 = __pyx_v_self-&gt;nodes;
          __pyx_v_node = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">0989</span>:                 <span class="c"># While node not a leaf</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0990</span>:                 <span class="k">while</span> <span class="n">node</span><span class="o">.</span><span class="n">left_child</span> <span class="o">!=</span> <span class="n">_TREE_LEAF</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          while (1) {
            __pyx_t_2 = ((__pyx_v_node-&gt;left_child != __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF) != 0);
            if (!__pyx_t_2) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">0991</span>:                     <span class="c"># ... and node.right_child != _TREE_LEAF:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0992</span>:                     <span class="k">if</span> <span class="n">X_ndarray</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">node</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = __pyx_v_i;
            __pyx_t_15 = __pyx_v_node-&gt;feature;
            __pyx_t_2 = (((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X_ndarray.data + __pyx_t_14 * __pyx_v_X_ndarray.strides[0]) ) + __pyx_t_15 * __pyx_v_X_ndarray.strides[1]) ))) &lt;= __pyx_v_node-&gt;threshold) != 0);
            if (__pyx_t_2) {
/* … */
              goto __pyx_L12;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0993</span>:                         <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">left_child</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>              __pyx_v_node = (&amp;(__pyx_v_self-&gt;nodes[__pyx_v_node-&gt;left_child]));
</pre><pre class="cython line score-0">&#xA0;<span class="">0994</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0995</span>:                         <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">right_child</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            /*else*/ {
              __pyx_v_node = (&amp;(__pyx_v_self-&gt;nodes[__pyx_v_node-&gt;right_child]));
            }
            __pyx_L12:;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">0996</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0997</span>:                 <span class="n">out_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">node</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>  <span class="c"># node offset</span></pre>
<pre class='cython code score-0 '>          (__pyx_v_out_ptr[__pyx_v_i]) = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)(__pyx_v_node - __pyx_v_self-&gt;nodes));
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0998</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0999</span>:         <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_out));
  __pyx_r = ((PyArrayObject *)__pyx_v_out);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1000</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1001</span>:     <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">_apply_sparse_csr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">):</span></pre>
<pre class='cython code score-31 '>static PyArrayObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__apply_sparse_csr(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_X) {
  PyArrayObject *__pyx_v_X_data_ndarray = 0;
  PyArrayObject *__pyx_v_X_indices_ndarray = 0;
  PyArrayObject *__pyx_v_X_indptr_ndarray = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t *__pyx_v_X_data;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t *__pyx_v_X_indices;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t *__pyx_v_X_indptr;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_samples;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_features;
  PyArrayObject *__pyx_v_out = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *__pyx_v_out_ptr;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t __pyx_v_feature_value;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_node;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t *__pyx_v_X_sample;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_i;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t __pyx_v_k;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *__pyx_v_feature_to_sample;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X_data_ndarray;
  __Pyx_Buffer __pyx_pybuffer_X_data_ndarray;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X_indices_ndarray;
  __Pyx_Buffer __pyx_pybuffer_X_indices_ndarray;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X_indptr_ndarray;
  __Pyx_Buffer __pyx_pybuffer_X_indptr_ndarray;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_out;
  __Pyx_Buffer __pyx_pybuffer_out;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_apply_sparse_csr", 0);
  __pyx_pybuffer_X_data_ndarray.pybuffer.buf = NULL;
  __pyx_pybuffer_X_data_ndarray.refcount = 0;
  __pyx_pybuffernd_X_data_ndarray.data = NULL;
  __pyx_pybuffernd_X_data_ndarray.rcbuffer = &amp;__pyx_pybuffer_X_data_ndarray;
  __pyx_pybuffer_X_indices_ndarray.pybuffer.buf = NULL;
  __pyx_pybuffer_X_indices_ndarray.refcount = 0;
  __pyx_pybuffernd_X_indices_ndarray.data = NULL;
  __pyx_pybuffernd_X_indices_ndarray.rcbuffer = &amp;__pyx_pybuffer_X_indices_ndarray;
  __pyx_pybuffer_X_indptr_ndarray.pybuffer.buf = NULL;
  __pyx_pybuffer_X_indptr_ndarray.refcount = 0;
  __pyx_pybuffernd_X_indptr_ndarray.data = NULL;
  __pyx_pybuffernd_X_indptr_ndarray.rcbuffer = &amp;__pyx_pybuffer_X_indptr_ndarray;
  __pyx_pybuffer_out.pybuffer.buf = NULL;
  __pyx_pybuffer_out.refcount = 0;
  __pyx_pybuffernd_out.data = NULL;
  __pyx_pybuffernd_out.rcbuffer = &amp;__pyx_pybuffer_out;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree._apply_sparse_csr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_X_data_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_X_indices_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_X_indptr_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_out);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1002</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds the terminal region (=leaf node) for each sample in sparse X.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1003</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1004</span>:         <span class="c"># Check input</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1005</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">csr_matrix</span><span class="p">):</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_csr_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1005, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_X, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 1005, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = ((!(__pyx_t_2 != 0)) != 0);
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1006</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;X should be in csr_matrix format, got </span><span class="si">%s</span><span class="s">&quot;</span></pre>
<pre class='cython code score-6 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1006, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1006, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1007</span>:                              <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">))</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyString_FormatSafe</span>(__pyx_kp_s_X_should_be_in_csr_matrix_format, ((PyObject *)Py_TYPE(__pyx_v_X)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1007, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1008</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1009</span>:         <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">DTYPE</span><span class="p">:</span></pre>
<pre class='cython code score-14 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1009, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1009, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_1, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1009, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1009, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1010</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;X.dtype should be np.float32, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1010, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyString_FormatSafe</span>(__pyx_kp_s_X_dtype_should_be_np_float32_got, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1010, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1010, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1010, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1012</span>:         <span class="c"># Extract input</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1013</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE_t</span><span class="p">]</span> <span class="n">X_data_ndarray</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-7 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1013, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1013, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X_data_ndarray = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1013, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_X_data_ndarray.diminfo[0].strides = __pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_X_data_ndarray.diminfo[0].shape = __pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_X_data_ndarray = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1014</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">INT32_t</span><span class="p">]</span> <span class="n">X_indices_ndarray</span>  <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">indices</span></pre>
<pre class='cython code score-7 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_indices);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1014, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1014, __pyx_L1_error)</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X_indices_ndarray = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1014, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_X_indices_ndarray.diminfo[0].strides = __pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_X_indices_ndarray.diminfo[0].shape = __pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_X_indices_ndarray = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1015</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">INT32_t</span><span class="p">]</span> <span class="n">X_indptr_ndarray</span>  <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">indptr</span></pre>
<pre class='cython code score-7 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_indptr);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1015, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_8, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X_indptr_ndarray = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_X_indptr_ndarray.diminfo[0].strides = __pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_X_indptr_ndarray.diminfo[0].shape = __pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_X_indptr_ndarray = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1016</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1017</span>:         <span class="k">cdef</span> <span class="kt">DTYPE_t</span>* <span class="nf">X_data</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">DTYPE_t</span><span class="o">*&gt;</span><span class="n">X_data_ndarray</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_X_data = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t *)__pyx_v_X_data_ndarray-&gt;data);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1018</span>:         <span class="k">cdef</span> <span class="kt">INT32_t</span>* <span class="nf">X_indices</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">INT32_t</span><span class="o">*&gt;</span><span class="n">X_indices_ndarray</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_X_indices = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t *)__pyx_v_X_indices_ndarray-&gt;data);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1019</span>:         <span class="k">cdef</span> <span class="kt">INT32_t</span>* <span class="nf">X_indptr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">INT32_t</span><span class="o">*&gt;</span><span class="n">X_indptr_ndarray</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_X_indptr = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t *)__pyx_v_X_indptr_ndarray-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">1020</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1021</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1021, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1021, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_1); if (unlikely((__pyx_t_9 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n_samples = __pyx_t_9;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1022</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1022, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1022, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_5); if (unlikely((__pyx_t_9 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1022, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_n_features = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">1023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1024</span>:         <span class="c"># Initialize output</span></pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1025</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">SIZE_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_samples</span><span class="p">,),</span></pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_4);
  __pyx_t_4 = 0;
/* … */
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1025, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_11) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_11, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L1_error)</span>
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_11);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_out = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_out.diminfo[0].strides = __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_out.diminfo[0].shape = __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_out = ((PyArrayObject *)__pyx_t_11);
  __pyx_t_11 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1026</span>:                                                        <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1026, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1026, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1026, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1026, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1027</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span>* <span class="nf">out_ptr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">*&gt;</span> <span class="n">out</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_out_ptr = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *)__pyx_v_out-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">1028</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1029</span>:         <span class="c"># Initialize auxiliary data-structure</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1030</span>:         <span class="k">cdef</span> <span class="kt">DTYPE_t</span> <span class="nf">feature_value</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_feature_value = 0.;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1031</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">node</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1032</span>:         <span class="k">cdef</span> <span class="kt">DTYPE_t</span>* <span class="nf">X_sample</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_X_sample = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1033</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1034</span>:         <span class="k">cdef</span> <span class="kt">INT32_t</span> <span class="nf">k</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_k = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1035</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1036</span>:         <span class="c"># feature_to_sample as a data structure records the last seen sample</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1037</span>:         <span class="c"># for each feature; functionally, it is an efficient way to identify</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1038</span>:         <span class="c"># which features are nonzero in the present sample.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1039</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span>* <span class="nf">feature_to_sample</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_feature_to_sample = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1040</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1041</span>:         <span class="n">safe_realloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">X_sample</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_fuse_0__pyx_f_7sklearn_4tree_6_utils_safe_realloc((&amp;__pyx_v_X_sample), __pyx_v_n_features);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1041, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1042</span>:         <span class="n">safe_realloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">feature_to_sample</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_fuse_1__pyx_f_7sklearn_4tree_6_utils_safe_realloc((&amp;__pyx_v_feature_to_sample), __pyx_v_n_features);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1042, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1043</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1044</span>:         <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L7;
        }
        __pyx_L7:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1045</span>:             <span class="n">memset</span><span class="p">(</span><span class="n">feature_to_sample</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">SIZE_t</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>        (void)(memset(__pyx_v_feature_to_sample, -1, (__pyx_v_n_features * (sizeof(__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1046</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1047</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_9 = __pyx_v_n_samples;
        __pyx_t_13 = __pyx_t_9;
        for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
          __pyx_v_i = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1048</span>:                 <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = __pyx_v_self-&gt;nodes;
          __pyx_v_node = __pyx_t_15;
</pre><pre class="cython line score-0">&#xA0;<span class="">1049</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1050</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_indptr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">X_indptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_16 = (__pyx_v_X_indptr[(__pyx_v_i + 1)]);
          __pyx_t_17 = __pyx_t_16;
          for (__pyx_t_18 = (__pyx_v_X_indptr[__pyx_v_i]); __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
            __pyx_v_k = __pyx_t_18;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1051</span>:                     <span class="n">feature_to_sample</span><span class="p">[</span><span class="n">X_indices</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>            (__pyx_v_feature_to_sample[(__pyx_v_X_indices[__pyx_v_k])]) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1052</span>:                     <span class="n">X_sample</span><span class="p">[</span><span class="n">X_indices</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">X_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            (__pyx_v_X_sample[(__pyx_v_X_indices[__pyx_v_k])]) = (__pyx_v_X_data[__pyx_v_k]);
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1053</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1054</span>:                 <span class="c"># While node not a leaf</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1055</span>:                 <span class="k">while</span> <span class="n">node</span><span class="o">.</span><span class="n">left_child</span> <span class="o">!=</span> <span class="n">_TREE_LEAF</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          while (1) {
            __pyx_t_3 = ((__pyx_v_node-&gt;left_child != __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF) != 0);
            if (!__pyx_t_3) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">1056</span>:                     <span class="c"># ... and node.right_child != _TREE_LEAF:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1057</span>:                     <span class="k">if</span> <span class="n">feature_to_sample</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_3 = (((__pyx_v_feature_to_sample[__pyx_v_node-&gt;feature]) == __pyx_v_i) != 0);
            if (__pyx_t_3) {
/* … */
              goto __pyx_L14;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1058</span>:                         <span class="n">feature_value</span> <span class="o">=</span> <span class="n">X_sample</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>              __pyx_v_feature_value = (__pyx_v_X_sample[__pyx_v_node-&gt;feature]);
</pre><pre class="cython line score-0">&#xA0;<span class="">1059</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1060</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1061</span>:                         <span class="n">feature_value</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>            /*else*/ {
              __pyx_v_feature_value = 0.;
            }
            __pyx_L14:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1062</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1063</span>:                     <span class="k">if</span> <span class="n">feature_value</span> <span class="o">&lt;=</span> <span class="n">node</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_3 = ((__pyx_v_feature_value &lt;= __pyx_v_node-&gt;threshold) != 0);
            if (__pyx_t_3) {
/* … */
              goto __pyx_L15;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1064</span>:                         <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">left_child</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>              __pyx_v_node = (&amp;(__pyx_v_self-&gt;nodes[__pyx_v_node-&gt;left_child]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1065</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1066</span>:                         <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">right_child</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            /*else*/ {
              __pyx_v_node = (&amp;(__pyx_v_self-&gt;nodes[__pyx_v_node-&gt;right_child]));
            }
            __pyx_L15:;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1067</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1068</span>:                 <span class="n">out_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">node</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>  <span class="c"># node offset</span></pre>
<pre class='cython code score-0 '>          (__pyx_v_out_ptr[__pyx_v_i]) = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)(__pyx_v_node - __pyx_v_self-&gt;nodes));
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1069</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1070</span>:             <span class="c"># Free auxiliary arrays</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1071</span>:             <span class="n">free</span><span class="p">(</span><span class="n">X_sample</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        free(__pyx_v_X_sample);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1072</span>:             <span class="n">free</span><span class="p">(</span><span class="n">feature_to_sample</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        free(__pyx_v_feature_to_sample);
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1073</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1074</span>:         <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_out));
  __pyx_r = ((PyArrayObject *)__pyx_v_out);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1075</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1076</span>:     <span class="k">cpdef</span> <span class="kt">object</span> <span class="nf">decision_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">):</span></pre>
<pre class='cython code score-30 '>static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_17decision_path(PyObject *__pyx_v_self, PyObject *__pyx_v_X); /*proto*/
static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree_decision_path(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_X, int __pyx_skip_dispatch) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decision_path", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_decision_path);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_17decision_path)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_X) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_X);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1076, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_r = __pyx_t_2;
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.decision_path", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_17decision_path(PyObject *__pyx_v_self, PyObject *__pyx_v_X); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_4Tree_16decision_path[] = "Finds the decision path (=node) for each sample in X.";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_17decision_path(PyObject *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decision_path (wrapper)", 0);
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_16decision_path(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self), ((PyObject *)__pyx_v_X));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_16decision_path(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decision_path", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree_decision_path(__pyx_v_self, __pyx_v_X, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1076, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.decision_path", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1077</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds the decision path (=node) for each sample in X.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1078</span>:         <span class="k">if</span> <span class="n">issparse</span><span class="p">(</span><span class="n">X</span><span class="p">):</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_issparse);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_X) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_X);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1078, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1079</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decision_path_sparse_csr</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = __pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__decision_path_sparse_csr(__pyx_v_self, __pyx_v_X);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1079, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1080</span>:         <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1081</span>:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decision_path_dense</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = __pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__decision_path_dense(__pyx_v_self, __pyx_v_X);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1081, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1082</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1083</span>:     <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">object</span> <span class="nf">_decision_path_dense</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">):</span></pre>
<pre class='cython code score-28 '>static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__decision_path_dense(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_X) {
  __Pyx_memviewslice __pyx_v_X_ndarray = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_samples;
  PyArrayObject *__pyx_v_indptr = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *__pyx_v_indptr_ptr;
  PyArrayObject *__pyx_v_indices = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *__pyx_v_indices_ptr;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_node;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_i;
  PyArrayObject *__pyx_v_data = 0;
  PyObject *__pyx_v_out = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_data;
  __Pyx_Buffer __pyx_pybuffer_data;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_indices;
  __Pyx_Buffer __pyx_pybuffer_indices;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_indptr;
  __Pyx_Buffer __pyx_pybuffer_indptr;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_decision_path_dense", 0);
  __pyx_pybuffer_indptr.pybuffer.buf = NULL;
  __pyx_pybuffer_indptr.refcount = 0;
  __pyx_pybuffernd_indptr.data = NULL;
  __pyx_pybuffernd_indptr.rcbuffer = &amp;__pyx_pybuffer_indptr;
  __pyx_pybuffer_indices.pybuffer.buf = NULL;
  __pyx_pybuffer_indices.refcount = 0;
  __pyx_pybuffernd_indices.data = NULL;
  __pyx_pybuffernd_indices.rcbuffer = &amp;__pyx_pybuffer_indices;
  __pyx_pybuffer_data.pybuffer.buf = NULL;
  __pyx_pybuffer_data.refcount = 0;
  __pyx_pybuffernd_data.data = NULL;
  __pyx_pybuffernd_data.rcbuffer = &amp;__pyx_pybuffer_data;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_data.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree._decision_path_dense", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_data.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_X_ndarray, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_indptr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_indices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1084</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds the decision path (=node) for each sample in X.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1086</span>:         <span class="c"># Check input</span></pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1087</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span></pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_TypeCheck</span>(__pyx_v_X, __pyx_ptype_5numpy_ndarray); 
  __pyx_t_2 = ((!(__pyx_t_1 != 0)) != 0);
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1088</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;X should be in np.ndarray format, got </span><span class="si">%s</span><span class="s">&quot;</span></pre>
<pre class='cython code score-6 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1088, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1088, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1089</span>:                              <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">))</span></pre>
<pre class='cython code score-2 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyString_FormatSafe</span>(__pyx_kp_s_X_should_be_in_np_ndarray_format, ((PyObject *)Py_TYPE(__pyx_v_X)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1089, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">1090</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1091</span>:         <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">DTYPE</span><span class="p">:</span></pre>
<pre class='cython code score-14 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_3, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1091, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1091, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1092</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;X.dtype should be np.float32, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyString_FormatSafe</span>(__pyx_kp_s_X_dtype_should_be_np_float32_got, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1093</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1094</span>:         <span class="c"># Extract input</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1095</span>:         <span class="k">cdef</span> <span class="kt">const</span> <span class="kt">DTYPE_t</span>[<span class="p">:,</span> <span class="p">:]</span> <span class="n">X_ndarray</span> <span class="o">=</span> <span class="n">X</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t__const__(__pyx_v_X, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1095, __pyx_L1_error)</span>
  __pyx_v_X_ndarray = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1096</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_3); if (unlikely((__pyx_t_7 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1096, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_n_samples = __pyx_t_7;
</pre><pre class="cython line score-0">&#xA0;<span class="">1097</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1098</span>:         <span class="c"># Initialize output</span></pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1099</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">SIZE_t</span>] <span class="nf">indptr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_n_samples + 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1099, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_9) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_9, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1099, __pyx_L1_error)</span>
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_9);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_10, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_indptr = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1099, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_indptr.diminfo[0].strides = __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_indptr.diminfo[0].shape = __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_indptr = ((PyArrayObject *)__pyx_t_9);
  __pyx_t_9 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1100</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span>* <span class="nf">indptr_ptr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">*&gt;</span> <span class="n">indptr</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>
  /* "stpredictions/models/OK3/_tree.pyx":1100
 *         # Initialize output
 *         cdef np.ndarray[SIZE_t] indptr = np.zeros(n_samples + 1, dtype=np.intp)
 *         cdef SIZE_t* indptr_ptr = &lt;SIZE_t*&gt; indptr.data             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         cdef np.ndarray[SIZE_t] indices = np.zeros(n_samples *
 */
  __pyx_v_indptr_ptr = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *)__pyx_v_indptr-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">1101</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1102</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">SIZE_t</span>] <span class="nf">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span> <span class="o">*</span></pre>
<pre class='cython code score-23 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_n_samples * (1 + __pyx_v_self-&gt;max_depth)));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_9);
  __pyx_t_9 = 0;
/* … */
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1102, __pyx_L1_error)</span>
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_8);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_indices = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1102, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_indices.diminfo[0].strides = __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_indices.diminfo[0].shape = __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_indices = ((PyArrayObject *)__pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1103</span>:                                                    <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span><span class="p">),</span></pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1104</span>:                                                    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1105</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span>* <span class="nf">indices_ptr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">*&gt;</span> <span class="n">indices</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_indices_ptr = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *)__pyx_v_indices-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">1106</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1107</span>:         <span class="c"># Initialize auxiliary data-structure</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1108</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">node</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1109</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1110</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1111</span>:         <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L7;
        }
        __pyx_L7:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1112</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_7 = __pyx_v_n_samples;
        __pyx_t_12 = __pyx_t_7;
        for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
          __pyx_v_i = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1113</span>:                 <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_self-&gt;nodes;
          __pyx_v_node = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1114</span>:                 <span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          (__pyx_v_indptr_ptr[(__pyx_v_i + 1)]) = (__pyx_v_indptr_ptr[__pyx_v_i]);
</pre><pre class="cython line score-0">&#xA0;<span class="">1115</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1116</span>:                 <span class="c"># Add all external nodes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1117</span>:                 <span class="k">while</span> <span class="n">node</span><span class="o">.</span><span class="n">left_child</span> <span class="o">!=</span> <span class="n">_TREE_LEAF</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          while (1) {
            __pyx_t_2 = ((__pyx_v_node-&gt;left_child != __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF) != 0);
            if (!__pyx_t_2) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">1118</span>:                     <span class="c"># ... and node.right_child != _TREE_LEAF:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1119</span>:                     <span class="n">indices_ptr</span><span class="p">[</span><span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">node</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            (__pyx_v_indices_ptr[(__pyx_v_indptr_ptr[(__pyx_v_i + 1)])]) = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)(__pyx_v_node - __pyx_v_self-&gt;nodes));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1120</span>:                     <span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>            __pyx_t_15 = (__pyx_v_i + 1);
            (__pyx_v_indptr_ptr[__pyx_t_15]) = ((__pyx_v_indptr_ptr[__pyx_t_15]) + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1121</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1122</span>:                     <span class="k">if</span> <span class="n">X_ndarray</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">node</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_16 = __pyx_v_i;
            __pyx_t_17 = __pyx_v_node-&gt;feature;
            __pyx_t_2 = (((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_X_ndarray.data + __pyx_t_16 * __pyx_v_X_ndarray.strides[0]) ) + __pyx_t_17 * __pyx_v_X_ndarray.strides[1]) ))) &lt;= __pyx_v_node-&gt;threshold) != 0);
            if (__pyx_t_2) {
/* … */
              goto __pyx_L12;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1123</span>:                         <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">left_child</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>              __pyx_v_node = (&amp;(__pyx_v_self-&gt;nodes[__pyx_v_node-&gt;left_child]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1124</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1125</span>:                         <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">right_child</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            /*else*/ {
              __pyx_v_node = (&amp;(__pyx_v_self-&gt;nodes[__pyx_v_node-&gt;right_child]));
            }
            __pyx_L12:;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1126</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1127</span>:                 <span class="c"># Add the leave node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1128</span>:                 <span class="n">indices_ptr</span><span class="p">[</span><span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">node</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          (__pyx_v_indices_ptr[(__pyx_v_indptr_ptr[(__pyx_v_i + 1)])]) = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)(__pyx_v_node - __pyx_v_self-&gt;nodes));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1129</span>:                 <span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = (__pyx_v_i + 1);
          (__pyx_v_indptr_ptr[__pyx_t_15]) = ((__pyx_v_indptr_ptr[__pyx_t_15]) + 1);
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1130</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1131</span>:         <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[:</span><span class="n">indptr</span><span class="p">[</span><span class="n">n_samples</span><span class="p">]]</span></pre>
<pre class='cython code score-32 '>  __pyx_t_17 = __pyx_v_n_samples;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((*__Pyx_BufPtrStrided1d(__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_indptr.diminfo[0].strides)));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_t_8, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_indices), __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_8);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer);
    __pyx_t_18 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_18 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_19, &amp;__pyx_t_20, &amp;__pyx_t_21);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_indices, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_19); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_19, __pyx_t_20, __pyx_t_21);
      }
      __pyx_t_19 = __pyx_t_20 = __pyx_t_21 = 0;
    }
    __pyx_pybuffernd_indices.diminfo[0].strides = __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_indices.diminfo[0].shape = __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_18 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
  }
  __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_indices, ((PyArrayObject *)__pyx_t_8));
  __pyx_t_8 = 0;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1132</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">SIZE_t</span>] <span class="nf">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">),</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_22 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_indices));<span class='error_goto'> if (unlikely(__pyx_t_22 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_22);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_shape, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_empty_tuple, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
  __pyx_t_23 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_data.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_23, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_data = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_data.diminfo[0].strides = __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_data.diminfo[0].shape = __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_23 = 0;
  __pyx_v_data = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1133</span>:                                                <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1134</span>:         <span class="n">out</span> <span class="o">=</span> <span class="n">csr_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">indptr</span><span class="p">),</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_csr_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_data));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_data));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, ((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_indices));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_indices));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, ((PyObject *)__pyx_v_indices));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_indptr));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_indptr));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, ((PyObject *)__pyx_v_indptr));
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_8);
  __pyx_t_8 = 0;
/* … */
  __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_9, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_out = __pyx_t_24;
  __pyx_t_24 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1135</span>:                          <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">))</span></pre>
<pre class='cython code score-19 '>  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_self-&gt;node_count);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_24 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_24, 1, __pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_shape, __pyx_t_24) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1135, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1136</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1137</span>:         <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1138</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1139</span>:     <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">object</span> <span class="nf">_decision_path_sparse_csr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">X</span><span class="p">):</span></pre>
<pre class='cython code score-43 '>static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__decision_path_sparse_csr(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_X) {
  PyArrayObject *__pyx_v_X_data_ndarray = 0;
  PyArrayObject *__pyx_v_X_indices_ndarray = 0;
  PyArrayObject *__pyx_v_X_indptr_ndarray = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t *__pyx_v_X_data;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t *__pyx_v_X_indices;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t *__pyx_v_X_indptr;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_samples;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_features;
  PyArrayObject *__pyx_v_indptr = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *__pyx_v_indptr_ptr;
  PyArrayObject *__pyx_v_indices = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *__pyx_v_indices_ptr;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t __pyx_v_feature_value;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_node;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t *__pyx_v_X_sample;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_i;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t __pyx_v_k;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *__pyx_v_feature_to_sample;
  PyArrayObject *__pyx_v_data = 0;
  PyObject *__pyx_v_out = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X_data_ndarray;
  __Pyx_Buffer __pyx_pybuffer_X_data_ndarray;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X_indices_ndarray;
  __Pyx_Buffer __pyx_pybuffer_X_indices_ndarray;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X_indptr_ndarray;
  __Pyx_Buffer __pyx_pybuffer_X_indptr_ndarray;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_data;
  __Pyx_Buffer __pyx_pybuffer_data;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_indices;
  __Pyx_Buffer __pyx_pybuffer_indices;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_indptr;
  __Pyx_Buffer __pyx_pybuffer_indptr;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_decision_path_sparse_csr", 0);
  __pyx_pybuffer_X_data_ndarray.pybuffer.buf = NULL;
  __pyx_pybuffer_X_data_ndarray.refcount = 0;
  __pyx_pybuffernd_X_data_ndarray.data = NULL;
  __pyx_pybuffernd_X_data_ndarray.rcbuffer = &amp;__pyx_pybuffer_X_data_ndarray;
  __pyx_pybuffer_X_indices_ndarray.pybuffer.buf = NULL;
  __pyx_pybuffer_X_indices_ndarray.refcount = 0;
  __pyx_pybuffernd_X_indices_ndarray.data = NULL;
  __pyx_pybuffernd_X_indices_ndarray.rcbuffer = &amp;__pyx_pybuffer_X_indices_ndarray;
  __pyx_pybuffer_X_indptr_ndarray.pybuffer.buf = NULL;
  __pyx_pybuffer_X_indptr_ndarray.refcount = 0;
  __pyx_pybuffernd_X_indptr_ndarray.data = NULL;
  __pyx_pybuffernd_X_indptr_ndarray.rcbuffer = &amp;__pyx_pybuffer_X_indptr_ndarray;
  __pyx_pybuffer_indptr.pybuffer.buf = NULL;
  __pyx_pybuffer_indptr.refcount = 0;
  __pyx_pybuffernd_indptr.data = NULL;
  __pyx_pybuffernd_indptr.rcbuffer = &amp;__pyx_pybuffer_indptr;
  __pyx_pybuffer_indices.pybuffer.buf = NULL;
  __pyx_pybuffer_indices.refcount = 0;
  __pyx_pybuffernd_indices.data = NULL;
  __pyx_pybuffernd_indices.rcbuffer = &amp;__pyx_pybuffer_indices;
  __pyx_pybuffer_data.pybuffer.buf = NULL;
  __pyx_pybuffer_data.refcount = 0;
  __pyx_pybuffernd_data.data = NULL;
  __pyx_pybuffernd_data.rcbuffer = &amp;__pyx_pybuffer_data;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_28);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_data.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree._decision_path_sparse_csr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_data.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_X_data_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_X_indices_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_X_indptr_ndarray);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_indptr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_indices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1140</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Finds the decision path (=node) for each sample in X.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1141</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1142</span>:         <span class="c"># Check input</span></pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1143</span>:         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">csr_matrix</span><span class="p">):</span></pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_csr_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_X, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 1143, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = ((!(__pyx_t_2 != 0)) != 0);
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1144</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;X should be in csr_matrix format, got </span><span class="si">%s</span><span class="s">&quot;</span></pre>
<pre class='cython code score-6 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1144, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1144, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1145</span>:                              <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">))</span></pre>
<pre class='cython code score-2 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyString_FormatSafe</span>(__pyx_kp_s_X_should_be_in_csr_matrix_format, ((PyObject *)Py_TYPE(__pyx_v_X)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1145, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1146</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1147</span>:         <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">DTYPE</span><span class="p">:</span></pre>
<pre class='cython code score-14 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_1, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1147, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1147, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1148</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;X.dtype should be np.float32, got </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">X</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyString_FormatSafe</span>(__pyx_kp_s_X_dtype_should_be_np_float32_got, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1148, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1148, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1149</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1150</span>:         <span class="c"># Extract input</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1151</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">DTYPE_t</span><span class="p">]</span> <span class="n">X_data_ndarray</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-7 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1151, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X_data_ndarray = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1151, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_X_data_ndarray.diminfo[0].strides = __pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_X_data_ndarray.diminfo[0].shape = __pyx_pybuffernd_X_data_ndarray.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_X_data_ndarray = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1152</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">INT32_t</span><span class="p">]</span> <span class="n">X_indices_ndarray</span>  <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">indices</span></pre>
<pre class='cython code score-7 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_indices);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1152, __pyx_L1_error)</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X_indices_ndarray = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1152, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_X_indices_ndarray.diminfo[0].strides = __pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_X_indices_ndarray.diminfo[0].shape = __pyx_pybuffernd_X_indices_ndarray.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_X_indices_ndarray = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1153</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">INT32_t</span><span class="p">]</span> <span class="n">X_indptr_ndarray</span>  <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">indptr</span></pre>
<pre class='cython code score-7 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_indptr);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1153, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1153, __pyx_L1_error)</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_8, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X_indptr_ndarray = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1153, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_X_indptr_ndarray.diminfo[0].strides = __pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_X_indptr_ndarray.diminfo[0].shape = __pyx_pybuffernd_X_indptr_ndarray.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_X_indptr_ndarray = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1154</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1155</span>:         <span class="k">cdef</span> <span class="kt">DTYPE_t</span>* <span class="nf">X_data</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">DTYPE_t</span><span class="o">*&gt;</span><span class="n">X_data_ndarray</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_X_data = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_DTYPE_t *)__pyx_v_X_data_ndarray-&gt;data);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1156</span>:         <span class="k">cdef</span> <span class="kt">INT32_t</span>* <span class="nf">X_indices</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">INT32_t</span><span class="o">*&gt;</span><span class="n">X_indices_ndarray</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_X_indices = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t *)__pyx_v_X_indices_ndarray-&gt;data);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1157</span>:         <span class="k">cdef</span> <span class="kt">INT32_t</span>* <span class="nf">X_indptr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">INT32_t</span><span class="o">*&gt;</span><span class="n">X_indptr_ndarray</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_X_indptr = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_INT32_t *)__pyx_v_X_indptr_ndarray-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">1158</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1159</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1159, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1159, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_1); if (unlikely((__pyx_t_9 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1159, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n_samples = __pyx_t_9;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1160</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_Py_intptr_t</span>(__pyx_t_5); if (unlikely((__pyx_t_9 == ((npy_intp)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_n_features = __pyx_t_9;
</pre><pre class="cython line score-0">&#xA0;<span class="">1161</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1162</span>:         <span class="c"># Initialize output</span></pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1163</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">SIZE_t</span>] <span class="nf">indptr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-36 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_n_samples + 1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_11) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_11, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1163, __pyx_L1_error)</span>
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_11);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_indptr = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1163, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_indptr.diminfo[0].strides = __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_indptr.diminfo[0].shape = __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_indptr = ((PyArrayObject *)__pyx_t_11);
  __pyx_t_11 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1164</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span>* <span class="nf">indptr_ptr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">*&gt;</span> <span class="n">indptr</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>
  /* "stpredictions/models/OK3/_tree.pyx":1164
 *         # Initialize output
 *         cdef np.ndarray[SIZE_t] indptr = np.zeros(n_samples + 1, dtype=np.intp)
 *         cdef SIZE_t* indptr_ptr = &lt;SIZE_t*&gt; indptr.data             # &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
 * 
 *         cdef np.ndarray[SIZE_t] indices = np.zeros(n_samples *
 */
  __pyx_v_indptr_ptr = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *)__pyx_v_indptr-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">1165</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1166</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">SIZE_t</span>] <span class="nf">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span> <span class="o">*</span></pre>
<pre class='cython code score-23 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1166, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1166, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>((__pyx_v_n_samples * (1 + __pyx_v_self-&gt;max_depth)));<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1166, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
/* … */
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1166, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_11);
  __pyx_t_11 = 0;
/* … */
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_4, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1166, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (!(likely(((__pyx_t_10) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_10, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1166, __pyx_L1_error)</span>
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_10);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_13, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_indices = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1166, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_indices.diminfo[0].strides = __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_indices.diminfo[0].shape = __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_indices = ((PyArrayObject *)__pyx_t_10);
  __pyx_t_10 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1167</span>:                                                    <span class="p">(</span><span class="mf">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span><span class="p">),</span></pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1168</span>:                                                    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-13 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1168, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1168, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1168, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_dtype, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1168, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1169</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span>* <span class="nf">indices_ptr</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">*&gt;</span> <span class="n">indices</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_indices_ptr = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *)__pyx_v_indices-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">1170</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1171</span>:         <span class="c"># Initialize auxiliary data-structure</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1172</span>:         <span class="k">cdef</span> <span class="kt">DTYPE_t</span> <span class="nf">feature_value</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_feature_value = 0.;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1173</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">node</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1174</span>:         <span class="k">cdef</span> <span class="kt">DTYPE_t</span>* <span class="nf">X_sample</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_X_sample = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1175</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_i = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1176</span>:         <span class="k">cdef</span> <span class="kt">INT32_t</span> <span class="nf">k</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_k = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1177</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1178</span>:         <span class="c"># feature_to_sample as a data structure records the last seen sample</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1179</span>:         <span class="c"># for each feature; functionally, it is an efficient way to identify</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1180</span>:         <span class="c"># which features are nonzero in the present sample.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1181</span>:         <span class="k">cdef</span> <span class="kt">SIZE_t</span>* <span class="nf">feature_to_sample</span> <span class="o">=</span> <span class="bp">NULL</span></pre>
<pre class='cython code score-0 '>  __pyx_v_feature_to_sample = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1182</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1183</span>:         <span class="n">safe_realloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">X_sample</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_fuse_0__pyx_f_7sklearn_4tree_6_utils_safe_realloc((&amp;__pyx_v_X_sample), __pyx_v_n_features);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1183, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1184</span>:         <span class="n">safe_realloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">feature_to_sample</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_fuse_1__pyx_f_7sklearn_4tree_6_utils_safe_realloc((&amp;__pyx_v_feature_to_sample), __pyx_v_n_features);<span class='error_goto'> if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1184, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1185</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1186</span>:         <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L7;
        }
        __pyx_L7:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1187</span>:             <span class="n">memset</span><span class="p">(</span><span class="n">feature_to_sample</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">*</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">SIZE_t</span><span class="p">))</span></pre>
<pre class='cython code score-0 '>        (void)(memset(__pyx_v_feature_to_sample, -1, (__pyx_v_n_features * (sizeof(__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1188</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1189</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_9 = __pyx_v_n_samples;
        __pyx_t_14 = __pyx_t_9;
        for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
          __pyx_v_i = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1190</span>:                 <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span></pre>
<pre class='cython code score-0 '>          __pyx_t_16 = __pyx_v_self-&gt;nodes;
          __pyx_v_node = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1191</span>:                 <span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          (__pyx_v_indptr_ptr[(__pyx_v_i + 1)]) = (__pyx_v_indptr_ptr[__pyx_v_i]);
</pre><pre class="cython line score-0">&#xA0;<span class="">1192</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1193</span>:                 <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X_indptr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">X_indptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_17 = (__pyx_v_X_indptr[(__pyx_v_i + 1)]);
          __pyx_t_18 = __pyx_t_17;
          for (__pyx_t_19 = (__pyx_v_X_indptr[__pyx_v_i]); __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
            __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1194</span>:                     <span class="n">feature_to_sample</span><span class="p">[</span><span class="n">X_indices</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>            (__pyx_v_feature_to_sample[(__pyx_v_X_indices[__pyx_v_k])]) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1195</span>:                     <span class="n">X_sample</span><span class="p">[</span><span class="n">X_indices</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">X_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            (__pyx_v_X_sample[(__pyx_v_X_indices[__pyx_v_k])]) = (__pyx_v_X_data[__pyx_v_k]);
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1196</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1197</span>:                 <span class="c"># While node not a leaf</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1198</span>:                 <span class="k">while</span> <span class="n">node</span><span class="o">.</span><span class="n">left_child</span> <span class="o">!=</span> <span class="n">_TREE_LEAF</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          while (1) {
            __pyx_t_3 = ((__pyx_v_node-&gt;left_child != __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF) != 0);
            if (!__pyx_t_3) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">1199</span>:                     <span class="c"># ... and node.right_child != _TREE_LEAF:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1200</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1201</span>:                     <span class="n">indices_ptr</span><span class="p">[</span><span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">node</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            (__pyx_v_indices_ptr[(__pyx_v_indptr_ptr[(__pyx_v_i + 1)])]) = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)(__pyx_v_node - __pyx_v_self-&gt;nodes));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1202</span>:                     <span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>            __pyx_t_20 = (__pyx_v_i + 1);
            (__pyx_v_indptr_ptr[__pyx_t_20]) = ((__pyx_v_indptr_ptr[__pyx_t_20]) + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1203</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1204</span>:                     <span class="k">if</span> <span class="n">feature_to_sample</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_3 = (((__pyx_v_feature_to_sample[__pyx_v_node-&gt;feature]) == __pyx_v_i) != 0);
            if (__pyx_t_3) {
/* … */
              goto __pyx_L14;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1205</span>:                         <span class="n">feature_value</span> <span class="o">=</span> <span class="n">X_sample</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>              __pyx_v_feature_value = (__pyx_v_X_sample[__pyx_v_node-&gt;feature]);
</pre><pre class="cython line score-0">&#xA0;<span class="">1206</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1207</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1208</span>:                         <span class="n">feature_value</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>            /*else*/ {
              __pyx_v_feature_value = 0.;
            }
            __pyx_L14:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1209</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1210</span>:                     <span class="k">if</span> <span class="n">feature_value</span> <span class="o">&lt;=</span> <span class="n">node</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_3 = ((__pyx_v_feature_value &lt;= __pyx_v_node-&gt;threshold) != 0);
            if (__pyx_t_3) {
/* … */
              goto __pyx_L15;
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1211</span>:                         <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">left_child</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>              __pyx_v_node = (&amp;(__pyx_v_self-&gt;nodes[__pyx_v_node-&gt;left_child]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1212</span>:                     <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1213</span>:                         <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">right_child</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            /*else*/ {
              __pyx_v_node = (&amp;(__pyx_v_self-&gt;nodes[__pyx_v_node-&gt;right_child]));
            }
            __pyx_L15:;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1214</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1215</span>:                 <span class="c"># Add the leave node</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1216</span>:                 <span class="n">indices_ptr</span><span class="p">[</span><span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">SIZE_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">node</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          (__pyx_v_indices_ptr[(__pyx_v_indptr_ptr[(__pyx_v_i + 1)])]) = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)(__pyx_v_node - __pyx_v_self-&gt;nodes));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1217</span>:                 <span class="n">indptr_ptr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mf">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_t_20 = (__pyx_v_i + 1);
          (__pyx_v_indptr_ptr[__pyx_t_20]) = ((__pyx_v_indptr_ptr[__pyx_t_20]) + 1);
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1218</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1219</span>:             <span class="c"># Free auxiliary arrays</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1220</span>:             <span class="n">free</span><span class="p">(</span><span class="n">X_sample</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        free(__pyx_v_X_sample);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1221</span>:             <span class="n">free</span><span class="p">(</span><span class="n">feature_to_sample</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        free(__pyx_v_feature_to_sample);
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1222</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1223</span>:         <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[:</span><span class="n">indptr</span><span class="p">[</span><span class="n">n_samples</span><span class="p">]]</span></pre>
<pre class='cython code score-32 '>  __pyx_t_21 = __pyx_v_n_samples;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>((*__Pyx_BufPtrStrided1d(__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *, __pyx_pybuffernd_indptr.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_indptr.diminfo[0].strides)));<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_t_10, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_indices), __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (!(likely(((__pyx_t_10) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_10, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1223, __pyx_L1_error)</span>
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_10);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer);
    __pyx_t_22 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_13, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_22 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_23, &amp;__pyx_t_24, &amp;__pyx_t_25);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_indices, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_23); Py_XDECREF(__pyx_t_24); Py_XDECREF(__pyx_t_25);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_23, __pyx_t_24, __pyx_t_25);
      }
      __pyx_t_23 = __pyx_t_24 = __pyx_t_25 = 0;
    }
    __pyx_pybuffernd_indices.diminfo[0].strides = __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_indices.diminfo[0].shape = __pyx_pybuffernd_indices.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_22 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1223, __pyx_L1_error)</span>
  }
  __pyx_t_13 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_indices, ((PyArrayObject *)__pyx_t_10));
  __pyx_t_10 = 0;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1224</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">SIZE_t</span>] <span class="nf">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">),</span></pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_26 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_indices));<span class='error_goto'> if (unlikely(__pyx_t_26 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1224, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_26);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_shape, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_empty_tuple, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>
  __pyx_t_27 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_data.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_27, &amp;__Pyx_TypeInfo_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_data = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_data.diminfo[0].strides = __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_data.diminfo[0].shape = __pyx_pybuffernd_data.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_27 = 0;
  __pyx_v_data = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1225</span>:                                                <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1226</span>:         <span class="n">out</span> <span class="o">=</span> <span class="n">csr_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">indptr</span><span class="p">),</span></pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_csr_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1226, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1226, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_data));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_data));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, ((PyObject *)__pyx_v_data));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_indices));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_indices));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, ((PyObject *)__pyx_v_indices));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_indptr));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_indptr));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, ((PyObject *)__pyx_v_indptr));
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1226, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_10);
  __pyx_t_10 = 0;
/* … */
  __pyx_t_28 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_11, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1226, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_28);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_out = __pyx_t_28;
  __pyx_t_28 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1227</span>:                          <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span><span class="p">))</span></pre>
<pre class='cython code score-19 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1227, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_samples);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1227, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_self-&gt;node_count);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1227, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_28 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 1227, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 0, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_28, 1, __pyx_t_1);
  __pyx_t_4 = 0;
  __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_shape, __pyx_t_28) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1227, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_28); __pyx_t_28 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1228</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1229</span>:         <span class="k">return</span> <span class="n">out</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out);
  __pyx_r = __pyx_v_out;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1230</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1231</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1232</span>:     <span class="k">cpdef</span> <span class="nf">compute_feature_importances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span></pre>
<pre class='cython code score-57 '>static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_19compute_feature_importances(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree_compute_feature_importances(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, int __pyx_skip_dispatch, struct __pyx_opt_args_13stpredictions_6models_3OK3_5_tree_4Tree_compute_feature_importances *__pyx_optional_args) {
  PyObject *__pyx_v_normalize = ((PyObject *)Py_True);
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_left;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_right;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_nodes;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_node;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_end_node;
  double __pyx_v_normalizer;
  PyArrayObject *__pyx_v_importances = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *__pyx_v_importance_data;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_importances;
  __Pyx_Buffer __pyx_pybuffer_importances;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_feature_importances", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_normalize = __pyx_optional_args-&gt;normalize;
    }
  }
  __pyx_pybuffer_importances.pybuffer.buf = NULL;
  __pyx_pybuffer_importances.refcount = 0;
  __pyx_pybuffernd_importances.data = NULL;
  __pyx_pybuffernd_importances.rcbuffer = &amp;__pyx_pybuffer_importances;
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely((Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0) || (Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_flags &amp; (Py_TPFLAGS_IS_ABSTRACT | Py_TPFLAGS_HEAPTYPE)))) {
    #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    static PY_UINT64_T __pyx_tp_dict_version = __PYX_DICT_VERSION_INIT, __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
    if (unlikely(!__Pyx_object_dict_version_matches(((PyObject *)__pyx_v_self), __pyx_tp_dict_version, __pyx_obj_dict_version))) {
      PY_UINT64_T __pyx_type_dict_guard = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      #endif
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_compute_feature_importances);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)(void*)__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_19compute_feature_importances)) {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        __pyx_t_3 = __pyx_t_1; __pyx_t_4 = NULL;
        if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          }
        }
        __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_normalize) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_normalize);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1232, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_r = __pyx_t_2;
        __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L0;
      }
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
      __pyx_tp_dict_version = __Pyx_get_tp_dict_version(((PyObject *)__pyx_v_self));
      __pyx_obj_dict_version = __Pyx_get_object_dict_version(((PyObject *)__pyx_v_self));
      if (unlikely(__pyx_type_dict_guard != __pyx_tp_dict_version)) {
        __pyx_tp_dict_version = __pyx_obj_dict_version = __PYX_DICT_VERSION_INIT;
      }
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      #if CYTHON_USE_DICT_VERSIONS &amp;&amp; CYTHON_USE_PYTYPE_LOOKUP &amp;&amp; CYTHON_USE_TYPE_SLOTS
    }
    #endif
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.compute_feature_importances", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_importances);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_19compute_feature_importances(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_4Tree_18compute_feature_importances[] = "Computes the importance of each feature (aka variable).";
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_4Tree_19compute_feature_importances(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_normalize = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_feature_importances (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_normalize,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)Py_True);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_normalize);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "compute_feature_importances") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1232, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_normalize = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_feature_importances", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1232, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.compute_feature_importances", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_18compute_feature_importances(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_self), __pyx_v_normalize);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_4Tree_18compute_feature_importances(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self, PyObject *__pyx_v_normalize) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_feature_importances", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.normalize = __pyx_v_normalize;
  __pyx_t_1 = __pyx_vtabptr_13stpredictions_6models_3OK3_5_tree_Tree-&gt;compute_feature_importances(__pyx_v_self, 1, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree.compute_feature_importances", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1233</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Computes the importance of each feature (aka variable).&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1234</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">left</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1235</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">right</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1236</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span></pre>
<pre class='cython code score-0 '>  __pyx_t_5 = __pyx_v_self-&gt;nodes;
  __pyx_v_nodes = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1237</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">node</span> <span class="o">=</span> <span class="n">nodes</span></pre>
<pre class='cython code score-0 '>  __pyx_v_node = __pyx_v_nodes;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1238</span>:         <span class="k">cdef</span> <span class="kt">Node</span>* <span class="nf">end_node</span> <span class="o">=</span> <span class="n">node</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span></pre>
<pre class='cython code score-0 '>  __pyx_v_end_node = (__pyx_v_node + __pyx_v_self-&gt;node_count);
</pre><pre class="cython line score-0">&#xA0;<span class="">1239</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1240</span>:         <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">normalizer</span> <span class="o">=</span> <span class="mf">0.</span></pre>
<pre class='cython code score-0 '>  __pyx_v_normalizer = 0.;
</pre><pre class="cython line score-0">&#xA0;<span class="">1241</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1242</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span>[<span class="kt">np</span>.<span class="nf">float64_t</span><span class="p">,</span> <span class="nf">ndim</span><span class="o">=</span><span class="mf">1</span><span class="p">]</span> <span class="n">importances</span></pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1243</span>:         <span class="n">importances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features</span><span class="p">,))</span></pre>
<pre class='cython code score-48 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_self-&gt;n_features);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1243, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1243, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_importances, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      }
      __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
    }
    __pyx_pybuffernd_importances.diminfo[0].strides = __pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_importances.diminfo[0].shape = __pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1243, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  __pyx_v_importances = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1244</span>:         <span class="k">cdef</span> <span class="kt">DOUBLE_t</span>* <span class="nf">importance_data</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">DOUBLE_t</span><span class="o">*&gt;</span><span class="n">importances</span><span class="o">.</span><span class="n">data</span></pre>
<pre class='cython code score-0 '>  __pyx_v_importance_data = ((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *)__pyx_v_importances-&gt;data);
</pre><pre class="cython line score-0">&#xA0;<span class="">1245</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1246</span>:         <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1247</span>:             <span class="k">while</span> <span class="n">node</span> <span class="o">!=</span> <span class="n">end_node</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_11 = ((__pyx_v_node != __pyx_v_end_node) != 0);
          if (!__pyx_t_11) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1248</span>:                 <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">left_child</span> <span class="o">!=</span> <span class="n">_TREE_LEAF</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_11 = ((__pyx_v_node-&gt;left_child != __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF) != 0);
          if (__pyx_t_11) {
/* … */
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1249</span>:                     <span class="c"># ... and node.right_child != _TREE_LEAF:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1250</span>:                     <span class="n">left</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">left_child</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_left = (&amp;(__pyx_v_nodes[__pyx_v_node-&gt;left_child]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1251</span>:                     <span class="n">right</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">right_child</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_v_right = (&amp;(__pyx_v_nodes[__pyx_v_node-&gt;right_child]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1252</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1253</span>:                     <span class="n">importance_data</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">feature</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>            __pyx_t_12 = __pyx_v_node-&gt;feature;
/* … */
            (__pyx_v_importance_data[__pyx_t_12]) = ((__pyx_v_importance_data[__pyx_t_12]) + (((__pyx_v_node-&gt;weighted_n_node_samples * __pyx_v_node-&gt;impurity) - (__pyx_v_left-&gt;weighted_n_node_samples * __pyx_v_left-&gt;impurity)) - (__pyx_v_right-&gt;weighted_n_node_samples * __pyx_v_right-&gt;impurity)));
</pre><pre class="cython line score-0">&#xA0;<span class="">1254</span>:                         <span class="n">node</span><span class="o">.</span><span class="n">weighted_n_node_samples</span> <span class="o">*</span> <span class="n">node</span><span class="o">.</span><span class="n">impurity</span> <span class="o">-</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1255</span>:                         <span class="n">left</span><span class="o">.</span><span class="n">weighted_n_node_samples</span> <span class="o">*</span> <span class="n">left</span><span class="o">.</span><span class="n">impurity</span> <span class="o">-</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1256</span>:                         <span class="n">right</span><span class="o">.</span><span class="n">weighted_n_node_samples</span> <span class="o">*</span> <span class="n">right</span><span class="o">.</span><span class="n">impurity</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1257</span>:                 <span class="n">node</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_v_node = (__pyx_v_node + 1);
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1258</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1259</span>:         <span class="n">importances</span> <span class="o">/=</span> <span class="n">nodes</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="o">.</span><span class="n">weighted_n_node_samples</span></pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_nodes[0]).weighted_n_node_samples);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_InPlaceDivide</span>(((PyObject *)__pyx_v_importances), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1259, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_7 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_10, &amp;__pyx_t_9, &amp;__pyx_t_8);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_importances, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_8);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_10, __pyx_t_9, __pyx_t_8);
      }
      __pyx_t_10 = __pyx_t_9 = __pyx_t_8 = 0;
    }
    __pyx_pybuffernd_importances.diminfo[0].strides = __pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_importances.diminfo[0].shape = __pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1259, __pyx_L1_error)</span>
  }
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_importances, ((PyArrayObject *)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1260</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1261</span>:         <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span></pre>
<pre class='cython code score-2 '>  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_normalize); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1261, __pyx_L1_error)</span>
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1262</span>:             <span class="n">normalizer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">importances</span><span class="p">)</span></pre>
<pre class='cython code score-30 '>    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1262, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1262, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      }
    }
    __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, ((PyObject *)__pyx_v_importances)) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, ((PyObject *)__pyx_v_importances));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1262, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_13 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_13 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1262, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_normalizer = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">1263</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1264</span>:             <span class="k">if</span> <span class="n">normalizer</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_11 = ((__pyx_v_normalizer &gt; 0.0) != 0);
    if (__pyx_t_11) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1265</span>:                 <span class="c"># Avoid dividing by zero (e.g., when root is pure)</span></pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1266</span>:                 <span class="n">importances</span> <span class="o">/=</span> <span class="n">normalizer</span></pre>
<pre class='cython code score-29 '>      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_normalizer);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1266, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_InPlaceDivide</span>(((PyObject *)__pyx_v_importances), __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1266, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1266, __pyx_L1_error)</span>
      __pyx_t_6 = ((PyArrayObject *)__pyx_t_4);
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_7 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_8, &amp;__pyx_t_9, &amp;__pyx_t_10);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_importances, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_8); Py_XDECREF(__pyx_t_9); Py_XDECREF(__pyx_t_10);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
          }
          __pyx_t_8 = __pyx_t_9 = __pyx_t_10 = 0;
        }
        __pyx_pybuffernd_importances.diminfo[0].strides = __pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_importances.diminfo[0].shape = __pyx_pybuffernd_importances.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1266, __pyx_L1_error)</span>
      }
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_importances, ((PyArrayObject *)__pyx_t_4));
      __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1267</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1268</span>:         <span class="k">return</span> <span class="n">importances</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_importances));
  __pyx_r = ((PyObject *)__pyx_v_importances);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1269</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1270</span>:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">_get_value_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-4 '>static PyArrayObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__get_value_ndarray(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  npy_intp __pyx_v_shape[2];
  PyArrayObject *__pyx_v_arr = 0;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_get_value_ndarray", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree._get_value_ndarray", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_arr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1271</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Wraps value as a 2-d NumPy array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1272</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1273</span>: <span class="sd">        The array keeps a reference to this Tree, which manages the underlying</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1274</span>: <span class="sd">        memory.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1275</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1276</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">npy_intp</span> <span class="kt">shape</span>[2]</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1277</span>:         <span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">npy_intp</span><span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_shape[0]) = ((npy_intp)__pyx_v_self-&gt;node_count);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1278</span>:         <span class="n">shape</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">npy_intp</span><span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">K_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_shape[1]) = ((npy_intp)(__pyx_v_self-&gt;K_y-&gt;dimensions[0]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1279</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">arr</span></pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1280</span>:         <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">PyArray_SimpleNewFromData</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NPY_DOUBLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></pre>
<pre class='cython code score-7 '>  __pyx_t_1 = <span class='py_c_api'>PyArray_SimpleNewFromData</span>(2, __pyx_v_shape, NPY_DOUBLE, __pyx_v_self-&gt;value);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1280, __pyx_L1_error)</span>
  __pyx_v_arr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1281</span>:         <span class="n">Py_INCREF</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  Py_INCREF(((PyObject *)__pyx_v_self));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1282</span>:         <span class="k">if</span> <span class="n">PyArray_SetBaseObject</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">PyObject</span><span class="o">*&gt;</span> <span class="bp">self</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = ((<span class='py_c_api'>PyArray_SetBaseObject</span>(__pyx_v_arr, ((PyObject *)__pyx_v_self)) &lt; 0) != 0);
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1283</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Can&#39;t initialize array.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1283, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1283, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_Can_t_initialize_array);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 1283, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1284</span>:         <span class="k">return</span> <span class="n">arr</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_arr));
  __pyx_r = __pyx_v_arr;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1285</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1286</span>:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">_get_node_ndarray</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-5 '>static PyArrayObject *__pyx_f_13stpredictions_6models_3OK3_5_tree_4Tree__get_node_ndarray(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_self) {
  npy_intp __pyx_v_shape[1];
  npy_intp __pyx_v_strides[1];
  PyArrayObject *__pyx_v_arr = 0;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_get_node_ndarray", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.Tree._get_node_ndarray", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_arr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1287</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Wraps nodes as a NumPy struct array.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1288</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1289</span>: <span class="sd">        The array keeps a reference to this Tree, which manages the underlying</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1290</span>: <span class="sd">        memory. Individual fields are publicly accessible as properties of the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1291</span>: <span class="sd">        Tree.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1292</span>: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1293</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">npy_intp</span> <span class="kt">shape</span>[1]</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1294</span>:         <span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">npy_intp</span><span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_count</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_shape[0]) = ((npy_intp)__pyx_v_self-&gt;node_count);
</pre><pre class="cython line score-0">&#xA0;<span class="">1295</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">npy_intp</span> <span class="kt">strides</span>[1]</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1296</span>:         <span class="n">strides</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">Node</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  (__pyx_v_strides[0]) = (sizeof(struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node));
</pre><pre class="cython line score-0">&#xA0;<span class="">1297</span>:         <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">ndarray</span> <span class="nf">arr</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1298</span>:         <span class="n">Py_INCREF</span><span class="p">(</span><span class="n">NODE_DTYPE</span><span class="p">)</span></pre>
<pre class='cython code score-3 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_NODE_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1298, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  Py_INCREF(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1299</span>:         <span class="n">arr</span> <span class="o">=</span> <span class="n">PyArray_NewFromDescr</span><span class="p">(</span><span class="o">&lt;</span><span class="n">PyTypeObject</span> <span class="o">*&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span></pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='py_c_api'>PyArray_NewFromDescr</span>(((PyTypeObject *)__pyx_ptype_5numpy_ndarray), ((PyArray_Descr *)__pyx_t_1), 1, __pyx_v_shape, __pyx_v_strides, ((void *)__pyx_v_self-&gt;nodes), NPY_DEFAULT, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1299, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1299, __pyx_L1_error)</span>
  __pyx_v_arr = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1300</span>:                                    <span class="p">&lt;</span><span class="kt">np.dtype</span><span class="p">&gt;</span> <span class="n">NODE_DTYPE</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_NODE_DTYPE);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1301</span>:                                    <span class="n">strides</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">void</span><span class="o">*&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1302</span>:                                    <span class="n">np</span><span class="o">.</span><span class="n">NPY_DEFAULT</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1303</span>:         <span class="n">Py_INCREF</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  Py_INCREF(((PyObject *)__pyx_v_self));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1304</span>:         <span class="k">if</span> <span class="n">PyArray_SetBaseObject</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">PyObject</span><span class="o">*&gt;</span> <span class="bp">self</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-5 '>  __pyx_t_3 = ((<span class='py_c_api'>PyArray_SetBaseObject</span>(__pyx_v_arr, ((PyObject *)__pyx_v_self)) &lt; 0) != 0);
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1305</span>:             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Can&#39;t initialize array.&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1305, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1305, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1306</span>:         <span class="k">return</span> <span class="n">arr</span></pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_arr));
  __pyx_r = __pyx_v_arr;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1307</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1308</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1309</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1310</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1311</span>: <span class="c"># =============================================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1312</span>: <span class="c"># Build Pruned Tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1313</span>: <span class="c"># =============================================================================</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1314</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1315</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1316</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">_CCPPruneController</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController {
  PyObject_HEAD
  struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__CCPPruneController *__pyx_vtab;
};
/* … */
struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__CCPPruneController {
  int (*stop_pruning)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController *, __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t);
  void (*save_metrics)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController *, __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t, __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t);
  void (*after_pruning)(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController *, __Pyx_memviewslice);
};
static struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__CCPPruneController *__pyx_vtabptr_13stpredictions_6models_3OK3_5_tree__CCPPruneController;

</pre><pre class="cython line score-0">&#xA0;<span class="">1317</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class used by build_pruned_tree_ccp and ccp_pruning_path</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1318</span>: <span class="sd">    to control pruning.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1319</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1320</span>:     <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">stop_pruning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DOUBLE_t</span> <span class="n">effective_alpha</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_13stpredictions_6models_3OK3_5_tree_19_CCPPruneController_stop_pruning(CYTHON_UNUSED struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController *__pyx_v_self, CYTHON_UNUSED __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_effective_alpha) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1321</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Return 1 to stop pruning and 0 to continue pruning&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1322</span>:         <span class="k">return</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1323</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1324</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">save_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DOUBLE_t</span> <span class="n">effective_alpha</span><span class="p">,</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_13stpredictions_6models_3OK3_5_tree_19_CCPPruneController_save_metrics(CYTHON_UNUSED struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController *__pyx_v_self, CYTHON_UNUSED __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_effective_alpha, CYTHON_UNUSED __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_subtree_impurities) {

  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1325</span>:                            <span class="n">DOUBLE_t</span> <span class="n">subtree_impurities</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1326</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Save metrics when pruning&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1327</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1328</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1329</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">after_pruning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="n">char</span><span class="p">[:]</span> <span class="n">in_subtree</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_13stpredictions_6models_3OK3_5_tree_19_CCPPruneController_after_pruning(CYTHON_UNUSED struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController *__pyx_v_self, CYTHON_UNUSED __Pyx_memviewslice __pyx_v_in_subtree) {

  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1330</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Called after pruning&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1331</span>:         <span class="k">pass</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1332</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1333</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1334</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">_AlphaPruner</span><span class="p">(</span><span class="n">_CCPPruneController</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__AlphaPruner {
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController __pyx_base;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t ccp_alpha;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t capacity;
};
/* … */
struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__AlphaPruner {
  struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__CCPPruneController __pyx_base;
};
static struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__AlphaPruner *__pyx_vtabptr_13stpredictions_6models_3OK3_5_tree__AlphaPruner;

</pre><pre class="cython line score-0">&#xA0;<span class="">1335</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Use alpha to control when to stop pruning.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1336</span>:     <span class="k">cdef</span> <span class="kt">DOUBLE_t</span> <span class="nf">ccp_alpha</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1337</span>:     <span class="k">cdef</span> <span class="kt">SIZE_t</span> <span class="nf">capacity</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1338</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1339</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DOUBLE_t</span> <span class="n">ccp_alpha</span><span class="p">):</span></pre>
<pre class='cython code score-28 '>/* Python wrapper */
static int __pyx_pw_13stpredictions_6models_3OK3_5_tree_12_AlphaPruner_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_13stpredictions_6models_3OK3_5_tree_12_AlphaPruner_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_ccp_alpha;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ccp_alpha,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ccp_alpha)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1339, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_ccp_alpha = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_ccp_alpha == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1339, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1339, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree._AlphaPruner.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_12_AlphaPruner___cinit__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__AlphaPruner *)__pyx_v_self), __pyx_v_ccp_alpha);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_13stpredictions_6models_3OK3_5_tree_12_AlphaPruner___cinit__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__AlphaPruner *__pyx_v_self, __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_ccp_alpha) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1340</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ccp_alpha</span> <span class="o">=</span> <span class="n">ccp_alpha</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;ccp_alpha = __pyx_v_ccp_alpha;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1341</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;capacity = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1342</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1343</span>:     <span class="k">cdef</span> <span class="kt">bint</span> <span class="nf">stop_pruning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">DOUBLE_t</span> <span class="n">effective_alpha</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static int __pyx_f_13stpredictions_6models_3OK3_5_tree_12_AlphaPruner_stop_pruning(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__AlphaPruner *__pyx_v_self, __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_effective_alpha) {
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1344</span>:         <span class="c"># The subtree on the previous iteration has the greatest ccp_alpha</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1345</span>:         <span class="c"># less than or equal to self.ccp_alpha</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1346</span>:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ccp_alpha</span> <span class="o">&lt;</span> <span class="n">effective_alpha</span></pre>
<pre class='cython code score-0 '>  __pyx_r = (__pyx_v_self-&gt;ccp_alpha &lt; __pyx_v_effective_alpha);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1347</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1348</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">after_pruning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">unsigned</span> <span class="n">char</span><span class="p">[:]</span> <span class="n">in_subtree</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>static void __pyx_f_13stpredictions_6models_3OK3_5_tree_12_AlphaPruner_after_pruning(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__AlphaPruner *__pyx_v_self, __Pyx_memviewslice __pyx_v_in_subtree) {
  Py_ssize_t __pyx_v_i;
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1349</span>: <span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates the number of leaves in subtree&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1350</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">in_subtree</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_in_subtree.shape[0]);
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1351</span>:             <span class="k">if</span> <span class="n">in_subtree</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = ((*((unsigned char *) ( /* dim=0 */ (__pyx_v_in_subtree.data + __pyx_t_4 * __pyx_v_in_subtree.strides[0]) ))) != 0);
    if (__pyx_t_5) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1352</span>:                 <span class="bp">self</span><span class="o">.</span><span class="n">capacity</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>      __pyx_v_self-&gt;capacity = (__pyx_v_self-&gt;capacity + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1353</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1354</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1355</span>: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">_PathFinder</span><span class="p">(</span><span class="n">_CCPPruneController</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__PathFinder {
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController __pyx_base;
  __Pyx_memviewslice ccp_alphas;
  __Pyx_memviewslice impurities;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_UINT32_t count;
};
/* … */
struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__PathFinder {
  struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__CCPPruneController __pyx_base;
};
static struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__PathFinder *__pyx_vtabptr_13stpredictions_6models_3OK3_5_tree__PathFinder;

</pre><pre class="cython line score-0">&#xA0;<span class="">1356</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Record metrics used to return the cost complexity path.&quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1357</span>:     <span class="k">cdef</span> <span class="kt">DOUBLE_t</span>[<span class="p">:]</span> <span class="n">ccp_alphas</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1358</span>:     <span class="k">cdef</span> <span class="kt">DOUBLE_t</span>[<span class="p">:]</span> <span class="n">impurities</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1359</span>:     <span class="k">cdef</span> <span class="kt">UINT32_t</span> <span class="nf">count</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1360</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1361</span>:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="nb">int</span> <span class="n">node_count</span><span class="p">):</span></pre>
<pre class='cython code score-31 '>/* Python wrapper */
static int __pyx_pw_13stpredictions_6models_3OK3_5_tree_11_PathFinder_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_13stpredictions_6models_3OK3_5_tree_11_PathFinder_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_node_count;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_node_count,0};
    PyObject* values[1] = {0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_node_count)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1361, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 1) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
    }
    __pyx_v_node_count = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_node_count == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1361, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 1, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1361, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree._PathFinder.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_11_PathFinder___cinit__(((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__PathFinder *)__pyx_v_self), __pyx_v_node_count);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_13stpredictions_6models_3OK3_5_tree_11_PathFinder___cinit__(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__PathFinder *__pyx_v_self, int __pyx_v_node_count) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree._PathFinder.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1362</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ccp_alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">node_count</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_node_count);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_shape, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1362, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1362, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1362, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;ccp_alphas, 0);
  __pyx_v_self-&gt;ccp_alphas = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1363</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">impurities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">node_count</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_node_count);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_shape, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1363, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1363, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t(__pyx_t_3, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1363, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_self-&gt;impurities, 0);
  __pyx_v_self-&gt;impurities = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1364</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;count = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1365</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1366</span>:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">save_metrics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span></pre>
<pre class='cython code score-2 '>static void __pyx_f_13stpredictions_6models_3OK3_5_tree_11_PathFinder_save_metrics(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__PathFinder *__pyx_v_self, __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_effective_alpha, __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_subtree_impurities) {
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("stpredictions.models.OK3._tree._PathFinder.save_metrics", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 1);
  __pyx_L0:;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1367</span>:                            <span class="n">DOUBLE_t</span> <span class="n">effective_alpha</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1368</span>:                            <span class="n">DOUBLE_t</span> <span class="n">subtree_impurities</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1369</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">ccp_alphas</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">effective_alpha</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;ccp_alphas.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1369, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_v_self-&gt;count;
  *((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_self-&gt;ccp_alphas.data + __pyx_t_1 * __pyx_v_self-&gt;ccp_alphas.strides[0]) )) = __pyx_v_effective_alpha;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1370</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">impurities</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">subtree_impurities</span></pre>
<pre class='cython code score-5 '>  if (unlikely(!__pyx_v_self-&gt;impurities.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1370, __pyx_L1_error)</span>}
  __pyx_t_1 = __pyx_v_self-&gt;count;
  *((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_self-&gt;impurities.data + __pyx_t_1 * __pyx_v_self-&gt;impurities.strides[0]) )) = __pyx_v_subtree_impurities;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1371</span>:         <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;count = (__pyx_v_self-&gt;count + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">1372</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1373</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1374</span>: <span class="k">cdef</span> <span class="nf">_cost_complexity_prune</span><span class="p">(</span><span class="nb">unsigned</span> <span class="n">char</span><span class="p">[:]</span> <span class="n">leaves_in_subtree</span><span class="p">,</span> <span class="c"># OUT</span></pre>
<pre class='cython code score-8 '>static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree__cost_complexity_prune(__Pyx_memviewslice __pyx_v_leaves_in_subtree, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_orig_tree, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController *__pyx_v_controller) {
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_i;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_nodes;
  __Pyx_memviewslice __pyx_v_weighted_n_node_samples = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_total_sum_weights;
  __Pyx_memviewslice __pyx_v_impurity = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r_node = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_child_l = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_child_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_parent = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_7sklearn_4tree_6_utils_Stack *__pyx_v_stack = 0;
  struct __pyx_t_7sklearn_4tree_6_utils_StackRecord __pyx_v_stack_record;
  int __pyx_v_rc;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_node_idx;
  __Pyx_memviewslice __pyx_v_n_leaves = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_r_branch = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_current_r;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_leaf_idx;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_parent_idx;
  __Pyx_memviewslice __pyx_v_candidate_nodes = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_in_subtree = { 0, 0, { 0 }, { 0 }, { 0 } };
  CYTHON_UNUSED __Pyx_memviewslice __pyx_v_g_node = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_pruned_branch_node_idx;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_subtree_alpha;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_effective_alpha;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_pruned_leaves;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_r_diff;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_max_float64;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cost_complexity_prune", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_3, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_8, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_9, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree._cost_complexity_prune", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_weighted_n_node_samples, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_impurity, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_node, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_child_l, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_child_r, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_parent, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_stack);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_n_leaves, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_r_branch, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_candidate_nodes, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_in_subtree, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_g_node, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1375</span>:                             <span class="n">Tree</span> <span class="n">orig_tree</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1376</span>:                             <span class="n">_CCPPruneController</span> <span class="n">controller</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1377</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform cost complexity pruning.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1378</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1379</span>: <span class="sd">    This function takes an already grown tree, `orig_tree` and outputs a</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1380</span>: <span class="sd">    boolean mask `leaves_in_subtree` to are the leaves in the pruned tree. The</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1381</span>: <span class="sd">    controller signals when the pruning should stop and is passed the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1382</span>: <span class="sd">    metrics of the subtrees during the pruning process.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1383</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1384</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1385</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1386</span>: <span class="sd">    leaves_in_subtree : unsigned char[:]</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1387</span>: <span class="sd">        Output for leaves of subtree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1388</span>: <span class="sd">    orig_tree : Tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1389</span>: <span class="sd">        Original tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1390</span>: <span class="sd">    ccp_controller : _CCPPruneController</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1391</span>: <span class="sd">        Cost complexity controller</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1392</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1393</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1394</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1395</span>:         <span class="n">SIZE_t</span> <span class="n">i</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1396</span>:         <span class="n">SIZE_t</span> <span class="n">n_nodes</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="o">.</span><span class="n">node_count</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_orig_tree-&gt;node_count;
  __pyx_v_n_nodes = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1397</span>:         <span class="c"># prior probability using weighted samples</span></pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1398</span>:         <span class="n">DOUBLE_t</span><span class="p">[:]</span> <span class="n">weighted_n_node_samples</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="o">.</span><span class="n">weighted_n_node_samples</span></pre>
<pre class='cython code score-3 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_orig_tree), __pyx_n_s_weighted_n_node_samples);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1398, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1398, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_weighted_n_node_samples = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1399</span>:         <span class="n">DOUBLE_t</span> <span class="n">total_sum_weights</span> <span class="o">=</span> <span class="n">weighted_n_node_samples</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_total_sum_weights = (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_weighted_n_node_samples.data + __pyx_t_4 * __pyx_v_weighted_n_node_samples.strides[0]) )));
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1400</span>:         <span class="n">DOUBLE_t</span><span class="p">[:]</span> <span class="n">impurity</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="o">.</span><span class="n">impurity</span></pre>
<pre class='cython code score-3 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_orig_tree), __pyx_n_s_impurity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1400, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1400, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_impurity = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1401</span>:         <span class="c"># weighted impurity of each node</span></pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1402</span>:         <span class="n">DOUBLE_t</span><span class="p">[:]</span> <span class="n">r_node</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_nodes);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_shape, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1402, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1402, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t(__pyx_t_7, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1402, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_r_node = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1403</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1404</span>:         <span class="n">SIZE_t</span><span class="p">[:]</span> <span class="n">child_l</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="o">.</span><span class="n">children_left</span></pre>
<pre class='cython code score-3 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_orig_tree), __pyx_n_s_children_left);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1404, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t(__pyx_t_7, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1404, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_child_l = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1405</span>:         <span class="n">SIZE_t</span><span class="p">[:]</span> <span class="n">child_r</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="o">.</span><span class="n">children_right</span></pre>
<pre class='cython code score-3 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_orig_tree), __pyx_n_s_children_right);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1405, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t(__pyx_t_7, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1405, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_child_r = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1406</span>:         <span class="n">SIZE_t</span><span class="p">[:]</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_nodes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_shape, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1406, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1406, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1406, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_parent = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1407</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1408</span>:         <span class="c"># Only uses the start and parent variables</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1409</span>:         <span class="n">Stack</span> <span class="n">stack</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">(</span><span class="n">INITIAL_STACK_SIZE</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_13stpredictions_6models_3OK3_5_tree_INITIAL_STACK_SIZE);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1409, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7sklearn_4tree_6_utils_Stack), __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1409, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_stack = ((struct __pyx_obj_7sklearn_4tree_6_utils_Stack *)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1410</span>:         <span class="n">StackRecord</span> <span class="n">stack_record</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1411</span>:         <span class="nb">int</span> <span class="n">rc</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rc = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1412</span>:         <span class="n">SIZE_t</span> <span class="n">node_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1413</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1414</span>:         <span class="n">SIZE_t</span><span class="p">[:]</span> <span class="n">n_leaves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1414, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1414, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1414, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_nodes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1414, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_shape, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1414, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1414, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_intp);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1414, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1414, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_empty_tuple, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1414, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 1414, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_n_leaves = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1415</span>:         <span class="n">DOUBLE_t</span><span class="p">[:]</span> <span class="n">r_branch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_nodes);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_shape, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1415, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1415, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_empty_tuple, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1415, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t(__pyx_t_2, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1415, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_r_branch = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1416</span>:         <span class="n">DOUBLE_t</span> <span class="n">current_r</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1417</span>:         <span class="n">SIZE_t</span> <span class="n">leaf_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1418</span>:         <span class="n">SIZE_t</span> <span class="n">parent_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1419</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1420</span>:         <span class="c"># candidate nodes that can be pruned</span></pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1421</span>:         <span class="nb">unsigned</span> <span class="n">char</span><span class="p">[:]</span> <span class="n">candidate_nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">,</span></pre>
<pre class='cython code score-22 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1421, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1421, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1421, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_nodes);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1421, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_shape, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1421, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/* … */
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1421, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_char</span>(__pyx_t_6, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1421, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_candidate_nodes = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1422</span>:                                                     <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1422, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1422, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1421, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1423</span>:         <span class="c"># nodes in subtree</span></pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1424</span>:         <span class="nb">unsigned</span> <span class="n">char</span><span class="p">[:]</span> <span class="n">in_subtree</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span></pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_nodes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_shape, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1424, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1424, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_char</span>(__pyx_t_7, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1424, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_in_subtree = __pyx_t_9;
  __pyx_t_9.memview = NULL;
  __pyx_t_9.data = NULL;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1425</span>:         <span class="n">DOUBLE_t</span><span class="p">[:]</span> <span class="n">g_node</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1425, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1425, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1425, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_nodes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1425, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_shape, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1425, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1425, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1425, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1425, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_empty_tuple, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1425, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_3 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_3.memview)) __PYX_ERR(0, 1425, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_g_node = __pyx_t_3;
  __pyx_t_3.memview = NULL;
  __pyx_t_3.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">1426</span>:         <span class="n">SIZE_t</span> <span class="n">pruned_branch_node_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1427</span>:         <span class="n">DOUBLE_t</span> <span class="n">subtree_alpha</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1428</span>:         <span class="n">DOUBLE_t</span> <span class="n">effective_alpha</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1429</span>:         <span class="n">SIZE_t</span> <span class="n">child_l_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1430</span>:         <span class="n">SIZE_t</span> <span class="n">child_r_idx</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1431</span>:         <span class="n">SIZE_t</span> <span class="n">n_pruned_leaves</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1432</span>:         <span class="n">DOUBLE_t</span> <span class="n">r_diff</span></pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1433</span>:         <span class="n">DOUBLE_t</span> <span class="n">max_float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">max</span></pre>
<pre class='cython code score-39 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_finfo);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_5 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1433, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_6); if (unlikely((__pyx_t_10 == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1433, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_max_float64 = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">1434</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1435</span>:     <span class="c"># find parent node ids and leaves</span></pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1436</span>:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-6 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L4_error: {
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L1_error;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1437</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1438</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r_node</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_11 = (__pyx_v_r_node.shape[0]);
        __pyx_t_12 = __pyx_t_11;
        for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_12; __pyx_t_1+=1) {
          __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1439</span>:             <span class="n">r_node</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_i;
          *((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_node.data + __pyx_t_14 * __pyx_v_r_node.strides[0]) )) = (((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_weighted_n_node_samples.data + __pyx_t_4 * __pyx_v_weighted_n_node_samples.strides[0]) ))) * (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_impurity.data + __pyx_t_13 * __pyx_v_impurity.strides[0]) )))) / __pyx_v_total_sum_weights);
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1440</span>:                 <span class="n">weighted_n_node_samples</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">impurity</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_sum_weights</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_t_4 = __pyx_v_i;
          __pyx_t_13 = __pyx_v_i;
</pre><pre class="cython line score-0">&#xA0;<span class="">1441</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1442</span>:         <span class="c"># Push root node, using StackRecord.start as node id</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1443</span>:         <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_t_15 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, 0, 0, 0, -1, 0, 0.0, 0);<span class='error_goto'> if (unlikely(__pyx_t_15 == ((int)-1))) __PYX_ERR(0, 1443, __pyx_L4_error)</span>
        __pyx_v_rc = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1444</span>:         <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_16 = ((__pyx_v_rc == -1L) != 0);
        if (__pyx_t_16) {
/* … */
        }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1445</span>:             <span class="k">with</span> <span class="k">gil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>          {
              #ifdef WITH_THREAD
              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
              #endif
              /*try:*/ {
/* … */
              /*finally:*/ {
                __pyx_L10_error: {
                  #ifdef WITH_THREAD
                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                  #endif
                  goto __pyx_L4_error;
                }
              }
          }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1446</span>:                 <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">(</span><span class="s">&quot;pruning tree&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-10 '>                __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1446, __pyx_L10_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
                <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                <span class='error_goto'>__PYX_ERR(0, 1446, __pyx_L10_error)</span>
              }
/* … */
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_s_pruning_tree);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 1446, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
</pre><pre class="cython line score-0">&#xA0;<span class="">1447</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1448</span>:         <span class="k">while</span> <span class="ow">not</span> <span class="n">stack</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_16 = ((!(((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;is_empty(__pyx_v_stack) != 0)) != 0);
          if (!__pyx_t_16) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1449</span>:             <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stack_record</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          (void)(((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;pop(__pyx_v_stack, (&amp;__pyx_v_stack_record)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1450</span>:             <span class="n">node_idx</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">start</span></pre>
<pre class='cython code score-0 '>          __pyx_t_17 = __pyx_v_stack_record.start;
          __pyx_v_node_idx = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1451</span>:             <span class="n">parent</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">parent</span></pre>
<pre class='cython code score-0 '>          __pyx_t_17 = __pyx_v_stack_record.parent;
          __pyx_t_13 = __pyx_v_node_idx;
          *((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_parent.data + __pyx_t_13 * __pyx_v_parent.strides[0]) )) = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1452</span>:             <span class="k">if</span> <span class="n">child_l</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">_TREE_LEAF</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_13 = __pyx_v_node_idx;
          __pyx_t_16 = (((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_child_l.data + __pyx_t_13 * __pyx_v_child_l.strides[0]) ))) == __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF) != 0);
          if (__pyx_t_16) {
/* … */
            goto __pyx_L14;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1453</span>:                 <span class="c"># ... and child_r[node_idx] == _TREE_LEAF:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1454</span>:                 <span class="n">leaves_in_subtree</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = __pyx_v_node_idx;
            *((unsigned char *) ( /* dim=0 */ (__pyx_v_leaves_in_subtree.data + __pyx_t_13 * __pyx_v_leaves_in_subtree.strides[0]) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1455</span>:             <span class="k">else</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1456</span>:                 <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">child_l</span><span class="p">[</span><span class="n">node_idx</span><span class="p">],</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">node_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_t_13 = __pyx_v_node_idx;
            __pyx_t_15 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_child_l.data + __pyx_t_13 * __pyx_v_child_l.strides[0]) ))), 0, 0, __pyx_v_node_idx, 0, 0.0, 0);<span class='error_goto'> if (unlikely(__pyx_t_15 == ((int)-1))) __PYX_ERR(0, 1456, __pyx_L4_error)</span>
            __pyx_v_rc = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1457</span>:                 <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_16 = ((__pyx_v_rc == -1L) != 0);
            if (__pyx_t_16) {
/* … */
            }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1458</span>:                     <span class="k">with</span> <span class="k">gil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>              {
                  #ifdef WITH_THREAD
                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                  #endif
                  /*try:*/ {
/* … */
                  /*finally:*/ {
                    __pyx_L19_error: {
                      #ifdef WITH_THREAD
                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                      #endif
                      goto __pyx_L4_error;
                    }
                  }
              }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1459</span>:                         <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">(</span><span class="s">&quot;pruning tree&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>                    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1459, __pyx_L19_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
                    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                    <span class='error_goto'>__PYX_ERR(0, 1459, __pyx_L19_error)</span>
                  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1460</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1461</span>:                 <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">child_r</span><span class="p">[</span><span class="n">node_idx</span><span class="p">],</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">node_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = __pyx_v_node_idx;
            __pyx_t_15 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_child_r.data + __pyx_t_13 * __pyx_v_child_r.strides[0]) ))), 0, 0, __pyx_v_node_idx, 0, 0.0, 0);<span class='error_goto'> if (unlikely(__pyx_t_15 == ((int)-1))) __PYX_ERR(0, 1461, __pyx_L4_error)</span>
            __pyx_v_rc = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1462</span>:                 <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_16 = ((__pyx_v_rc == -1L) != 0);
            if (__pyx_t_16) {
/* … */
            }
          }
          __pyx_L14:;
        }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1463</span>:                     <span class="k">with</span> <span class="k">gil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>              {
                  #ifdef WITH_THREAD
                  PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                  #endif
                  /*try:*/ {
/* … */
                  /*finally:*/ {
                    __pyx_L25_error: {
                      #ifdef WITH_THREAD
                      <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                      #endif
                      goto __pyx_L4_error;
                    }
                  }
              }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1464</span>:                         <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">(</span><span class="s">&quot;pruning tree&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>                    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1464, __pyx_L25_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
                    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                    <span class='error_goto'>__PYX_ERR(0, 1464, __pyx_L25_error)</span>
                  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1465</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1466</span>:         <span class="c"># computes number of leaves in all branches and the overall impurity of</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1467</span>:         <span class="c"># the branch. The overall impurity is the sum of r_node in its leaves.</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1468</span>:         <span class="k">for</span> <span class="n">leaf_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">leaves_in_subtree</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_11 = (__pyx_v_leaves_in_subtree.shape[0]);
        __pyx_t_12 = __pyx_t_11;
        for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_12; __pyx_t_1+=1) {
          __pyx_v_leaf_idx = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1469</span>:             <span class="k">if</span> <span class="ow">not</span> <span class="n">leaves_in_subtree</span><span class="p">[</span><span class="n">leaf_idx</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_13 = __pyx_v_leaf_idx;
          __pyx_t_16 = ((!((*((unsigned char *) ( /* dim=0 */ (__pyx_v_leaves_in_subtree.data + __pyx_t_13 * __pyx_v_leaves_in_subtree.strides[0]) ))) != 0)) != 0);
          if (__pyx_t_16) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1470</span>:                 <span class="k">continue</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L27_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1471</span>:             <span class="n">r_branch</span><span class="p">[</span><span class="n">leaf_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_node</span><span class="p">[</span><span class="n">leaf_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_t_13 = __pyx_v_leaf_idx;
          __pyx_t_4 = __pyx_v_leaf_idx;
          *((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_branch.data + __pyx_t_4 * __pyx_v_r_branch.strides[0]) )) = (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_node.data + __pyx_t_13 * __pyx_v_r_node.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1472</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1473</span>:             <span class="c"># bubble up values to ancestor nodes</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1474</span>:             <span class="n">current_r</span> <span class="o">=</span> <span class="n">r_node</span><span class="p">[</span><span class="n">leaf_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_t_13 = __pyx_v_leaf_idx;
          __pyx_v_current_r = (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_node.data + __pyx_t_13 * __pyx_v_r_node.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1475</span>:             <span class="k">while</span> <span class="n">leaf_idx</span> <span class="o">!=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          while (1) {
            __pyx_t_16 = ((__pyx_v_leaf_idx != 0) != 0);
            if (!__pyx_t_16) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1476</span>:                 <span class="n">parent_idx</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">leaf_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = __pyx_v_leaf_idx;
            __pyx_v_parent_idx = (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_parent.data + __pyx_t_13 * __pyx_v_parent.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1477</span>:                 <span class="n">r_branch</span><span class="p">[</span><span class="n">parent_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">current_r</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = __pyx_v_parent_idx;
            *((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_branch.data + __pyx_t_13 * __pyx_v_r_branch.strides[0]) )) += __pyx_v_current_r;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1478</span>:                 <span class="n">n_leaves</span><span class="p">[</span><span class="n">parent_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = __pyx_v_parent_idx;
            *((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_n_leaves.data + __pyx_t_13 * __pyx_v_n_leaves.strides[0]) )) += 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1479</span>:                 <span class="n">leaf_idx</span> <span class="o">=</span> <span class="n">parent_idx</span></pre>
<pre class='cython code score-0 '>            __pyx_v_leaf_idx = __pyx_v_parent_idx;
          }
          __pyx_L27_continue:;
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1480</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1481</span>:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">leaves_in_subtree</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]):</span></pre>
<pre class='cython code score-0 '>        __pyx_t_11 = (__pyx_v_leaves_in_subtree.shape[0]);
        __pyx_t_12 = __pyx_t_11;
        for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_12; __pyx_t_1+=1) {
          __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1482</span>:             <span class="n">candidate_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">leaves_in_subtree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_t_13 = __pyx_v_i;
          __pyx_t_4 = __pyx_v_i;
          *((unsigned char *) ( /* dim=0 */ (__pyx_v_candidate_nodes.data + __pyx_t_4 * __pyx_v_candidate_nodes.strides[0]) )) = (!((*((unsigned char *) ( /* dim=0 */ (__pyx_v_leaves_in_subtree.data + __pyx_t_13 * __pyx_v_leaves_in_subtree.strides[0]) ))) != 0));
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1483</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1484</span>:         <span class="c"># save metrics before pruning</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1485</span>:         <span class="n">controller</span><span class="o">.</span><span class="n">save_metrics</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">r_branch</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>        __pyx_t_13 = 0;
        ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__CCPPruneController *)__pyx_v_controller-&gt;__pyx_vtab)-&gt;save_metrics(__pyx_v_controller, 0.0, (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_branch.data + __pyx_t_13 * __pyx_v_r_branch.strides[0]) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1486</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1487</span>:         <span class="c"># while root node is not a leaf</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1488</span>:         <span class="k">while</span> <span class="n">candidate_nodes</span><span class="p">[</span><span class="mf">0</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_13 = 0;
          __pyx_t_16 = ((*((unsigned char *) ( /* dim=0 */ (__pyx_v_candidate_nodes.data + __pyx_t_13 * __pyx_v_candidate_nodes.strides[0]) ))) != 0);
          if (!__pyx_t_16) break;
</pre><pre class="cython line score-0">&#xA0;<span class="">1489</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1490</span>:             <span class="c"># computes ccp_alpha for subtrees and finds the minimal alpha</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1491</span>:             <span class="n">effective_alpha</span> <span class="o">=</span> <span class="n">max_float64</span></pre>
<pre class='cython code score-0 '>          __pyx_v_effective_alpha = __pyx_v_max_float64;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1492</span>:             <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_nodes</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_1 = __pyx_v_n_nodes;
          __pyx_t_18 = __pyx_t_1;
          for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
            __pyx_v_i = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1493</span>:                 <span class="k">if</span> <span class="ow">not</span> <span class="n">candidate_nodes</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = __pyx_v_i;
            __pyx_t_16 = ((!((*((unsigned char *) ( /* dim=0 */ (__pyx_v_candidate_nodes.data + __pyx_t_13 * __pyx_v_candidate_nodes.strides[0]) ))) != 0)) != 0);
            if (__pyx_t_16) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1494</span>:                     <span class="k">continue</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L36_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1495</span>:                 <span class="n">subtree_alpha</span> <span class="o">=</span> <span class="p">(</span><span class="n">r_node</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_branch</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">n_leaves</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            __pyx_t_13 = __pyx_v_i;
            __pyx_t_4 = __pyx_v_i;
            __pyx_t_14 = __pyx_v_i;
            __pyx_v_subtree_alpha = (((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_node.data + __pyx_t_13 * __pyx_v_r_node.strides[0]) ))) - (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_branch.data + __pyx_t_4 * __pyx_v_r_branch.strides[0]) )))) / ((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_n_leaves.data + __pyx_t_14 * __pyx_v_n_leaves.strides[0]) ))) - 1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1496</span>:                 <span class="k">if</span> <span class="n">subtree_alpha</span> <span class="o">&lt;</span> <span class="n">effective_alpha</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_16 = ((__pyx_v_subtree_alpha &lt; __pyx_v_effective_alpha) != 0);
            if (__pyx_t_16) {
/* … */
            }
            __pyx_L36_continue:;
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1497</span>:                     <span class="n">effective_alpha</span> <span class="o">=</span> <span class="n">subtree_alpha</span></pre>
<pre class='cython code score-0 '>              __pyx_v_effective_alpha = __pyx_v_subtree_alpha;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1498</span>:                     <span class="n">pruned_branch_node_idx</span> <span class="o">=</span> <span class="n">i</span></pre>
<pre class='cython code score-0 '>              __pyx_v_pruned_branch_node_idx = __pyx_v_i;
</pre><pre class="cython line score-0">&#xA0;<span class="">1499</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1500</span>:             <span class="k">if</span> <span class="n">controller</span><span class="o">.</span><span class="n">stop_pruning</span><span class="p">(</span><span class="n">effective_alpha</span><span class="p">):</span></pre>
<pre class='cython code score-0 '>          __pyx_t_16 = (((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__CCPPruneController *)__pyx_v_controller-&gt;__pyx_vtab)-&gt;stop_pruning(__pyx_v_controller, __pyx_v_effective_alpha) != 0);
          if (__pyx_t_16) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1501</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L35_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">1502</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1503</span>:             <span class="c"># stack uses only the start variable</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1504</span>:             <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">pruned_branch_node_idx</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          __pyx_t_15 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, __pyx_v_pruned_branch_node_idx, 0, 0, 0, 0, 0.0, 0);<span class='error_goto'> if (unlikely(__pyx_t_15 == ((int)-1))) __PYX_ERR(0, 1504, __pyx_L4_error)</span>
          __pyx_v_rc = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1505</span>:             <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_16 = ((__pyx_v_rc == -1L) != 0);
          if (__pyx_t_16) {
/* … */
          }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1506</span>:                 <span class="k">with</span> <span class="k">gil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>            {
                #ifdef WITH_THREAD
                PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                #endif
                /*try:*/ {
/* … */
                /*finally:*/ {
                  __pyx_L45_error: {
                    #ifdef WITH_THREAD
                    <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                    #endif
                    goto __pyx_L4_error;
                  }
                }
            }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1507</span>:                     <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">(</span><span class="s">&quot;pruning tree&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>                  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1507, __pyx_L45_error)</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
                  <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                  <span class='error_goto'>__PYX_ERR(0, 1507, __pyx_L45_error)</span>
                }
</pre><pre class="cython line score-0">&#xA0;<span class="">1508</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1509</span>:             <span class="c"># descendants of branch are not in subtree</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1510</span>:             <span class="k">while</span> <span class="ow">not</span> <span class="n">stack</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>          while (1) {
            __pyx_t_16 = ((!(((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;is_empty(__pyx_v_stack) != 0)) != 0);
            if (!__pyx_t_16) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1511</span>:                 <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stack_record</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>            (void)(((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;pop(__pyx_v_stack, (&amp;__pyx_v_stack_record)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1512</span>:                 <span class="n">node_idx</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">start</span></pre>
<pre class='cython code score-0 '>            __pyx_t_17 = __pyx_v_stack_record.start;
            __pyx_v_node_idx = __pyx_t_17;
</pre><pre class="cython line score-0">&#xA0;<span class="">1513</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1514</span>:                 <span class="k">if</span> <span class="ow">not</span> <span class="n">in_subtree</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = __pyx_v_node_idx;
            __pyx_t_16 = ((!((*((unsigned char *) ( /* dim=0 */ (__pyx_v_in_subtree.data + __pyx_t_14 * __pyx_v_in_subtree.strides[0]) ))) != 0)) != 0);
            if (__pyx_t_16) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1515</span>:                     <span class="k">continue</span> <span class="c"># branch has already been marked for pruning</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L47_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1516</span>:                 <span class="n">candidate_nodes</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = __pyx_v_node_idx;
            *((unsigned char *) ( /* dim=0 */ (__pyx_v_candidate_nodes.data + __pyx_t_14 * __pyx_v_candidate_nodes.strides[0]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1517</span>:                 <span class="n">leaves_in_subtree</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = __pyx_v_node_idx;
            *((unsigned char *) ( /* dim=0 */ (__pyx_v_leaves_in_subtree.data + __pyx_t_14 * __pyx_v_leaves_in_subtree.strides[0]) )) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1518</span>:                 <span class="n">in_subtree</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = __pyx_v_node_idx;
            *((unsigned char *) ( /* dim=0 */ (__pyx_v_in_subtree.data + __pyx_t_14 * __pyx_v_in_subtree.strides[0]) )) = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1519</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1520</span>:                 <span class="k">if</span> <span class="n">child_l</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span> <span class="o">!=</span> <span class="n">_TREE_LEAF</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_14 = __pyx_v_node_idx;
            __pyx_t_16 = (((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_child_l.data + __pyx_t_14 * __pyx_v_child_l.strides[0]) ))) != __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_LEAF) != 0);
            if (__pyx_t_16) {
/* … */
            }
            __pyx_L47_continue:;
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1521</span>:                     <span class="c"># ... and child_r[node_idx] != _TREE_LEAF:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1522</span>:                     <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">child_l</span><span class="p">[</span><span class="n">node_idx</span><span class="p">],</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>              __pyx_t_14 = __pyx_v_node_idx;
              __pyx_t_15 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_child_l.data + __pyx_t_14 * __pyx_v_child_l.strides[0]) ))), 0, 0, 0, 0, 0.0, 0);<span class='error_goto'> if (unlikely(__pyx_t_15 == ((int)-1))) __PYX_ERR(0, 1522, __pyx_L4_error)</span>
              __pyx_v_rc = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1523</span>:                     <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>              __pyx_t_16 = ((__pyx_v_rc == -1L) != 0);
              if (__pyx_t_16) {
/* … */
              }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1524</span>:                         <span class="k">with</span> <span class="k">gil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>                {
                    #ifdef WITH_THREAD
                    PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                    #endif
                    /*try:*/ {
/* … */
                    /*finally:*/ {
                      __pyx_L55_error: {
                        #ifdef WITH_THREAD
                        <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                        #endif
                        goto __pyx_L4_error;
                      }
                    }
                }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1525</span>:                             <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">(</span><span class="s">&quot;pruning tree&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>                      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1525, __pyx_L55_error)</span>
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
                      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                      <span class='error_goto'>__PYX_ERR(0, 1525, __pyx_L55_error)</span>
                    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1526</span>:                     <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">child_r</span><span class="p">[</span><span class="n">node_idx</span><span class="p">],</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>              __pyx_t_14 = __pyx_v_node_idx;
              __pyx_t_15 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_child_r.data + __pyx_t_14 * __pyx_v_child_r.strides[0]) ))), 0, 0, 0, 0, 0.0, 0);<span class='error_goto'> if (unlikely(__pyx_t_15 == ((int)-1))) __PYX_ERR(0, 1526, __pyx_L4_error)</span>
              __pyx_v_rc = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1527</span>:                     <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>              __pyx_t_16 = ((__pyx_v_rc == -1L) != 0);
              if (__pyx_t_16) {
/* … */
              }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1528</span>:                         <span class="k">with</span> <span class="k">gil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>                {
                    #ifdef WITH_THREAD
                    PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
                    #endif
                    /*try:*/ {
/* … */
                    /*finally:*/ {
                      __pyx_L61_error: {
                        #ifdef WITH_THREAD
                        <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                        #endif
                        goto __pyx_L4_error;
                      }
                    }
                }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1529</span>:                             <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">(</span><span class="s">&quot;pruning tree&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>                      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1529, __pyx_L61_error)</span>
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
                      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
                      <span class='error_goto'>__PYX_ERR(0, 1529, __pyx_L61_error)</span>
                    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1530</span>:             <span class="n">leaves_in_subtree</span><span class="p">[</span><span class="n">pruned_branch_node_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_pruned_branch_node_idx;
          *((unsigned char *) ( /* dim=0 */ (__pyx_v_leaves_in_subtree.data + __pyx_t_14 * __pyx_v_leaves_in_subtree.strides[0]) )) = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1531</span>:             <span class="n">in_subtree</span><span class="p">[</span><span class="n">pruned_branch_node_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_pruned_branch_node_idx;
          *((unsigned char *) ( /* dim=0 */ (__pyx_v_in_subtree.data + __pyx_t_14 * __pyx_v_in_subtree.strides[0]) )) = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1532</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1533</span>:             <span class="c"># updates number of leaves</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1534</span>:             <span class="n">n_pruned_leaves</span> <span class="o">=</span> <span class="n">n_leaves</span><span class="p">[</span><span class="n">pruned_branch_node_idx</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_pruned_branch_node_idx;
          __pyx_v_n_pruned_leaves = ((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_n_leaves.data + __pyx_t_14 * __pyx_v_n_leaves.strides[0]) ))) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1535</span>:             <span class="n">n_leaves</span><span class="p">[</span><span class="n">pruned_branch_node_idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_pruned_branch_node_idx;
          *((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_n_leaves.data + __pyx_t_14 * __pyx_v_n_leaves.strides[0]) )) = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1536</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1537</span>:             <span class="c"># computes the increase in r_branch to bubble up</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1538</span>:             <span class="n">r_diff</span> <span class="o">=</span> <span class="n">r_node</span><span class="p">[</span><span class="n">pruned_branch_node_idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">r_branch</span><span class="p">[</span><span class="n">pruned_branch_node_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_t_14 = __pyx_v_pruned_branch_node_idx;
          __pyx_t_4 = __pyx_v_pruned_branch_node_idx;
          __pyx_v_r_diff = ((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_node.data + __pyx_t_14 * __pyx_v_r_node.strides[0]) ))) - (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_branch.data + __pyx_t_4 * __pyx_v_r_branch.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1539</span>:             <span class="n">r_branch</span><span class="p">[</span><span class="n">pruned_branch_node_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_node</span><span class="p">[</span><span class="n">pruned_branch_node_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_t_4 = __pyx_v_pruned_branch_node_idx;
          __pyx_t_14 = __pyx_v_pruned_branch_node_idx;
          *((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_branch.data + __pyx_t_14 * __pyx_v_r_branch.strides[0]) )) = (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_node.data + __pyx_t_4 * __pyx_v_r_node.strides[0]) )));
</pre><pre class="cython line score-0">&#xA0;<span class="">1540</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1541</span>:             <span class="c"># bubble up values to ancestors</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1542</span>:             <span class="n">node_idx</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">pruned_branch_node_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_t_4 = __pyx_v_pruned_branch_node_idx;
          __pyx_v_node_idx = (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_parent.data + __pyx_t_4 * __pyx_v_parent.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1543</span>:             <span class="k">while</span> <span class="n">node_idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          while (1) {
            __pyx_t_16 = ((__pyx_v_node_idx != -1L) != 0);
            if (!__pyx_t_16) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1544</span>:                 <span class="n">n_leaves</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span> <span class="o">-=</span> <span class="n">n_pruned_leaves</span></pre>
<pre class='cython code score-0 '>            __pyx_t_4 = __pyx_v_node_idx;
            *((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_n_leaves.data + __pyx_t_4 * __pyx_v_n_leaves.strides[0]) )) -= __pyx_v_n_pruned_leaves;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1545</span>:                 <span class="n">r_branch</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">r_diff</span></pre>
<pre class='cython code score-0 '>            __pyx_t_4 = __pyx_v_node_idx;
            *((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_branch.data + __pyx_t_4 * __pyx_v_r_branch.strides[0]) )) += __pyx_v_r_diff;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1546</span>:                 <span class="n">node_idx</span> <span class="o">=</span> <span class="n">parent</span><span class="p">[</span><span class="n">node_idx</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>            __pyx_t_4 = __pyx_v_node_idx;
            __pyx_v_node_idx = (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t *) ( /* dim=0 */ (__pyx_v_parent.data + __pyx_t_4 * __pyx_v_parent.strides[0]) )));
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1547</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1548</span>:             <span class="n">controller</span><span class="o">.</span><span class="n">save_metrics</span><span class="p">(</span><span class="n">effective_alpha</span><span class="p">,</span> <span class="n">r_branch</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>          __pyx_t_4 = 0;
          ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__CCPPruneController *)__pyx_v_controller-&gt;__pyx_vtab)-&gt;save_metrics(__pyx_v_controller, __pyx_v_effective_alpha, (*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_r_branch.data + __pyx_t_4 * __pyx_v_r_branch.strides[0]) ))));
        }
        __pyx_L35_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1549</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1550</span>:         <span class="n">controller</span><span class="o">.</span><span class="n">after_pruning</span><span class="p">(</span><span class="n">in_subtree</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree__CCPPruneController *)__pyx_v_controller-&gt;__pyx_vtab)-&gt;after_pruning(__pyx_v_controller, __pyx_v_in_subtree);
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1551</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1552</span>: </pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1553</span>: <span class="k">def</span> <span class="nf">_build_pruned_tree_ccp</span><span class="p">(</span></pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_1_build_pruned_tree_ccp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree__build_pruned_tree_ccp[] = "Build a pruned tree from the original tree using cost complexity\n    pruning.\n\n    The values and nodes from the original tree are copied into the pruned\n    tree.\n\n    Parameters\n    ----------\n    tree : Tree\n        Location to place the pruned tree\n    orig_tree : Tree\n        Original tree\n    ccp_alpha : positive double\n        Complexity parameter. The subtree with the largest cost complexity\n        that is smaller than ``ccp_alpha`` will be chosen. By default,\n        no pruning is performed.\n    ";
static PyMethodDef __pyx_mdef_13stpredictions_6models_3OK3_5_tree_1_build_pruned_tree_ccp = {"_build_pruned_tree_ccp", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_13stpredictions_6models_3OK3_5_tree_1_build_pruned_tree_ccp, METH_VARARGS|METH_KEYWORDS, __pyx_doc_13stpredictions_6models_3OK3_5_tree__build_pruned_tree_ccp};
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_1_build_pruned_tree_ccp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree = 0;
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_orig_tree = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_ccp_alpha;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_build_pruned_tree_ccp (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_tree,&amp;__pyx_n_s_orig_tree,&amp;__pyx_n_s_ccp_alpha,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_tree)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_orig_tree)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_pruned_tree_ccp", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1553, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_ccp_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_pruned_tree_ccp", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1553, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_build_pruned_tree_ccp") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1553, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_tree = ((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)values[0]);
    __pyx_v_orig_tree = ((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)values[1]);
    __pyx_v_ccp_alpha = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_ccp_alpha == ((npy_float64)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1556, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_build_pruned_tree_ccp", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 1553, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree._build_pruned_tree_ccp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_tree), __pyx_ptype_13stpredictions_6models_3OK3_5_tree_Tree, 1, "tree", 0))) <span class='error_goto'>__PYX_ERR(0, 1554, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_orig_tree), __pyx_ptype_13stpredictions_6models_3OK3_5_tree_Tree, 1, "orig_tree", 0))) <span class='error_goto'>__PYX_ERR(0, 1555, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree__build_pruned_tree_ccp(__pyx_self, __pyx_v_tree, __pyx_v_orig_tree, __pyx_v_ccp_alpha);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree__build_pruned_tree_ccp(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_orig_tree, __pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t __pyx_v_ccp_alpha) {
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_n_nodes;
  __Pyx_memviewslice __pyx_v_leaves_in_subtree = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__AlphaPruner *__pyx_v_pruning_controller = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_build_pruned_tree_ccp", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree._build_pruned_tree_ccp", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_leaves_in_subtree, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_pruning_controller);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__49 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_tree, __pyx_n_s_orig_tree, __pyx_n_s_ccp_alpha, __pyx_n_s_n_nodes, __pyx_n_s_leaves_in_subtree, __pyx_n_s_pruning_controller);<span class='error_goto'> if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1553, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__49);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__49);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_13stpredictions_6models_3OK3_5_tree_1_build_pruned_tree_ccp, NULL, __pyx_n_s_stpredictions_models_OK3__tree);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1553, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_build_pruned_tree_ccp, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1553, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__50 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__49, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stpredictions_models_OK3__tree_p, __pyx_n_s_build_pruned_tree_ccp, 1553, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__50)) __PYX_ERR(0, 1553, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1554</span>:     <span class="n">Tree</span> <span class="n">tree</span><span class="p">,</span> <span class="c"># OUT</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1555</span>:     <span class="n">Tree</span> <span class="n">orig_tree</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1556</span>:     <span class="n">DOUBLE_t</span> <span class="n">ccp_alpha</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1557</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a pruned tree from the original tree using cost complexity</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1558</span>: <span class="sd">    pruning.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1559</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1560</span>: <span class="sd">    The values and nodes from the original tree are copied into the pruned</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1561</span>: <span class="sd">    tree.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1562</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1563</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1564</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1565</span>: <span class="sd">    tree : Tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1566</span>: <span class="sd">        Location to place the pruned tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1567</span>: <span class="sd">    orig_tree : Tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1568</span>: <span class="sd">        Original tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1569</span>: <span class="sd">    ccp_alpha : positive double</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1570</span>: <span class="sd">        Complexity parameter. The subtree with the largest cost complexity</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1571</span>: <span class="sd">        that is smaller than ``ccp_alpha`` will be chosen. By default,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1572</span>: <span class="sd">        no pruning is performed.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1573</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1574</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1575</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1576</span>:         <span class="n">SIZE_t</span> <span class="n">n_nodes</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="o">.</span><span class="n">node_count</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_orig_tree-&gt;node_count;
  __pyx_v_n_nodes = __pyx_t_1;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1577</span>:         <span class="nb">unsigned</span> <span class="n">char</span><span class="p">[:]</span> <span class="n">leaves_in_subtree</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_char</span>(__pyx_t_5, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1577, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_leaves_in_subtree = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1578</span>:             <span class="n">shape</span><span class="o">=</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span></pre>
<pre class='cython code score-21 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_n_nodes);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_shape, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1578, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1579</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1580</span>:     <span class="n">pruning_controller</span> <span class="o">=</span> <span class="n">_AlphaPruner</span><span class="p">(</span><span class="n">ccp_alpha</span><span class="o">=</span><span class="n">ccp_alpha</span><span class="p">)</span></pre>
<pre class='cython code score-16 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ccp_alpha);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_ccp_alpha, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1580, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)__pyx_ptype_13stpredictions_6models_3OK3_5_tree__AlphaPruner), __pyx_empty_tuple, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1580, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_pruning_controller = ((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__AlphaPruner *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1581</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1582</span>:     <span class="n">_cost_complexity_prune</span><span class="p">(</span><span class="n">leaves_in_subtree</span><span class="p">,</span> <span class="n">orig_tree</span><span class="p">,</span> <span class="n">pruning_controller</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  __pyx_t_2 = __pyx_f_13stpredictions_6models_3OK3_5_tree__cost_complexity_prune(__pyx_v_leaves_in_subtree, __pyx_v_orig_tree, ((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController *)__pyx_v_pruning_controller));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1582, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1583</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1584</span>:     <span class="n">_build_pruned_tree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">orig_tree</span><span class="p">,</span> <span class="n">leaves_in_subtree</span><span class="p">,</span></pre>
<pre class='cython code score-1 '>  __pyx_t_2 = __pyx_f_13stpredictions_6models_3OK3_5_tree__build_pruned_tree(__pyx_v_tree, __pyx_v_orig_tree, __pyx_v_leaves_in_subtree, __pyx_v_pruning_controller-&gt;capacity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1585</span>:                        <span class="n">pruning_controller</span><span class="o">.</span><span class="n">capacity</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1586</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1587</span>: </pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1588</span>: <span class="k">def</span> <span class="nf">ccp_pruning_path</span><span class="p">(</span><span class="n">Tree</span> <span class="n">orig_tree</span><span class="p">):</span></pre>
<pre class='cython code score-24 '>/* Python wrapper */
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_3ccp_pruning_path(PyObject *__pyx_self, PyObject *__pyx_v_orig_tree); /*proto*/
static char __pyx_doc_13stpredictions_6models_3OK3_5_tree_2ccp_pruning_path[] = "Computes the cost complexity pruning path.\n\n    Parameters\n    ----------\n    tree : Tree\n        Original tree.\n\n    Returns\n    -------\n    path_info : dict\n        Information about pruning path with attributes:\n\n        ccp_alphas : ndarray\n            Effective alphas of subtree during pruning.\n\n        impurities : ndarray\n            Sum of the impurities of the subtree leaves for the\n            corresponding alpha value in ``ccp_alphas``.\n    ";
static PyMethodDef __pyx_mdef_13stpredictions_6models_3OK3_5_tree_3ccp_pruning_path = {"ccp_pruning_path", (PyCFunction)__pyx_pw_13stpredictions_6models_3OK3_5_tree_3ccp_pruning_path, METH_O, __pyx_doc_13stpredictions_6models_3OK3_5_tree_2ccp_pruning_path};
static PyObject *__pyx_pw_13stpredictions_6models_3OK3_5_tree_3ccp_pruning_path(PyObject *__pyx_self, PyObject *__pyx_v_orig_tree) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ccp_pruning_path (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_orig_tree), __pyx_ptype_13stpredictions_6models_3OK3_5_tree_Tree, 1, "orig_tree", 0))) <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_13stpredictions_6models_3OK3_5_tree_2ccp_pruning_path(__pyx_self, ((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_orig_tree));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_13stpredictions_6models_3OK3_5_tree_2ccp_pruning_path(CYTHON_UNUSED PyObject *__pyx_self, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_orig_tree) {
  __Pyx_memviewslice __pyx_v_leaves_in_subtree = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__PathFinder *__pyx_v_path_finder = NULL;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_UINT32_t __pyx_v_total_items;
  PyArrayObject *__pyx_v_ccp_alphas = 0;
  PyArrayObject *__pyx_v_impurities = 0;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_UINT32_t __pyx_v_count;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ccp_pruning_path", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree.ccp_pruning_path", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_leaves_in_subtree, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_path_finder);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_ccp_alphas);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_impurities);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__51 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_orig_tree, __pyx_n_s_leaves_in_subtree, __pyx_n_s_path_finder, __pyx_n_s_total_items, __pyx_n_s_ccp_alphas, __pyx_n_s_impurities, __pyx_n_s_count);<span class='error_goto'> if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__51);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__51);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_13stpredictions_6models_3OK3_5_tree_3ccp_pruning_path, NULL, __pyx_n_s_stpredictions_models_OK3__tree);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ccp_pruning_path, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__52 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__51, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stpredictions_models_OK3__tree_p, __pyx_n_s_ccp_pruning_path, 1588, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__52)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1589</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Computes the cost complexity pruning path.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1590</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1591</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1592</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1593</span>: <span class="sd">    tree : Tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1594</span>: <span class="sd">        Original tree.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1595</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1596</span>: <span class="sd">    Returns</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1597</span>: <span class="sd">    -------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1598</span>: <span class="sd">    path_info : dict</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1599</span>: <span class="sd">        Information about pruning path with attributes:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1600</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1601</span>: <span class="sd">        ccp_alphas : ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1602</span>: <span class="sd">            Effective alphas of subtree during pruning.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1603</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1604</span>: <span class="sd">        impurities : ndarray</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1605</span>: <span class="sd">            Sum of the impurities of the subtree leaves for the</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1606</span>: <span class="sd">            corresponding alpha value in ``ccp_alphas``.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1607</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1608</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1609</span>:         <span class="nb">unsigned</span> <span class="n">char</span><span class="p">[:]</span> <span class="n">leaves_in_subtree</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span></pre>
<pre class='cython code score-12 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1609, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1609, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1609, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_unsigned_char</span>(__pyx_t_4, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1609, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_leaves_in_subtree = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1610</span>:             <span class="n">shape</span><span class="o">=</span><span class="n">orig_tree</span><span class="o">.</span><span class="n">node_count</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span></pre>
<pre class='cython code score-21 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1610, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_orig_tree-&gt;node_count);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1610, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_shape, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1610, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1610, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1610, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1610, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1611</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1612</span>:     <span class="n">path_finder</span> <span class="o">=</span> <span class="n">_PathFinder</span><span class="p">(</span><span class="n">orig_tree</span><span class="o">.</span><span class="n">node_count</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_orig_tree-&gt;node_count);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1612, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_13stpredictions_6models_3OK3_5_tree__PathFinder), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1612, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_path_finder = ((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__PathFinder *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1613</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1614</span>:     <span class="n">_cost_complexity_prune</span><span class="p">(</span><span class="n">leaves_in_subtree</span><span class="p">,</span> <span class="n">orig_tree</span><span class="p">,</span> <span class="n">path_finder</span><span class="p">)</span></pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_13stpredictions_6models_3OK3_5_tree__cost_complexity_prune(__pyx_v_leaves_in_subtree, __pyx_v_orig_tree, ((struct __pyx_obj_13stpredictions_6models_3OK3_5_tree__CCPPruneController *)__pyx_v_path_finder));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1614, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1615</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1616</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1617</span>:         <span class="n">UINT32_t</span> <span class="n">total_items</span> <span class="o">=</span> <span class="n">path_finder</span><span class="o">.</span><span class="n">count</span></pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_path_finder-&gt;count;
  __pyx_v_total_items = __pyx_t_6;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1618</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">ccp_alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">total_items</span><span class="p">,</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_From_npy_uint32(__pyx_v_total_items);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_shape, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1618, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1618, __pyx_L1_error)</span>
  __pyx_v_ccp_alphas = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1619</span>:                                          <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1619, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1618, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1620</span>:         <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="n">impurities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">total_items</span><span class="p">,</span></pre>
<pre class='cython code score-19 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1620, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1620, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1620, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyInt_From_npy_uint32(__pyx_v_total_items);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1620, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_shape, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1620, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1620, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 1620, __pyx_L1_error)</span>
  __pyx_v_impurities = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1621</span>:                                          <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></pre>
<pre class='cython code score-11 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1621, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1621, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1620, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1622</span>:         <span class="n">UINT32_t</span> <span class="n">count</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_count = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1623</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1624</span>:     <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">total_items</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_7 = ((__pyx_v_count &lt; __pyx_v_total_items) != 0);
    if (!__pyx_t_7) break;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1625</span>:         <span class="n">ccp_alphas</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">path_finder</span><span class="o">.</span><span class="n">ccp_alphas</span><span class="p">[</span><span class="n">count</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>    if (unlikely(!__pyx_v_path_finder-&gt;ccp_alphas.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1625, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_count;
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_path_finder-&gt;ccp_alphas.data + __pyx_t_8 * __pyx_v_path_finder-&gt;ccp_alphas.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1625, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_ccp_alphas), __pyx_v_count, __pyx_t_2, __pyx_t_13stpredictions_6models_3OK3_5_tree_UINT32_t, 0, __Pyx_PyInt_From_npy_uint32, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1625, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1626</span>:         <span class="n">impurities</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">path_finder</span><span class="o">.</span><span class="n">impurities</span><span class="p">[</span><span class="n">count</span><span class="p">]</span></pre>
<pre class='cython code score-13 '>    if (unlikely(!__pyx_v_path_finder-&gt;impurities.memview)) {<span class='py_c_api'>PyErr_SetString</span>(PyExc_AttributeError,"Memoryview is not initialized");<span class='error_goto'>__PYX_ERR(0, 1626, __pyx_L1_error)</span>}
    __pyx_t_8 = __pyx_v_count;
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((__pyx_t_13stpredictions_6models_3OK3_5_tree_DOUBLE_t *) ( /* dim=0 */ (__pyx_v_path_finder-&gt;impurities.data + __pyx_t_8 * __pyx_v_path_finder-&gt;impurities.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1626, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(((PyObject *)__pyx_v_impurities), __pyx_v_count, __pyx_t_2, __pyx_t_13stpredictions_6models_3OK3_5_tree_UINT32_t, 0, __Pyx_PyInt_From_npy_uint32, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1626, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1627</span>:         <span class="n">count</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0 '>    __pyx_v_count = (__pyx_v_count + 1);
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1628</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1629</span>:     <span class="k">return</span> <span class="p">{</span><span class="s">&#39;ccp_alphas&#39;</span><span class="p">:</span> <span class="n">ccp_alphas</span><span class="p">,</span> <span class="s">&#39;impurities&#39;</span><span class="p">:</span> <span class="n">impurities</span><span class="p">}</span></pre>
<pre class='cython code score-13 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_ccp_alphas, ((PyObject *)__pyx_v_ccp_alphas)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1629, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_impurities, ((PyObject *)__pyx_v_impurities)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1629, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1630</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1631</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1632</span>: <span class="k">cdef</span> <span class="nf">_build_pruned_tree</span><span class="p">(</span></pre>
<pre class='cython code score-6 '>static PyObject *__pyx_f_13stpredictions_6models_3OK3_5_tree__build_pruned_tree(struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_tree, struct __pyx_obj_13stpredictions_6models_3OK3_5_tree_Tree *__pyx_v_orig_tree, __Pyx_memviewslice __pyx_v_leaves_in_subtree, __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_capacity) {
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_orig_node_id;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_new_node_id;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_depth;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_parent;
  int __pyx_v_is_left;
  int __pyx_v_is_leaf;
  __pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t __pyx_v_max_depth_seen;
  int __pyx_v_rc;
  struct __pyx_t_13stpredictions_6models_3OK3_5_tree_Node *__pyx_v_node;
  double *__pyx_v_orig_value_ptr;
  double *__pyx_v_new_value_ptr;
  struct __pyx_obj_7sklearn_4tree_6_utils_Stack *__pyx_v_stack = 0;
  struct __pyx_t_7sklearn_4tree_6_utils_StackRecord __pyx_v_stack_record;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_build_pruned_tree", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("stpredictions.models.OK3._tree._build_pruned_tree", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_stack);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">1633</span>:     <span class="n">Tree</span> <span class="n">tree</span><span class="p">,</span> <span class="c"># OUT</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1634</span>:     <span class="n">Tree</span> <span class="n">orig_tree</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1635</span>:     <span class="n">const</span> <span class="nb">unsigned</span> <span class="n">char</span><span class="p">[:]</span> <span class="n">leaves_in_subtree</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1636</span>:     <span class="n">SIZE_t</span> <span class="n">capacity</span><span class="p">):</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1637</span>: <span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a pruned tree.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1638</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1639</span>: <span class="sd">    Build a pruned tree from the original tree by transforming the nodes in</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1640</span>: <span class="sd">    ``leaves_in_subtree`` into leaves.</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1641</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1642</span>: <span class="sd">    Parameters</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1643</span>: <span class="sd">    ----------</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1644</span>: <span class="sd">    tree : Tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1645</span>: <span class="sd">        Location to place the pruned tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1646</span>: <span class="sd">    orig_tree : Tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1647</span>: <span class="sd">        Original tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1648</span>: <span class="sd">    leaves_in_subtree : unsigned char memoryview, shape=(node_count, )</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1649</span>: <span class="sd">        Boolean mask for leaves to include in subtree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1650</span>: <span class="sd">    capacity : SIZE_t</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1651</span>: <span class="sd">        Number of nodes to initially allocate in pruned tree</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1652</span>: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1653</span>:     <span class="n">tree</span><span class="o">.</span><span class="n">_resize</span><span class="p">(</span><span class="n">capacity</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_tree-&gt;__pyx_vtab)-&gt;_resize(__pyx_v_tree, __pyx_v_capacity);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1653, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1654</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1655</span>:     <span class="k">cdef</span><span class="p">:</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1656</span>:         <span class="n">SIZE_t</span> <span class="n">orig_node_id</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1657</span>:         <span class="n">SIZE_t</span> <span class="n">new_node_id</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1658</span>:         <span class="n">SIZE_t</span> <span class="n">depth</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1659</span>:         <span class="n">SIZE_t</span> <span class="n">parent</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1660</span>:         <span class="nb">bint</span> <span class="n">is_left</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1661</span>:         <span class="nb">bint</span> <span class="n">is_leaf</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1662</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1663</span>:         <span class="n">SIZE_t</span> <span class="n">max_depth_seen</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>  __pyx_v_max_depth_seen = -1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1664</span>:         <span class="nb">int</span> <span class="n">rc</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0 '>  __pyx_v_rc = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1665</span>:         <span class="n">Node</span><span class="o">*</span> <span class="n">node</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1666</span>:         <span class="n">double</span><span class="o">*</span> <span class="n">orig_value_ptr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1667</span>:         <span class="n">double</span><span class="o">*</span> <span class="n">new_value_ptr</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1668</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1669</span>:         <span class="c"># Only uses the start, depth, parent, and is_left variables</span></pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1670</span>:         <span class="n">Stack</span> <span class="n">stack</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">(</span><span class="n">INITIAL_STACK_SIZE</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_Py_intptr_t</span>(__pyx_v_13stpredictions_6models_3OK3_5_tree_INITIAL_STACK_SIZE);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)__pyx_ptype_7sklearn_4tree_6_utils_Stack), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_stack = ((struct __pyx_obj_7sklearn_4tree_6_utils_Stack *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1671</span>:         <span class="n">StackRecord</span> <span class="n">stack_record</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1672</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1673</span>:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-6 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L4_error: {
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L1_error;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1674</span>:         <span class="c"># push root node onto stack</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1675</span>:         <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">_TREE_UNDEFINED</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>        __pyx_t_1 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, 0, 0, 0, __pyx_v_13stpredictions_6models_3OK3_5_tree__TREE_UNDEFINED, 0, 0.0, 0);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1675, __pyx_L4_error)</span>
        __pyx_v_rc = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1676</span>:         <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_4 = ((__pyx_v_rc == -1L) != 0);
        if (__pyx_t_4) {
/* … */
        }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1677</span>:             <span class="k">with</span> <span class="k">gil</span><span class="p">:</span></pre>
<pre class='cython code score-4 '>          {
              #ifdef WITH_THREAD
              PyGILState_STATE __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
              #endif
              /*try:*/ {
/* … */
              /*finally:*/ {
                __pyx_L8_error: {
                  #ifdef WITH_THREAD
                  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
                  #endif
                  goto __pyx_L4_error;
                }
              }
          }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1678</span>:                 <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">(</span><span class="s">&quot;pruning tree&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>                __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1678, __pyx_L8_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L8_error)</span>
              }
</pre><pre class="cython line score-0">&#xA0;<span class="">1679</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1680</span>:         <span class="k">while</span> <span class="ow">not</span> <span class="n">stack</span><span class="o">.</span><span class="n">is_empty</span><span class="p">():</span></pre>
<pre class='cython code score-0 '>        while (1) {
          __pyx_t_4 = ((!(((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;is_empty(__pyx_v_stack) != 0)) != 0);
          if (!__pyx_t_4) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1681</span>:             <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stack_record</span><span class="p">)</span></pre>
<pre class='cython code score-0 '>          (void)(((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;pop(__pyx_v_stack, (&amp;__pyx_v_stack_record)));
</pre><pre class="cython line score-0">&#xA0;<span class="">1682</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1683</span>:             <span class="n">orig_node_id</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">start</span></pre>
<pre class='cython code score-0 '>          __pyx_t_5 = __pyx_v_stack_record.start;
          __pyx_v_orig_node_id = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1684</span>:             <span class="n">depth</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">depth</span></pre>
<pre class='cython code score-0 '>          __pyx_t_5 = __pyx_v_stack_record.depth;
          __pyx_v_depth = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1685</span>:             <span class="n">parent</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">parent</span></pre>
<pre class='cython code score-0 '>          __pyx_t_5 = __pyx_v_stack_record.parent;
          __pyx_v_parent = __pyx_t_5;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1686</span>:             <span class="n">is_left</span> <span class="o">=</span> <span class="n">stack_record</span><span class="o">.</span><span class="n">is_left</span></pre>
<pre class='cython code score-0 '>          __pyx_t_4 = __pyx_v_stack_record.is_left;
          __pyx_v_is_left = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">1687</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1688</span>:             <span class="n">is_leaf</span> <span class="o">=</span> <span class="n">leaves_in_subtree</span><span class="p">[</span><span class="n">orig_node_id</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_t_6 = __pyx_v_orig_node_id;
          __pyx_v_is_leaf = (*((unsigned char const  *) ( /* dim=0 */ (__pyx_v_leaves_in_subtree.data + __pyx_t_6 * __pyx_v_leaves_in_subtree.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1689</span>:             <span class="n">node</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">orig_tree</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">orig_node_id</span><span class="p">]</span></pre>
<pre class='cython code score-0 '>          __pyx_v_node = (&amp;(__pyx_v_orig_tree-&gt;nodes[__pyx_v_orig_node_id]));
</pre><pre class="cython line score-0">&#xA0;<span class="">1690</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1691</span>:             <span class="n">new_node_id</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">_add_node</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>          __pyx_t_7 = ((struct __pyx_vtabstruct_13stpredictions_6models_3OK3_5_tree_Tree *)__pyx_v_tree-&gt;__pyx_vtab)-&gt;_add_node(__pyx_v_tree, __pyx_v_parent, __pyx_v_is_left, __pyx_v_is_leaf, __pyx_v_node-&gt;feature, __pyx_v_node-&gt;threshold, __pyx_v_node-&gt;impurity, __pyx_v_node-&gt;n_node_samples, __pyx_v_node-&gt;weighted_n_node_samples);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((__pyx_t_13stpredictions_6models_3OK3_5_tree_SIZE_t)-1))) __PYX_ERR(0, 1691, __pyx_L4_error)</span>
          __pyx_v_new_node_id = __pyx_t_7;
</pre><pre class="cython line score-0">&#xA0;<span class="">1692</span>:                 <span class="n">parent</span><span class="p">,</span> <span class="n">is_left</span><span class="p">,</span> <span class="n">is_leaf</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">feature</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">threshold</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1693</span>:                 <span class="n">node</span><span class="o">.</span><span class="n">impurity</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">n_node_samples</span><span class="p">,</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1694</span>:                 <span class="n">node</span><span class="o">.</span><span class="n">weighted_n_node_samples</span><span class="p">)</span></pre>
<pre class="cython line score-0">&#xA0;<span class="">1695</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1696</span>:             <span class="k">if</span> <span class="n">new_node_id</span> <span class="o">==</span> <span class="n">SIZE_MAX</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_4 = ((__pyx_v_new_node_id == SIZE_MAX) != 0);
          if (__pyx_t_4) {
/* … */
          }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1697</span>:                 <span class="n">rc</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1</span></pre>
<pre class='cython code score-0 '>            __pyx_v_rc = -1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1698</span>:                 <span class="k">break</span></pre>
<pre class='cython code score-0 '>            goto __pyx_L11_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">1699</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1700</span>:             <span class="c"># copy value from original tree to new tree</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1701</span>:             <span class="n">orig_value_ptr</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">tree</span><span class="o">.</span><span class="n">K_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">orig_node_id</span></pre>
<pre class='cython code score-0 '>          __pyx_v_orig_value_ptr = (__pyx_v_orig_tree-&gt;value + ((__pyx_v_tree-&gt;K_y-&gt;dimensions[0]) * __pyx_v_orig_node_id));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1702</span>:             <span class="n">new_value_ptr</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">tree</span><span class="o">.</span><span class="n">K_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">new_node_id</span></pre>
<pre class='cython code score-0 '>          __pyx_v_new_value_ptr = (__pyx_v_tree-&gt;value + ((__pyx_v_tree-&gt;K_y-&gt;dimensions[0]) * __pyx_v_new_node_id));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1703</span>:             <span class="n">memcpy</span><span class="p">(</span><span class="n">new_value_ptr</span><span class="p">,</span> <span class="n">orig_value_ptr</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">double</span><span class="p">)</span> <span class="o">*</span> <span class="n">tree</span><span class="o">.</span><span class="n">K_y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mf">0</span><span class="p">])</span></pre>
<pre class='cython code score-0 '>          (void)(memcpy(__pyx_v_new_value_ptr, __pyx_v_orig_value_ptr, ((sizeof(double)) * (__pyx_v_tree-&gt;K_y-&gt;dimensions[0]))));
</pre><pre class="cython line score-0">&#xA0;<span class="">1704</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1705</span>:             <span class="k">if</span> <span class="ow">not</span> <span class="n">is_leaf</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_4 = ((!(__pyx_v_is_leaf != 0)) != 0);
          if (__pyx_t_4) {
/* … */
          }
</pre><pre class="cython line score-0">&#xA0;<span class="">1706</span>:                 <span class="c"># Push right child on stack</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1707</span>:                 <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>            __pyx_t_1 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, __pyx_v_node-&gt;right_child, 0, (__pyx_v_depth + 1), __pyx_v_new_node_id, 0, 0.0, 0);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1707, __pyx_L4_error)</span>
            __pyx_v_rc = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1708</span>:                     <span class="n">node</span><span class="o">.</span><span class="n">right_child</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">new_node_id</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1709</span>:                 <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_4 = ((__pyx_v_rc == -1L) != 0);
            if (__pyx_t_4) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1710</span>:                     <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L11_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">1711</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1712</span>:                 <span class="c"># push left child on stack</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1713</span>:                 <span class="n">rc</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">push</span><span class="p">(</span></pre>
<pre class='cython code score-0 '>            __pyx_t_1 = ((struct __pyx_vtabstruct_7sklearn_4tree_6_utils_Stack *)__pyx_v_stack-&gt;__pyx_vtab)-&gt;push(__pyx_v_stack, __pyx_v_node-&gt;left_child, 0, (__pyx_v_depth + 1), __pyx_v_new_node_id, 1, 0.0, 0);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1713, __pyx_L4_error)</span>
            __pyx_v_rc = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1714</span>:                     <span class="n">node</span><span class="o">.</span><span class="n">left_child</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">new_node_id</span><span class="p">,</span> <span class="mf">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0</span><span class="p">)</span></pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1715</span>:                 <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>            __pyx_t_4 = ((__pyx_v_rc == -1L) != 0);
            if (__pyx_t_4) {
/* … */
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1716</span>:                     <span class="k">break</span></pre>
<pre class='cython code score-0 '>              goto __pyx_L11_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">1717</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1718</span>:             <span class="k">if</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="n">max_depth_seen</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>          __pyx_t_4 = ((__pyx_v_depth &gt; __pyx_v_max_depth_seen) != 0);
          if (__pyx_t_4) {
/* … */
          }
        }
        __pyx_L11_break:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1719</span>:                 <span class="n">max_depth_seen</span> <span class="o">=</span> <span class="n">depth</span></pre>
<pre class='cython code score-0 '>            __pyx_v_max_depth_seen = __pyx_v_depth;
</pre><pre class="cython line score-0">&#xA0;<span class="">1720</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1721</span>:         <span class="k">if</span> <span class="n">rc</span> <span class="o">&gt;=</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>        __pyx_t_4 = ((__pyx_v_rc &gt;= 0) != 0);
        if (__pyx_t_4) {
/* … */
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1722</span>:             <span class="n">tree</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth_seen</span></pre>
<pre class='cython code score-0 '>          __pyx_v_tree-&gt;max_depth = __pyx_v_max_depth_seen;
</pre><pre class="cython line score-0">&#xA0;<span class="">1723</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1724</span>:     <span class="n">tree</span><span class="o">.</span><span class="n">K_y</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="o">.</span><span class="n">K_y</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = ((PyObject *)__pyx_v_orig_tree-&gt;K_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_tree-&gt;K_y);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_tree-&gt;K_y));
  __pyx_v_tree-&gt;K_y = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1725</span>:     <span class="n">tree</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">orig_tree</span><span class="o">.</span><span class="n">y</span></pre>
<pre class='cython code score-2 '>  __pyx_t_3 = ((PyObject *)__pyx_v_orig_tree-&gt;y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_tree-&gt;y);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_tree-&gt;y));
  __pyx_v_tree-&gt;y = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1726</span>:     <span class="k">if</span> <span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_rc == -1L) != 0);
  if (unlikely(__pyx_t_4)) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1727</span>:         <span class="k">raise</span> <span class="ne">MemoryError</span><span class="p">(</span><span class="s">&quot;pruning tree&quot;</span><span class="p">)</span></pre>
<pre class='cython code score-5 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_MemoryError, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1727, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1727, __pyx_L1_error)</span>
</pre></div></body></html>
